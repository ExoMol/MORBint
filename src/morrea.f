      SUBROUTINE READIN ( POTSYM , FRQLO , FRQHI, XINLIM , TRTLIM ,
     .                    GNS    , ABSTMP ,
     .                    V2A , NVA , IABA , V2B , NVB , IABB , IOPT ,
     .                    ENGLIM )
C
      IMPLICIT REAL*8 (A-H,O-Z)
      REAL*8 M1,M2,M3,M,U1,U3,U13,V,RHO,EPS,
     1      CR,SR,CSE,SNE,
     2      CRE,SRE,CORO,EPSP,EPSPP,EPSPPP
C
      REAL*8 AMASS(3,10),GNS(2,2,10)
C
      REAL*8 RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1       AA1,AA3,
     2       F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3       F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4       F13,F1A13,F2A13,F3A13,
     5       F111,F1A111,F2A111,F333,F1A333,F2A333,
     6       F113,F1A113,F2A113,F133,F1A133,F2A133,
     7       F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8       F1333,FA1333,F1133,FA1133,
     8       RE12 , RE32 , RHOREF , VMIN
C
      REAL*8 ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1      PREC
C
      REAL*8 THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1      THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2      VELLGT , PLANCK , AVOGNO , DEGRAD , RADDEG ,
     3      PI
C
      REAL*8   B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      REAL*8   CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
      INTEGER NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5       NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6       NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7       NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6       ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7       IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8       NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER,
     9       ISOMAX , NATTS  , V0TYPE , IVAR(55) , PARMAX ,
     1       NUMPAR , PRTINT , V2A , V2B
C
      INTEGER V1 ,V2, V3 , V2MXP1, V2P1,
     1       NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2       NSEPP2 , NSEQP1 , MBASIS ,
     3       MDIM , NFSYM0, NFASY0, NFSYMJ, NFASYJ,
     4       KSTYPA(2) , LSTYPA(2) , JMAX , V2MAX , JMAXP1
C
      INTEGER IQUANT(5,10)
C
      LOGICAL SYMM , POTSYM
C
      REAL*8 RMK(2),AAS(2)
      INTEGER NOBAS,MBASP1,LENIW
      CHARACTER*80 TITLE(4)
      CHARACTER*6 POTFLG
      CHARACTER*10 LABEL
      REAL*8 RHOEDG
      INTEGER I,J,LSTYP1,LSTYP2
C
      COMMON /ISOTOP/ IQUANT,AMASS
C
      COMMON /ELECTR/ EC,ZC1,ZC2,ZC3,ZELEC
C
      COMMON /VALUES/ RHO,EPS,EPSP,EPSPP,EPSPPP,
     1               CR,SR,CSE,SNE,CRE,SRE,CORO
C
      COMMON /MOLCUL/ RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1               AA1,AA3,
     2               F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3               F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4               F13,F1A13,F2A13,F3A13,
     5               F111,F1A111,F2A111,F333,F1A333,F2A333,
     6               F113,F1A113,F2A113,F133,F1A133,F2A133,
     7               F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8               F1333,FA1333,F1133,FA1133,
     8               RE12 , RE32 , M1 , M2 , M3 , M ,
     9               U1 , U3 , U13 , V ,
     1               SYMM
C
      COMMON /INTEG/  ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1               RHOREF , VMIN , V0TYPE ,
     1               NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2               NSEPP2 , NSEQP1 , KSTYPA , LSTYPA
C
      COMMON /DIMEN/  MBASIS ,  V2MAX  , V2MXP1 ,
     1               JMAX   , JMAXP1 , MDIM   , NFSYM0 , NFASY0 ,
     2               NFSYMJ , NFASYJ
C
      COMMON /LSFIT/  PARMAX , NUMPAR , ISOMAX , IVAR
C
      COMMON /AMPDI/ IDPMA
C
      COMMON /SYS/    THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1                     THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2                     VELLGT , PLANCK , AVOGNO , PI , PREC ,
     4                     NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5                     NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6                     NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7                     NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6                     ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7                     IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8                     NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER ,
     9                       NATTS , PRTINT
C
      COMMON/BCOEFF/
     1      B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      COMMON/CRCOEF/
     1      CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
C
      COMMON/MORSE/RMK,AAS
      COMMON/MODIM/NOBAS,MBASP1,LENIW
C
C
      COMMON /DIPOLE/P0,PA1,PA2,PA3,PA4,PA5,PA6,PA7,PA8,
     2               P1,P1A1,P2A1,P3A1,P4A1,
     2               P3,P1A3,P2A3,P3A3,P4A3,
     3               P11,P1A11,P2A11,P3A11,P33,P1A33,P2A33,P3A33,
     4               P13,P1A13,P2A13,P3A13,
     5               P111,P1A111,P2A111,P333,P1A333,P2A333,
     6               P113,P1A113,P2A113,P133,P1A133,P2A133,
     7               P1111,PA1111,P3333,PA3333,P1113,PA1113,
     8               P1333,PA1333,P1133,PA1133,
     1               O0,OA1,OA2,OA3,OA4,OA5,OA6,OA7,OA8,
     2               O1,O1A1,O2A1,O3A1,O4A1,
     2               O3,O1A3,O2A3,O3A3,O4A3,
     3               O11,O1A11,O2A11,O3A11,O33,O1A33,O2A33,O3A33,
     4               O13,O1A13,O2A13,O3A13,
     5               O111,O1A111,O2A111,O333,O1A333,O2A333,
     6               O113,O1A113,O2A113,O133,O1A133,O2A133,
     7               O1111,OA1111,O3333,OA3333,O1113,OA1113,
     8               O1333,OA1333,O1133,OA1133
C
      POTSYM=.FALSE.
      PARMAX=55
C
      WRITE (NFIL6,4990)
C
      DO 100 I=1,4
100   READ (NFIL5,5000) TITLE(I)
      WRITE (NFIL6,5100) (TITLE(I), I=1,4)
C
      NISOT=0
      DO 200 I=1,ISOMAX
      READ (NFIL5,5701) LABEL,(AMASS(J,I), J=1,3)
      IF (AMASS(1,I) .LE. 0.0D+00) GOTO 300
      NISOT=NISOT+1
200   CONTINUE
300   CONTINUE
      WRITE (NFIL6,5300)
C
      DO 400 I=1,NISOT
400   WRITE (NFIL6,5400) I,(AMASS(J,I), J=1,3)
      WRITE (NFIL6,5410)
C
      READ (NFIL5,5500) LABEL,V2A,NVA,IABA
      READ (NFIL5,5500) LABEL,V2B,NVB,IABB
      WRITE (NFIL6,5345)       V2A,NVA,IABA,
     .                         V2B,NVB,IABB
      IABA=IABA+1
      IABB=IABB+1
C
      READ (NFIL5,5500) LABEL,IZ1,IZ2,IZ3
      READ (NFIL5,5500) LABEL,NELEC
      ZC1= FLOAT(IZ1)
      ZC2= FLOAT(IZ2)
      ZC3= FLOAT(IZ3)
      ZELEC= FLOAT(NELEC)
C
      WRITE (NFIL6,5340) IZ1,IZ2,IZ3
      WRITE (NFIL6,5410)
      WRITE (NFIL6,5341) NELEC
C
      WRITE (NFIL6,5342)
      DO 402 I=1,NISOT
      READ (NFIL5,5500) LABEL,IGNSA,IGNSB
      WRITE (NFIL6,5343) I,IGNSA,IGNSB
      GNS(1,1,I)=FLOAT(IGNSA)
      GNS(2,1,I)=FLOAT(IGNSB)
      GNS(1,2,I)=FLOAT(IGNSB)
402   GNS(2,2,I)=FLOAT(IGNSA)
      WRITE (NFIL6,5410)
C
C FOR EACH ISOTOPE DEFINE JMAX, V2MAX, AND MBASIS
C
      WRITE (NFIL6,5430)
      DO 500 I=1,NISOT
      READ (NFIL5,5500) LABEL,JMAX,V2MAX,MBASIS,LSTYP1,LSTYP2
      WRITE (NFIL6,5440) I,JMAX,V2MAX,MBASIS,LSTYP1,LSTYP2
      IQUANT(1,I)=JMAX
      IQUANT(2,I)=V2MAX
      IQUANT(3,I)=MBASIS
      IQUANT(4,I)=LSTYP1
500   IQUANT(5,I)=LSTYP2
      WRITE (NFIL6,5450)
C
      READ (NFIL5,5700) LABEL,IVAR(1),RHOEDG
      RHOE=PI*RHOEDG/1.8E+02
      READ (NFIL5,5700) LABEL,IVAR(4),FA1
      READ (NFIL5,5700) LABEL,IVAR(5),FA2
      READ (NFIL5,5700) LABEL,IVAR(6),FA3
      READ (NFIL5,5700) LABEL,IVAR(7),FA4
      READ (NFIL5,5700) LABEL,IVAR(8),FA5
      READ (NFIL5,5700) LABEL,IVAR(9),FA6
      READ (NFIL5,5700) LABEL,IVAR(10),FA7
      READ (NFIL5,5700) LABEL,IVAR(11),FA8
C
      WRITE (NFIL6,5710) RHOEDG,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8
C
      READ (NFIL5,5720) POTFLG
      IF (POTFLG(1:4) .EQ. 'SYMM') GOTO 600
      IF (POTFLG(1:4) .EQ. 'UNSY') GOTO 700
      GOTO 9000
600   POTSYM=.TRUE.
      PARMAX=35
      READ (NFIL5,5700) LABEL,IVAR(2),RE12
      RE32=RE12
      READ (NFIL5,5700) LABEL,IVAR(3),AA1
      AA3=AA1
      READ (NFIL5,5700) LABEL,IVAR(12),F1A1
      F1A3=F1A1
      READ (NFIL5,5700) LABEL,IVAR(13),F2A1
      F2A3=F2A1
      READ (NFIL5,5700) LABEL,IVAR(14),F3A1
      F3A3=F3A1
      READ (NFIL5,5700) LABEL,IVAR(15),F4A1
      F4A3=F4A1
      READ (NFIL5,5700) LABEL,IVAR(16),F11
      F33=F11
      READ (NFIL5,5700) LABEL,IVAR(17),F1A11
      F1A33=F1A11
      READ (NFIL5,5700) LABEL,IVAR(18),F2A11
      F2A33=F2A11
      READ (NFIL5,5700) LABEL,IVAR(19),F3A11
      F3A33=F3A11
      READ (NFIL5,5700) LABEL,IVAR(20),F13
      READ (NFIL5,5700) LABEL,IVAR(21),F1A13
      READ (NFIL5,5700) LABEL,IVAR(22),F2A13
      READ (NFIL5,5700) LABEL,IVAR(23),F3A13
      READ (NFIL5,5700) LABEL,IVAR(24),F111
      F333=F111
      READ (NFIL5,5700) LABEL,IVAR(25),F1A111
      F1A333=F1A111
      READ (NFIL5,5700) LABEL,IVAR(26),F2A111
      F2A333=F2A111
      READ (NFIL5,5700) LABEL,IVAR(27),F113
      F133=F113
      READ (NFIL5,5700) LABEL,IVAR(28),F1A113
      F1A133=F1A113
      READ (NFIL5,5700) LABEL,IVAR(29),F2A113
      F2A133=F2A113
      READ (NFIL5,5700) LABEL,IVAR(30),F1111
      F3333=F1111
      READ (NFIL5,5700) LABEL,IVAR(31),FA1111
      FA3333=FA1111
      READ (NFIL5,5700) LABEL,IVAR(32),F1113
      F1333=F1113
      READ (NFIL5,5700) LABEL,IVAR(33),FA1113
      FA1333=FA1113
      READ (NFIL5,5700) LABEL,IVAR(34),F1133
      READ (NFIL5,5700) LABEL,IVAR(35),FA1133
      P0=0.0D+00
      PA1=0.0D+00
      PA2=0.0D+00
      PA3=0.0D+00
      PA4=0.0D+00
      PA5=0.0D+00
      PA6=0.0D+00
      PA7=0.0D+00
      PA8=0.0D+00
      READ (NFIL5,5705) LABEL,P1
      P3=-P1
      READ (NFIL5,5705) LABEL,P1A1
      P1A3=-P1A1
      READ (NFIL5,5705) LABEL,P2A1
      P2A3=-P2A1
      READ (NFIL5,5705) LABEL,P3A1
      P3A3=-P3A1
      READ (NFIL5,5705) LABEL,P4A1
      P4A3=-P4A1
      READ (NFIL5,5705) LABEL,P11
      P33=-P11
      READ (NFIL5,5705) LABEL,P1A11
      P1A33=-P1A11
      READ (NFIL5,5705) LABEL,P2A11
      P2A33=-P2A11
      READ (NFIL5,5705) LABEL,P3A11
      P3A33=-P3A11
      P13=0.0D+00
      P1A13=0.0D+00
      P2A13=0.0D+00
      P3A13=0.0D+00
      READ (NFIL5,5705) LABEL,P111
      P333=-P111
      READ (NFIL5,5705) LABEL,P1A111
      P1A333=-P1A111
      READ (NFIL5,5705) LABEL,P2A111
      P2A333=-P2A111
      READ (NFIL5,5705) LABEL,P113
      P133=-P113
      READ (NFIL5,5705) LABEL,P1A113
      P1A133=-P1A113
      READ (NFIL5,5705) LABEL,P2A113
      P2A133=-P2A113
      READ (NFIL5,5705) LABEL,P1111
      P3333=-P1111
      READ (NFIL5,5705) LABEL,PA1111
      PA3333=-PA1111
      READ (NFIL5,5705) LABEL,P1113
      P1333=-P1113
      READ (NFIL5,5705) LABEL,PA1113
      PA1333=-PA1113
      P1133=0.0D+00
      PA1133=0.0D+00
      READ (NFIL5,5705) LABEL,O0
      READ (NFIL5,5705) LABEL,OA1
      READ (NFIL5,5705) LABEL,OA2
      READ (NFIL5,5705) LABEL,OA3
      READ (NFIL5,5705) LABEL,OA4
      READ (NFIL5,5705) LABEL,OA5
      READ (NFIL5,5705) LABEL,OA6
      READ (NFIL5,5705) LABEL,OA7
      READ (NFIL5,5705) LABEL,OA8
      READ (NFIL5,5705) LABEL,O1
      O3=O1
      READ (NFIL5,5705) LABEL,O1A1
      O1A3=O1A1
      READ (NFIL5,5705) LABEL,O2A1
      O2A3=O2A1
      READ (NFIL5,5705) LABEL,O3A1
      O3A3=O3A1
      READ (NFIL5,5705) LABEL,O4A1
      O4A3=O4A1
      READ (NFIL5,5705) LABEL,O11
      O33=O11
      READ (NFIL5,5705) LABEL,O1A11
      O1A33=O1A11
      READ (NFIL5,5705) LABEL,O2A11
      O2A33=O2A11
      READ (NFIL5,5705) LABEL,O3A11
      O3A33=O3A11
      READ (NFIL5,5705) LABEL,O13
      READ (NFIL5,5705) LABEL,O1A13
      READ (NFIL5,5705) LABEL,O2A13
      READ (NFIL5,5705) LABEL,O3A13
      READ (NFIL5,5705) LABEL,O111
      O333=O111
      READ (NFIL5,5705) LABEL,O1A111
      O1A333=O1A111
      READ (NFIL5,5705) LABEL,O2A111
      O2A333=O2A111
      READ (NFIL5,5705) LABEL,O113
      O133=O113
      READ (NFIL5,5705) LABEL,O1A113
      O1A133=O1A113
      READ (NFIL5,5705) LABEL,O2A113
      O2A133=O2A113
      READ (NFIL5,5705) LABEL,O1111
      O3333=O1111
      READ (NFIL5,5705) LABEL,OA1111
      OA3333=OA1111
      READ (NFIL5,5705) LABEL,O1113
      O1333=O1113
      READ (NFIL5,5705) LABEL,OA1113
      OA1333=OA1113
      READ (NFIL5,5705) LABEL,O1133
      READ (NFIL5,5705) LABEL,OA1133
      GOTO 800
700   READ (NFIL5,5700) LABEL,IVAR(2),RE12,IVAR(3),RE32
      READ (NFIL5,5700) LABEL,IVAR(4),AA1,IVAR(5),AA3
      READ (NFIL5,5700) LABEL,IVAR(14),F1A1,IVAR(18),F1A3
      READ (NFIL5,5700) LABEL,IVAR(15),F2A1,IVAR(19),F2A3
      READ (NFIL5,5700) LABEL,IVAR(16),F3A1,IVAR(20),F3A3
      READ (NFIL5,5700) LABEL,IVAR(17),F4A1,IVAR(21),F4A3
      READ (NFIL5,5700) LABEL,IVAR(22),F11,IVAR(26),F33
      READ (NFIL5,5700) LABEL,IVAR(23),F1A11,IVAR(27),F1A33
      READ (NFIL5,5700) LABEL,IVAR(24),F2A11,IVAR(28),F2A33
      READ (NFIL5,5700) LABEL,IVAR(25),F3A11,IVAR(29),F3A33
      READ (NFIL5,5700) LABEL,IVAR(30),F13
      READ (NFIL5,5700) LABEL,IVAR(31),F1A13
      READ (NFIL5,5700) LABEL,IVAR(32),F2A13
      READ (NFIL5,5700) LABEL,IVAR(33),F3A13
      READ (NFIL5,5700) LABEL,IVAR(34),F111,IVAR(37),F333
      READ (NFIL5,5700) LABEL,IVAR(35),F1A111,IVAR(38),F1A333
      READ (NFIL5,5700) LABEL,IVAR(36),F2A111,IVAR(39),F2A333
      READ (NFIL5,5700) LABEL,IVAR(40),F113,IVAR(43),F133
      READ (NFIL5,5700) LABEL,IVAR(41),F1A113,IVAR(44),F1A133
      READ (NFIL5,5700) LABEL,IVAR(42),F2A113,IVAR(45),F2A133
      READ (NFIL5,5700) LABEL,IVAR(46),F1111,IVAR(48),F3333
      READ (NFIL5,5700) LABEL,IVAR(47),FA1111,IVAR(49),FA3333
      READ (NFIL5,5700) LABEL,IVAR(50),F1113,IVAR(52),F1333
      READ (NFIL5,5700) LABEL,IVAR(51),FA1113,IVAR(53),FA1333
      READ (NFIL5,5700) LABEL,IVAR(54),F1133
      READ (NFIL5,5700) LABEL,IVAR(55),FA1133
      READ (NFIL5,5705) LABEL,P0
      READ (NFIL5,5705) LABEL,PA1
      READ (NFIL5,5705) LABEL,PA2
      READ (NFIL5,5705) LABEL,PA3
      READ (NFIL5,5705) LABEL,PA4
      READ (NFIL5,5705) LABEL,PA5
      READ (NFIL5,5705) LABEL,PA6
      READ (NFIL5,5705) LABEL,PA7
      READ (NFIL5,5705) LABEL,PA8
      READ (NFIL5,5705) LABEL,P1,P3
      READ (NFIL5,5705) LABEL,P1A1,P1A3
      READ (NFIL5,5705) LABEL,P2A1,P2A3
      READ (NFIL5,5705) LABEL,P3A1,P3A3
      READ (NFIL5,5705) LABEL,P4A1,P4A3
      READ (NFIL5,5705) LABEL,P11,P33
      READ (NFIL5,5705) LABEL,P1A11,P1A33
      READ (NFIL5,5705) LABEL,P2A11,P2A33
      READ (NFIL5,5705) LABEL,P3A11,P3A33
      READ (NFIL5,5705) LABEL,P13
      READ (NFIL5,5705) LABEL,P1A13
      READ (NFIL5,5705) LABEL,P2A13
      READ (NFIL5,5705) LABEL,P3A13
      READ (NFIL5,5705) LABEL,P111,P333
      READ (NFIL5,5705) LABEL,P1A111,P1A333
      READ (NFIL5,5705) LABEL,P2A111,P2A333
      READ (NFIL5,5705) LABEL,P113,P133
      READ (NFIL5,5705) LABEL,P1A113,P1A133
      READ (NFIL5,5705) LABEL,P2A113,P2A133
      READ (NFIL5,5705) LABEL,P1111,P3333
      READ (NFIL5,5705) LABEL,PA1111,PA3333
      READ (NFIL5,5705) LABEL,P1113,P1333
      READ (NFIL5,5705) LABEL,PA1113,PA1333
      READ (NFIL5,5705) LABEL,P1133
      READ (NFIL5,5705) LABEL,PA1133
      READ (NFIL5,5705) LABEL,O0
      READ (NFIL5,5705) LABEL,OA1
      READ (NFIL5,5705) LABEL,OA2
      READ (NFIL5,5705) LABEL,OA3
      READ (NFIL5,5705) LABEL,OA4
      READ (NFIL5,5705) LABEL,OA5
      READ (NFIL5,5705) LABEL,OA6
      READ (NFIL5,5705) LABEL,OA7
      READ (NFIL5,5705) LABEL,OA8
      READ (NFIL5,5705) LABEL,O1,O3
      READ (NFIL5,5705) LABEL,O1A1,O1A3
      READ (NFIL5,5705) LABEL,O2A1,O2A3
      READ (NFIL5,5705) LABEL,O3A1,O3A3
      READ (NFIL5,5705) LABEL,O4A1,O4A3
      READ (NFIL5,5705) LABEL,O11,O33
      READ (NFIL5,5705) LABEL,O1A11,O1A33
      READ (NFIL5,5705) LABEL,O2A11,O2A33
      READ (NFIL5,5705) LABEL,O3A11,O3A33
      READ (NFIL5,5705) LABEL,O13
      READ (NFIL5,5705) LABEL,O1A13
      READ (NFIL5,5705) LABEL,O2A13
      READ (NFIL5,5705) LABEL,O3A13
      READ (NFIL5,5705) LABEL,O111,O333
      READ (NFIL5,5705) LABEL,O1A111,O1A333
      READ (NFIL5,5705) LABEL,O2A111,O2A333
      READ (NFIL5,5705) LABEL,O113,O133
      READ (NFIL5,5705) LABEL,O1A113,O1A133
      READ (NFIL5,5705) LABEL,O2A113,O2A133
      READ (NFIL5,5705) LABEL,O1111,O3333
      READ (NFIL5,5705) LABEL,OA1111,OA3333
      READ (NFIL5,5705) LABEL,O1113,O1333
      READ (NFIL5,5705) LABEL,OA1113,OA1333
      READ (NFIL5,5705) LABEL,O1133
      READ (NFIL5,5705) LABEL,OA1133
800   WRITE (NFIL6,5790)
      WRITE (NFIL6,5800) RE12,RE32
      WRITE (NFIL6,5900) AA1,AA3
      WRITE (NFIL6,5990)
      WRITE (NFIL6,6000) F1A1,F1A3
      WRITE (NFIL6,6010) F2A1,F2A3
      WRITE (NFIL6,6020) F3A1,F3A3
      WRITE (NFIL6,6030) F4A1,F4A3
      WRITE (NFIL6,6040) F11,F33
      WRITE (NFIL6,6050) F1A11,F1A33
      WRITE (NFIL6,6060) F2A11,F2A33
      WRITE (NFIL6,6070) F3A11,F3A33
      WRITE (NFIL6,6080) F13
      WRITE (NFIL6,6090) F1A13
      WRITE (NFIL6,6100) F2A13
      WRITE (NFIL6,6110) F3A13
      WRITE (NFIL6,6120) F111,F333
      WRITE (NFIL6,6130) F1A111,F1A333
      WRITE (NFIL6,6140) F2A111,F2A333
      WRITE (NFIL6,6150) F113,F133
      WRITE (NFIL6,6160) F1A113,F1A133
      WRITE (NFIL6,6170) F2A113,F2A133
      WRITE (NFIL6,6180) F1111,F3333
      WRITE (NFIL6,6190) FA1111,FA3333
      WRITE (NFIL6,6200) F1113,F1333
      WRITE (NFIL6,6210) FA1113,FA1333
      WRITE (NFIL6,6220) F1133
      WRITE (NFIL6,6230) FA1133
      WRITE (NFIL6,5711) P0,PA1,PA2,PA3,PA4,PA5,PA6,PA7,PA8
      WRITE (NFIL6,6999) P1,P3
      WRITE (NFIL6,7000) P1A1,P1A3
      WRITE (NFIL6,7010) P2A1,P2A3
      WRITE (NFIL6,7020) P3A1,P3A3
      WRITE (NFIL6,7030) P4A1,P4A3
      WRITE (NFIL6,7040) P11,P33
      WRITE (NFIL6,7050) P1A11,P1A33
      WRITE (NFIL6,7060) P2A11,P2A33
      WRITE (NFIL6,7070) P3A11,P3A33
      WRITE (NFIL6,7080) P13
      WRITE (NFIL6,7090) P1A13
      WRITE (NFIL6,7100) P2A13
      WRITE (NFIL6,7110) P3A13
      WRITE (NFIL6,7120) P111,P333
      WRITE (NFIL6,7130) P1A111,P1A333
      WRITE (NFIL6,7140) P2A111,P2A333
      WRITE (NFIL6,7150) P113,P133
      WRITE (NFIL6,7160) P1A113,P1A133
      WRITE (NFIL6,7170) P2A113,P2A133
      WRITE (NFIL6,7180) P1111,P3333
      WRITE (NFIL6,7190) PA1111,PA3333
      WRITE (NFIL6,7200) P1113,P1333
      WRITE (NFIL6,7210) PA1113,PA1333
      WRITE (NFIL6,7220) P1133
      WRITE (NFIL6,7230) PA1133
      WRITE (NFIL6,5712) O0,OA1,OA2,OA3,OA4,OA5,OA6,OA7,OA8
      WRITE (NFIL6,7999) O1,O3
      WRITE (NFIL6,8000) O1A1,O1A3
      WRITE (NFIL6,8010) O2A1,O2A3
      WRITE (NFIL6,8020) O3A1,O3A3
      WRITE (NFIL6,8030) O4A1,O4A3
      WRITE (NFIL6,8040) O11,O33
      WRITE (NFIL6,8050) O1A11,O1A33
      WRITE (NFIL6,8060) O2A11,O2A33
      WRITE (NFIL6,8070) O3A11,O3A33
      WRITE (NFIL6,8080) O13
      WRITE (NFIL6,8090) O1A13
      WRITE (NFIL6,8100) O2A13
      WRITE (NFIL6,8110) O3A13
      WRITE (NFIL6,8120) O111,O333
      WRITE (NFIL6,8130) O1A111,O1A333
      WRITE (NFIL6,8140) O2A111,O2A333
      WRITE (NFIL6,8150) O113,O133
      WRITE (NFIL6,8160) O1A113,O1A133
      WRITE (NFIL6,8170) O2A113,O2A133
      WRITE (NFIL6,8180) O1111,O3333
      WRITE (NFIL6,8190) OA1111,OA3333
      WRITE (NFIL6,8200) O1113,O1333
      WRITE (NFIL6,8210) OA1113,OA1333
      WRITE (NFIL6,8220) O1133
      WRITE (NFIL6,8230) OA1133
      READ (NFIL5,5701) LABEL,ABSTMP
      READ (NFIL5,5701) LABEL,FRQLO
      READ (NFIL5,5701) LABEL,FRQHI
      READ (NFIL5,5701) LABEL,XINLIM
      READ (NFIL5,5701) LABEL,TRTLIM
      READ (NFIL5,5701) LABEL,ENGLIM
      READ (NFIL5,5500) LABEL,V0TYPE
      WRITE (NFIL6,6240) V0TYPE
      READ (NFIL5,5500) LABEL,NATTS
      READ (NFIL5,5701) LABEL,RHOMAX
      READ (NFIL5,5701) LABEL,ETRIAL
      READ (NFIL5,5701) LABEL,PNM1
      READ (NFIL5,5500) LABEL,NSTINT
      READ (NFIL5,5500) LABEL,NSERIN
      IF (NSERIN .LT. 20) NSERIN=20
      READ (NFIL5,5500) LABEL,NSERP
      READ (NFIL5,5500) LABEL,NSERQ
      WRITE (NFIL6,6300) RHOMAX,ETRIAL,PNM1,NSTINT,NSERIN,
     1                  NSERP,NSERQ,ABSTMP,FRQLO,FRQHI,XINLIM,
     1                  TRTLIM,ENGLIM
      READ (NFIL5,5500) LABEL,NSTNIN
      WRITE (NFIL6,6400) NATTS,NSTNIN
      READ (NFIL5,5701) LABEL,THRSH1
      READ (NFIL5,5701) LABEL,THRSH2
      READ (NFIL5,5701) LABEL,THRSH3
      READ (NFIL5,5701) LABEL,THRSH4
      READ (NFIL5,5701) LABEL,THRSH5
      WRITE (NFIL6,6500) THRSH1,THRSH2,THRSH3,THRSH4,THRSH5
      READ (NFIL5,5500) LABEL,IOPT
      IF (IOPT .LT. 1 .OR. IOPT .GT. 4) IOPT=1
      READ (NFIL5,5500) LABEL,ITEST
      READ (NFIL5,5500) LABEL,IDPMA
      READ (NFIL5,5500) LABEL,PRTINT
      WRITE (NFIL6,6600) IOPT,ITEST,PRTINT,IDPMA
      WRITE (NFIL6,6700)
      HSTEP=RHOMAX/FLOAT(NSTINT)
      RETURN
9000  WRITE (NFIL6,9002)
      STOP
4990  FORMAT('1','MORBID.INP.INF  INPUT PROCESSING ROUTINE',
     1      ' CALLED'//)
5000  FORMAT(A80)
5100  FORMAT('0',3(132('*')/' '),16('*'),100X,16('*')/
     1      4(' ',16('*'),10X,A80,10X,16('*')/),
     2        ' ',16('*'),100X,16('*')/' ',3(132('*')/' '))
5300  FORMAT('0',//,5X,12('*'),' ATOMIC MASSES ',12('*')//
     1      ' ',10X,64('-')/
     1      ' ',10X,'*',7X,'*',54X,'*'/
     1      ' ',10X,'* ISOT. *',6X,'M1/AMU',12X,
     1      'M2/AMU',12X,'M3/AMU',6X,'*'/
     1      ' ',10X,'*',7X,'*',54X,'*'/
     1      ' ',10X,64('-'))
5400  FORMAT(' ',10X,'*  ',I3,2X,'*  ',F14.8,4X,F14.8,
     1      4X,F14.8,'  *')
5340  FORMAT('0',//,5X,12('*'),' NUCLEAR CHARGES ',12('*')//
     1      ' ',10X,64('-')/
     1      ' ',10X,'*',7X,'*',54X,'*'/
     1       ' ',10X,'*  ',5X,'*  ',8X,'NUC. 1',12X,'NUC. 2',
     1     12X,'NUC. 3','  *'/
     1      ' ',10X,'*',7X,'*',54X,'*'/
     1      ' ',10X,64('-')/
     1       ' ',10X,'*  ',5X,'*  ',I14,4X,I14,
     1      4X,I14,'  *')
5345  FORMAT('0',//,5X,12('*'),' VIBRATIONAL TRANSITION ',
     1                                             12('*')//
     1      ' ',10X,64('-')/
     1      ' ',10X,'*',7X,'*',54X,'*'/
     1       ' ',10X,'*  ',5X,'*  ',8X,'  V2  ',12X,'  NV  ',
     1     12X,' IAB  ','  *'/
     1      ' ',10X,'*',7X,'*',54X,'*'/
     1      ' ',10X,64('-')/
     1       ' ',10X,'*   A   *  ',I14,4X,I14,
     1      4X,I14,'  *'/
     1       ' ',10X,'*   B   *  ',I14,4X,I14,
     1      4X,I14,'  *'/
     1       ' ',10X,64('-'))
5342  FORMAT('0',//,5X,12('*'),' SPIN STATISTICAL WEIGHTS ',
     1                                             12('*')//
     1      ' ',10X,64('-')/
     1      ' ',10X,'*',7X,'*',54X,'*'/
     1       ' ',10X,'* ISOT. *  ',8X,'GNS(A)',20X,
     1         'GNS(B)',10X,'  *'/
     1      ' ',10X,'*',7X,'*',54X,'*'/
     1      ' ',10X,64('-'))
5343  FORMAT( ' ',10X,'*  ',I3,'  *  ',I14,12X,
     1         I14,10X,'  *')
5341  FORMAT('0',5X,12('*'),' NUMBER OF ELECTRONS ',
     1                       12('*')//
     2      17X,'   NELEC    =',I12)
5410  FORMAT(' ',10X,64('-'))
5430  FORMAT('0',//,5X,12('*'),' QUANTUM NUMBER LIMITS ',12('*')//
     1      ' ',10X,99('-')/
     1      ' ',10X,'*',7X,'*',89X,'*'/
     1      ' ',10X,'* ISOT. *',6X,' JMAX ',12X,
     1      'V2MAX ',12X,'MBASIS',12X,
     1      'LSTYP1',12X,'LSTYP2',5X,'*'/
     1      ' ',10X,'*',7X,'*',89X,'*'/
     1      ' ',10X,99('-'))
5440  FORMAT(' ',10X,'*  ',I3,2X,'*  ',5X,I4,14X,I4,
     1      14X,I4,14X,I4,14X,I4,'      *')
5450  FORMAT(' ',10X,99('-'))
5500  FORMAT(A10,5I4)
5701  FORMAT(A10,3D16.8)
5705  FORMAT(A10,2D16.8)
5700  FORMAT(A10,3(I2,D16.8))
5710  FORMAT('0',5X,12('*'),' BENDING ENERGY EXPANSION COEFFI',
     1      'CIENTS (CM-1) ',12('*')//
     2      17X,'   RHOE/DEG =',F16.5/
     2      17X,'   FA1      =',F16.5,'   FA2      =',F16.5/
     3      17X,'   FA3      =',F16.5,'   FA4      =',F16.5/
     4      17X,'   FA5      =',F16.5,'   FA6      =',F16.5/
     4      17X,'   FA7      =',F16.5,'   FA8      =',F16.5)
5711  FORMAT('0',5X,12('*'),' PARALLEL DIPOLE MOMENT (DEBYE) ',
     1                       12('*')//
     2  '0',17X,'   P0      =',F16.5/
     2  '0',17X,'   PA1     =',F16.5,'   PA2     =',F16.5/
     3  '0',17X,'   PA3     =',F16.5,'   PA4     =',F16.5/
     4  '0',17X,'   PA5     =',F16.5,'   PA6     =',F16.5/
     4  '0',17X,'   PA7     =',F16.5,'   PA8     =',F16.5)
5712  FORMAT('0',5X,12('*'),' PERPENDICULAR DIPOLE MOMENT (DEBYE) ',
     1                       12('*')//
     2  '0',17X,'   O0      =',F16.5/
     2  '0',17X,'   OA1     =',F16.5,'   OA2     =',F16.5/
     3  '0',17X,'   OA3     =',F16.5,'   OA4     =',F16.5/
     4  '0',17X,'   OA5     =',F16.5,'   OA6     =',F16.5/
     4  '0',17X,'   OA7     =',F16.5,'   OA8     =',F16.5)
5720  FORMAT(A6)
5790  FORMAT('0',5X,12('*'),' MOLECULAR PARAMETERS ',12('*')//)
5800  FORMAT('0',17X,'    RE12 =',F10.6,' ANGSTROM,   RE32 =',
     1      F10.6,' ANGSTROM'/)
5900  FORMAT('0',17X,'    A1   =',F8.4,' ANGSTROM-1,   A3   =',
     1      F8.4,' ANGSTROM-1'/)
5990  FORMAT('0',5X,12('*'),' POTENTIAL ENERGY EXPANSION COEFFI',
     1      'CIENTS (CM-1) ',12('*')//)
6000  FORMAT('0',17X,'   F1A1    =',F16.5,'   F1A3    =',F16.5)
6010  FORMAT('0',17X,'   F2A1    =',F16.5,'   F2A3    =',F16.5)
6020  FORMAT('0',17X,'   F3A1    =',F16.5,'   F3A3    =',F16.5)
6030  FORMAT('0',17X,'   F4A1    =',F16.5,'   F4A3    =',F16.5)
6040  FORMAT('0',17X,'   F11     =',F16.5,'   F33     =',F16.5)
6050  FORMAT('0',17X,'   F1A11   =',F16.5,'   F1A33   =',F16.5)
6060  FORMAT('0',17X,'   F2A11   =',F16.5,'   F2A33   =',F16.5)
6070  FORMAT('0',17X,'   F3A11   =',F16.5,'   F3A33   =',F16.5)
6080  FORMAT('0',17X,'   F13     =',F16.5)
6090  FORMAT('0',17X,'   F1A13   =',F16.5)
6100  FORMAT('0',17X,'   F2A13   =',F16.5)
6110  FORMAT('0',17X,'   F3A13   =',F16.5)
6120  FORMAT('0',17X,'   F111    =',F16.5,'   F333    =',F16.5)
6130  FORMAT('0',17X,'   F1A111  =',F16.5,'   F1A333  =',F16.5)
6140  FORMAT('0',17X,'   F2A111  =',F16.5,'   F2A333  =',F16.5)
6150  FORMAT('0',17X,'   F113    =',F16.5,'   F133    =',F16.5)
6160  FORMAT('0',17X,'   F1A113  =',F16.5,'   F1A133  =',F16.5)
6170  FORMAT('0',17X,'   F2A113  =',F16.5,'   F2A133  =',F16.5)
6180  FORMAT('0',17X,'   F1111   =',F16.5,'   F3333   =',F16.5)
6190  FORMAT('0',17X,'   F1A1111 =',F16.5,'   F1A3333 =',F16.5)
6200  FORMAT('0',17X,'   F1113   =',F16.5,'   F1333   =',F16.5)
6210  FORMAT('0',17X,'   F1A1113 =',F16.5,'   F1A1333 =',F16.5)
6220  FORMAT('0',17X,'   F1133   =',F16.5)
6230  FORMAT('0',17X,'   F1A1133 =',F16.5//)
6999  FORMAT('0',17X,'   P1      =',F16.5,'   P3      =',F16.5)
7000  FORMAT('0',17X,'   P1A1    =',F16.5,'   P1A3    =',F16.5)
7010  FORMAT('0',17X,'   P2A1    =',F16.5,'   P2A3    =',F16.5)
7020  FORMAT('0',17X,'   P3A1    =',F16.5,'   P3A3    =',F16.5)
7030  FORMAT('0',17X,'   P4A1    =',F16.5,'   P4A3    =',F16.5)
7040  FORMAT('0',17X,'   P11     =',F16.5,'   P33     =',F16.5)
7050  FORMAT('0',17X,'   P1A11   =',F16.5,'   P1A33   =',F16.5)
7060  FORMAT('0',17X,'   P2A11   =',F16.5,'   P2A33   =',F16.5)
7070  FORMAT('0',17X,'   P3A11   =',F16.5,'   P3A33   =',F16.5)
7080  FORMAT('0',17X,'   P13     =',F16.5)
7090  FORMAT('0',17X,'   P1A13   =',F16.5)
7100  FORMAT('0',17X,'   P2A13   =',F16.5)
7110  FORMAT('0',17X,'   P3A13   =',F16.5)
7120  FORMAT('0',17X,'   P111    =',F16.5,'   P333    =',F16.5)
7130  FORMAT('0',17X,'   P1A111  =',F16.5,'   P1A333  =',F16.5)
7140  FORMAT('0',17X,'   P2A111  =',F16.5,'   P2A333  =',F16.5)
7150  FORMAT('0',17X,'   P113    =',F16.5,'   P133    =',F16.5)
7160  FORMAT('0',17X,'   P1A113  =',F16.5,'   P1A133  =',F16.5)
7170  FORMAT('0',17X,'   P2A113  =',F16.5,'   P2A133  =',F16.5)
7180  FORMAT('0',17X,'   P1111   =',F16.5,'   P3333   =',F16.5)
7190  FORMAT('0',17X,'   P1A1111 =',F16.5,'   P1A3333 =',F16.5)
7200  FORMAT('0',17X,'   P1113   =',F16.5,'   P1333   =',F16.5)
7210  FORMAT('0',17X,'   P1A1113 =',F16.5,'   P1A1333 =',F16.5)
7220  FORMAT('0',17X,'   P1133   =',F16.5)
7230  FORMAT('0',17X,'   P1A1133 =',F16.5//)
7999  FORMAT('0',17X,'   O1      =',F16.5,'   O3      =',F16.5)
8000  FORMAT('0',17X,'   O1A1    =',F16.5,'   O1A3    =',F16.5)
8010  FORMAT('0',17X,'   O2A1    =',F16.5,'   O2A3    =',F16.5)
8020  FORMAT('0',17X,'   O3A1    =',F16.5,'   O3A3    =',F16.5)
8030  FORMAT('0',17X,'   O4A1    =',F16.5,'   O4A3    =',F16.5)
8040  FORMAT('0',17X,'   O11     =',F16.5,'   O33     =',F16.5)
8050  FORMAT('0',17X,'   O1A11   =',F16.5,'   O1A33   =',F16.5)
8060  FORMAT('0',17X,'   O2A11   =',F16.5,'   O2A33   =',F16.5)
8070  FORMAT('0',17X,'   O3A11   =',F16.5,'   O3A33   =',F16.5)
8080  FORMAT('0',17X,'   O13     =',F16.5)
8090  FORMAT('0',17X,'   O1A13   =',F16.5)
8100  FORMAT('0',17X,'   O2A13   =',F16.5)
8110  FORMAT('0',17X,'   O3A13   =',F16.5)
8120  FORMAT('0',17X,'   O111    =',F16.5,'   O333    =',F16.5)
8130  FORMAT('0',17X,'   O1A111  =',F16.5,'   O1A333  =',F16.5)
8140  FORMAT('0',17X,'   O2A111  =',F16.5,'   O2A333  =',F16.5)
8150  FORMAT('0',17X,'   O113    =',F16.5,'   O133    =',F16.5)
8160  FORMAT('0',17X,'   O1A113  =',F16.5,'   O1A133  =',F16.5)
8170  FORMAT('0',17X,'   O2A113  =',F16.5,'   O2A133  =',F16.5)
8180  FORMAT('0',17X,'   O1111   =',F16.5,'   O3333   =',F16.5)
8190  FORMAT('0',17X,'   O1A1111 =',F16.5,'   O1A3333 =',F16.5)
8200  FORMAT('0',17X,'   O1113   =',F16.5,'   O1333   =',F16.5)
8210  FORMAT('0',17X,'   O1A1113 =',F16.5,'   O1A1333 =',F16.5)
8220  FORMAT('0',17X,'   O1133   =',F16.5)
8230  FORMAT('0',17X,'   O1A1133 =',F16.5//)
6240  FORMAT('0',5X,12('*'),' POTENTIAL EXPANSION TYPE ',
     1  12('*')//,
     2  '0',17X,' V0TYPE  = ',I5,' (V0TYPE = 1: EXPANSION IN ',
     3  '1 - COS(RHO))'/
     4  ' ',17X,'           ',5X,' (V0TYPE = 2: EXPANSION IN ',
     5  'COS(RHOE) - COS(RHO))'/)
6300  FORMAT('0',5X,12('*'),' NUMERICAL INTEGRATION PARAMETERS ',
     1  12('*')//,
     2  '0',17X,' RHOMAX  = ',F10.5,' RADIANS'/
     3  '0',17X,' ETRIAL  = ',F10.5/
     4  '0',17X,' P(N-1)  = ',E12.5/
     5  '0',17X,' NSTINT  = ',I5,' (NUMBER OF INTEGRATION STEPS)'/
     6  '0',17X,' NSERIN  = ',I5,' (POINTS IN SERIES SOLUTION REGION)'/
     7  '0',17X,' P       = ',I5,' (TERMS IN POLYNOMIAL APPROXIMATION ',
     8  'TO THE SCHROEDINGER EQUATION)'/
     9  '0',17X,' Q       = ',I5,' (TERMS IN POLYNOMIAL APPROXIMATION ',
     1  'TO THE BENDING WAVEFUNCTION)'/,
     2       '0',5X,12('*'),' INTENSITY PARAMETERS ',12('*')//,
     5  '0',17X,' ABSTMP  = ',F12.5,' (ABSOLUTE TEMPERATURE)'/
     5  '0',17X,' FRQLO   = ',F12.5,' (LOWER WAVENUMBER LIMIT)'/
     5  '0',17X,' FRQHI   = ',F12.5,' (UPPER WAVENUMBER LIMIT)'/
     5  '0',17X,' XINLIM  = ',E12.5,' (LOWER LINE STRENGTH ',
     8  'LIMIT)'/
     5  '0',17X,' TRTLIM  = ',E12.5,' (LOWER INTENSITY ',
     8  'LIMIT)'//,
     5  '0',17X,' ENGLIM  = ',E12.5,' (LOWER ENERGY ',
     8  'LIMIT)'//)
6400  FORMAT('0',5X,12('*'),' PROGRAM LIMITS ',12('*')//,
     1  '0',17X,' NATTS   = ',I5,' (NUMBER OF ATTEMPTS ALLOWED',
     2  ' IN FINDING RHOE)'/
     3  '0',17X,' NSTNIN  = ',I5,' (NUMBER OF ITERATIONS ALLOWED',
     4  ' IN THE NUMERICAL INTEGRATION)'/)
6500  FORMAT('0',5X,12('*'),' PROGRAM THRESHOLDS ',12('*')//,
     1  '0',17X,' THRSH1  = ',E10.2,' (THRESHOLD ON DERIVATIVE IN',
     2  ' FINDING RHOE)'/
     3  '0',17X,' THRSH2  = ',E10.2,' (STOPPING THRESHOLD IN FINDING',
     4  ' RHOE)'/
     3  '0',17X,' THRSH3  = ',E10.2,' (UPPER LIMIT FOR WAVEFUNCTION',
     4  ' VALUE IN OUTWARD INTEGRATION)'/
     3  '0',17X,' THRSH4  = ',E10.2,' (ERROR LIMIT IN THE NUMERICAL',
     4  ' DIFFERENTIATION)'/
     5  '0',17X,' THRSH5  = ',E10.2,' (STOPPING THRESHOLD ON ENERGY',
     6  ' IN NUMEROV-COOLEY INTEGRATION)'/)
6600  FORMAT('0',5X,12('*'),' PROGRAM FLAGS ',12('*')//,
     1  '0',17X,' IOPT    = ',I5,' (CONTROLS OUTPUT CONTENT)'/
     1  '0',17X,' ITEST   = ',I5,' (CONTROLS TEST OUTPUT)'/
     1  '0',17X,' PRTINT  = ',I5,' (NUMBER OF STEPS BETWEEN REPORTS ',
     1                           'OF F1, F2, I0 , AND V0)'/,
     1  '0',17X,' IDPMA   = ',I5,' (CONTROLS OUTPUT OF DIPOLE MOMENT ',
     1                           'MATRICES)') 
6700  FORMAT('0','MORBID.INP.INF  END OF INPUT DATA'//)
6800  FORMAT('0','MORBID.INP.WRN  RHOE CANNOT BE DETERMINED FOR ',
     1          'V0TYPE=1'/
     2      ' ','                CORRECTIVE ACTION TAKEN'//)
6900  FORMAT('0','MORBID.INP.WRN  F1A  CANNOT BE DETERMINED FOR ',
     1          'V0TYPE=2'/
     2      ' ','                CORRECTIVE ACTION TAKEN'//)
9002  FORMAT('0','MORBID.INP.ERR  WRONG POTENTIAL TYPE SPECIFIED'/
     1      ' ','                ( AND UNSYMM ARE ALLOWED)'//)
      END
C
C
      SUBROUTINE POTTYP
      IMPLICIT REAL*8 (A-H,O-Z)
C
C SUBROUTINE SETS UP PARAMETERS FOR THE PURE BENDING POTENTIAL.
C
C THERE ARE TWO POSSIBLE EXPANSIONS FOR V0:
C
C  1) V0TYPE=1, V0 IS AN EIGHT ORDER EXPANSION IN 1-COS(RHO).
C               F1A IS THEN USED AS A MOLECULAR PARAMETER, BUT
C               RHOE IS DERIVED FROM THE VALUES OF F1A, F2A,... , F8A.
C
C  2) V0TYPE=2, V0 IS AN EIGTH ORDER EXPANSION IN COS(RHOE)-COS(RHO).
C               F1A IS THEN ALWAYS EQUAL TO ZERO, AND RHOE IS USED
C               FROM INPUT.
C
C          **********************************************************
C          *                                                        *
C          *                  IMPORTANT WARNING                     *
C          *                                                        *
C          *     THE V0TYPE=2 EXPANSION IS NOT APPROPRIATE WHEN     *
C          *     RHOE=0. FOR RHOE .NE. 0, BOTH TYPES CAN BE USED    *
C          *                                                        *
C          **********************************************************
C
      REAL*8 M1,M2,M3,M,U1,U3,U13,V,RHO,EPS,
     1      CR,SR,CSE,SNE,
     2      CRE,SRE,CORO,EPSP,EPSPP,EPSPPP
C
      REAL*8 AMASS(3,10)
C
      REAL*8 RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1       AA1,AA3,
     2       F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3       F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4       F13,F1A13,F2A13,F3A13,
     5       F111,F1A111,F2A111,F333,F1A333,F2A333,
     6       F113,F1A113,F2A113,F133,F1A133,F2A133,
     7       F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8       F1333,FA1333,F1133,FA1133,
     8       RE12 , RE32 , RHOREF , VMIN
C
      REAL*8 ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1      PREC
C
      REAL*8 THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1      THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2      VELLGT , PLANCK , AVOGNO , DEGRAD , RADDEG ,
     3      PI
C
      REAL*8   B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      REAL*8   CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
      INTEGER NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5       NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6       NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7       NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6       ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7       IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8       NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER,
     9       ISOMAX , NATTS  , V0TYPE , IVAR(55) , PARMAX ,
     1       NUMPAR , PRTINT
C
      INTEGER V1 ,V2, V3 , V2MXP1, V2P1,
     1       NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2       NSEPP2 , NSEQP1 , MBASIS ,
     3       MDIM , NFSYM0, NFASY0, NFSYMJ, NFASYJ,
     4       KSTYPA(2) , LSTYPA(2) , JMAX , V2MAX , JMAXP1
C
      INTEGER IQUANT(5,10)
C
      LOGICAL SYMM
C
      REAL*8 RMK(2),AAS(2)
      INTEGER NOBAS,MBASP1,LENIW
      REAL*8 VVAL,DVDR,RHO0,RHOEDG
      INTEGER NCNT
      COMMON /ISOTOP/ IQUANT,AMASS
C
      COMMON /VALUES/ RHO,EPS,EPSP,EPSPP,EPSPPP,
     1               CR,SR,CSE,SNE,CRE,SRE,CORO
C
      COMMON /MOLCUL/ RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1               AA1,AA3,
     2               F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3               F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4               F13,F1A13,F2A13,F3A13,
     5               F111,F1A111,F2A111,F333,F1A333,F2A333,
     6               F113,F1A113,F2A113,F133,F1A133,F2A133,
     7               F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8               F1333,FA1333,F1133,FA1133,
     8               RE12 , RE32 , M1 , M2 , M3 , M ,
     9               U1 , U3 , U13 , V ,
     1               SYMM
C
      COMMON /INTEG/  ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1               RHOREF , VMIN , V0TYPE ,
     1               NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2               NSEPP2 , NSEQP1 , KSTYPA , LSTYPA
C
      COMMON /DIMEN/  MBASIS ,  V2MAX  , V2MXP1 ,
     1               JMAX   , JMAXP1 , MDIM   , NFSYM0 , NFASY0 ,
     2               NFSYMJ , NFASYJ
C
      COMMON /LSFIT/  PARMAX , NUMPAR , ISOMAX , IVAR
C
      COMMON /SYS/    THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1                     THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2                     VELLGT , PLANCK , AVOGNO , PI , PREC ,
     4                     NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5                     NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6                     NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7                     NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6                     ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7                     IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8                     NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER ,
     9                       NATTS , PRTINT
C
      COMMON/BCOEFF/
     1      B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      COMMON/CRCOEF/
     1      CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
C
      COMMON/MORSE/RMK,AAS
      COMMON/MODIM/NOBAS,MBASP1,LENIW
C
      IF (V0TYPE .LT. 1 .OR. V0TYPE .GT. 2) GOTO 9000
      IF (V0TYPE .EQ. 2) GOTO 30
C
      RHOREF=0.0D+00
C
C FIND RHOE USING NEWTON-RAPHSON
C
      NCNT=0
      RHOE=RHOMAX/2.0D+00
10    RHO0=RHOE
      CORO=1.0D+00-COS(RHOE)
      SR=SIN(RHOE)
      DVDR=(((((((8.0D+00*FA8*CORO+7.0D+00*FA7)*CORO+
     1    6.0D+00*FA6)*CORO+5.0D+00*FA5)*CORO+4.0D+00*FA4)*CORO
     2    +3.0D+00*FA3)*CORO+2.0D+00*FA2)*CORO+FA1)*SR
      VVAL=(((((((FA8*CORO+FA7)*CORO+FA6)*CORO+FA5)*CORO
     1    +FA4)*CORO+FA3)*CORO+FA2)*CORO+FA1)*CORO
      IF (ABS(DVDR) .LT. THRSH1) GOTO 20
      RHOE=RHOE-VVAL/DVDR
      IF (ABS(RHOE-RHO0) .LT. THRSH2) GOTO 20
      NCNT=NCNT+1
      IF (NCNT .GT. NATTS) GOTO 9010
      GOTO 10
20    VMIN=VVAL
      GOTO 40
30    RHOREF=RHOE
      VMIN=0.0D+00
40    RHOEDG=RHOE*1.8E+02/PI
      WRITE (NFIL6,8000) RHOEDG,VMIN
      RETURN
8000  FORMAT('1',5X,12('*'),' EQUILIBRIUM RHO VALUE',12('*')//
     2      17X,'   RHOE/DEG =',F16.5,'   VMIN     =',F16.5///)
9000  WRITE (NFIL6,9002) V0TYPE
9002  FORMAT(1H0,' MORBID.VTY.ERR  VALUE FOR V0TYPE,',I3,' NOT ALLOWED'/
     1      1H ,'                 ALLOWED VALUES ARE 1 AND 2.')
      STOP
9010  WRITE (NFIL6,9012) NATTS
9012  FORMAT(1H0,' MORBID.VTY.ERR  RHOE NOT FOUND IN ',I3,
     1      ' ITERATIONS.')
      STOP
      END
