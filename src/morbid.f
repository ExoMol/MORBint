      SUBROUTINE HEADER
      IMPLICIT REAL*8 (A-H,O-Z)
      REAL*8 M1,M2,M3,M,U1,U3,U13,V,RHO,EPS,
     1      CR,SR,CSE,SNE,
     2      CRE,SRE,CORO,EPSP,EPSPP,EPSPPP
C
      REAL*8 AMASS(3,10)
C
      REAL*8 RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1       AA1,AA3,
     2       F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3       F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4       F13,F1A13,F2A13,F3A13,
     5       F111,F1A111,F2A111,F333,F1A333,F2A333,
     6       F113,F1A113,F2A113,F133,F1A133,F2A133,
     7       F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8       F1333,FA1333,F1133,FA1133,
     8       RE12 , RE32 , RHOREF , VMIN
C
      REAL*8 ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1      PREC
C
      REAL*8 THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1      THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2      VELLGT , PLANCK , AVOGNO , DEGRAD , RADDEG ,
     3      PI
C
      REAL*8   B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      REAL*8   CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
      INTEGER NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5       NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6       NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7       NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6       ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7       IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8       NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER,
     9       ISOMAX , NATTS  , V0TYPE , IVAR(55) , PARMAX ,
     1       NUMPAR , PRTINT
C
      INTEGER V1 ,V2, V3 , V2MXP1, V2P1,
     1       NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2       NSEPP2 , NSEQP1 , MBASIS ,
     3       MDIM , NFSYM0, NFASY0, NFSYMJ, NFASYJ,
     4       KSTYPA(2) , LSTYPA(2) , JMAX , V2MAX , JMAXP1
C
      INTEGER IQUANT(5,10)
C
      LOGICAL SYMM
C
      REAL*8 RMK(2),AAS(2)
      INTEGER NOBAS,MBASP1,LENIW
      COMMON /ISOTOP/ IQUANT,AMASS
C
      COMMON /VALUES/ RHO,EPS,EPSP,EPSPP,EPSPPP,
     1               CR,SR,CSE,SNE,CRE,SRE,CORO
C
      COMMON /MOLCUL/ RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1               AA1,AA3,
     2               F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3               F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4               F13,F1A13,F2A13,F3A13,
     5               F111,F1A111,F2A111,F333,F1A333,F2A333,
     6               F113,F1A113,F2A113,F133,F1A133,F2A133,
     7               F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8               F1333,FA1333,F1133,FA1133,
     8               RE12 , RE32 , M1 , M2 , M3 , M ,
     9               U1 , U3 , U13 , V ,
     1               SYMM
C
      COMMON /INTEG/  ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1               RHOREF , VMIN , V0TYPE ,
     1               NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2               NSEPP2 , NSEQP1 , KSTYPA , LSTYPA
C
      COMMON /DIMEN/  MBASIS ,  V2MAX  , V2MXP1 ,
     1               JMAX   , JMAXP1 , MDIM   , NFSYM0 , NFASY0 ,
     2               NFSYMJ , NFASYJ
C
      COMMON /LSFIT/  PARMAX , NUMPAR , ISOMAX , IVAR
C
      COMMON /SYS/    THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1                     THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2                     VELLGT , PLANCK , AVOGNO , PI , PREC ,
     4                     NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5                     NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6                     NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7                     NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6                     ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7                     IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8                     NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER ,
     9                       NATTS , PRTINT
C
      COMMON/BCOEFF/
     1      B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      COMMON/CRCOEF/
     1      CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
C
      COMMON/MORSE/RMK,AAS
      COMMON/MODIM/NOBAS,MBASP1,LENIW
      WRITE (NFIL6,1000)
C
      WRITE (NFIL6,1001)
C
      WRITE (NFIL6,1002)
C
      WRITE (NFIL6,1003)
C
      WRITE (NFIL6,1004)
C
      WRITE (NFIL6,1005)
C
1000  FORMAT(1H1,/,30X,
     1'  IIIIII  NN        NN  TTTTTTTTTT  ',
     1'EEEEEEEEE  NN        NN    SSSSSS         11   ',/,30X,
     2'    II    NNN       NN      TT      ',
     2'EEEEEEEEE  NNN       NN  SSSSSSSSSS       11   ',/,30X,
     3'    II    NNNN      NN      TT      ',
     3'EE         NNNN      NN  SS     SSS     1111   ',/,30X,
     4'    II    NN NN     NN      TT      ',
     4'EE         NN NN     NN  SS             1111   ',/,30X,
     5'    II    NN NN     NN      TT      ',
     5'EE         NN NN     NN  SS               11   ',/,30X,
     6'    II    NN  NN    NN      TT      ',
     6'EE         NN  NN    NN  SS               11   ',/,30X,
     7'    II    NN   NN   NN      TT      ',
     7'EEEEEE     NN   NN   NN  SSSSSSS          11   ',/,30X,
     8'    II    NN   NN   NN      TT      ',
     8'EEEEEE     NN   NN   NN     SSSSSSS       11   ',/,30X,
     9'    II    NN    NN  NN      TT      ',
     9'EE         NN    NN  NN          SS       11   ')
1001  FORMAT(1H ,29X,
     1'    II    NN     NN NN      TT      ',
     1'EE         NN     NN NN          SS       11   ',/,30X,
     2'    II    NN     NN NN      TT      ',
     2'EE         NN     NN NN          SS       11   ',/,30X,
     3'    II    NN      NNNN      TT      ',
     3'EE         NN      NNNN  SS      SS       11   ',/,30X,
     4'    II    NN       NNN      TT      ',
     4'EEEEEEEEE  NN       NNN  SSSSSSSSSS     111111 ',/,30X,
     5'  IIIIII  NN        NN      TT      ',
     5'EEEEEEEEE  NN        NN    SSSSSS       111111 ')
1002  FORMAT(1H ,/,45X,
     1'                                       ZZ            ',/,45X,
     2'                                      ZZZZ           ',/,45X,
     3'                                     / ZZ            ',/,45X,
     4'                                   / R               ',/,45X,
     5'                                 /    32             ',/,45X,
     6'                R              /)  ___               ',/,45X,
     7'        XX       12       YY /   ) RHO               ',/,45X,
     8'       XXXX- - - - - - - YYYY-----)------            ',/,45X,
     9'        XX                YY                         ',/)
1003  FORMAT(1H ,//,44X,'MORSE OSCILLATOR/RIGID BENDER INTERN',
     1                  'AL DYNAMICS',
     2       1H ,//,45X,'A PROGRAM TO CALCULATE THE ROTATION-',
     3                  'VIBRATION',/,
     4              45X,'ENERGY LEVELS OF A TRIATOMIC MOLECULE ',
     5                  'AFTER',/,
     6              45X,'THE MORBID SCHEME OF PER JENSEN.'//
     7              30X,'PROGRAM DESIGNED AND WRITTEN BY :-',//)
1004  FORMAT(1H ,   27X,'                               PER JENSEN',/,
     1              27X,'PHYSICAL CHEMISTRY INSTITUTE,       ',
     1              20X,'MAX PLANCK INSTITUTE OF PHYSICS AND ',/,
     2              27X,'JUSTUS LIEBIG UNIVERSITY,           ',
     2              20X,'                             ASTROPHYSICS,',/,
     3              27X,'HEINRICH-BUFF-RING 58,              ',
     3              20X,'INSTITUTE OF ASTROPHYSICS,',/,
     4              27X,'D-6300 GIESSEN,                     ',
     4              20X,'KARL-SCHWARZSCHILD-STRASSE 1,',/,
     5              27X,'WEST GERMANY                        ',
     5              20X,'D-8046 GARCHING BEI MUENCHEN,',/,
     5              27X,'                                    ',
     6              20X,'WEST GERMANY')
1005  FORMAT(1H ,//,37X,'PARTICULAR HELP WAS GIVEN BY:-',//,
     1              42X,'R. BEARDSWORTH, P.R. BUNKER, W.P. KRAEMER,',/,
     1              42X,'REDUCEII, AND V. SPIRKO.')
C
      RETURN
      END
C
C
      SUBROUTINE RHOFCT ( SYMJ0 , ASYJ0 , SYMJP , ASYJP ,
     1                    KFSYM0 , KFASY0 , KFSYMJ , KFASYJ ,
     1                    POTSYM )
      IMPLICIT REAL*8 (A-H,O-Z)
C             :
C DATE        : 28.04.1986
C AUTHOR      : PER JENSEN
C UPDATES     :
C LANGUAGE    : FORTRAN
C PURPOSE     : SETS UP THE RHO DEPENDENT FUNCTIONS NEEDED TO
C             : CALCULATE THE ROTATION-VIBRATION ENERGIES OF A
C             : TRIATOMIC MOLECULE USING THE MORBID SCHEME.
C SUBPROGRAMS :
C      CALLED :
C             :
C
      REAL*8 M1,M2,M3,M,U1,U3,U13,V,RHO,EPS,
     1      CR,SR,CSE,SNE,
     2      CRE,SRE,CORO,EPSP,EPSPP,EPSPPP
C
      REAL*8 AMASS(3,10)
C
      REAL*8 RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1       AA1,AA3,
     2       F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3       F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4       F13,F1A13,F2A13,F3A13,
     5       F111,F1A111,F2A111,F333,F1A333,F2A333,
     6       F113,F1A113,F2A113,F133,F1A133,F2A133,
     7       F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8       F1333,FA1333,F1133,FA1133,
     8       RE12 , RE32 , RHOREF , VMIN
C
      REAL*8 ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1      PREC
C
      REAL*8 THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1      THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2      VELLGT , PLANCK , AVOGNO , DEGRAD , RADDEG ,
     3      PI
C
      REAL*8   B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      REAL*8   CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
      INTEGER NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5       NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6       NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7       NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6       ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7       IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8       NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER,
     9       ISOMAX , NATTS  , V0TYPE , IVAR(55) , PARMAX ,
     1       NUMPAR , PRTINT
C
      INTEGER V1 ,V2, V3 , V2MXP1, V2P1,
     1       NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2       NSEPP2 , NSEQP1 , MBASIS ,
     3       MDIM , NFSYM0, NFASY0, NFSYMJ, NFASYJ,
     4       KSTYPA(2) , LSTYPA(2) , JMAX , V2MAX , JMAXP1
C
      INTEGER IQUANT(5,10)
C
      LOGICAL SYMM,POTSYM
C
      REAL*8 RMK(2),AAS(2)
      INTEGER NOBAS,MBASP1,LENIW
      REAL*8 SYMJ0(KFSYM0),ASYJ0(KFASY0),SYMJP(KFSYMJ),
     1      ASYJP(KFASYJ)
      REAL*8 EPSC1,EPSC2,CORHOE
      REAL*8 MUXXY(15),MUYYY(15),MUZZY(15),MURRY(15),
     1       MUYZY(15),MUXRY(15),
     2       PX1Y(15),PX3Y(15),PR1Y(15),PR3Y(15),
     3       PXMXX1(15),PXMXX3(15),PRMXR1(15),PRMXR3(15),
     4       PXMXR1(15),PXMXR3(15),PRMRR1(15),PRMRR3(15),
     5       VCOEF(15),DMZ(15),DMY(15)
      INTEGER I,KFSYM0,KFASY0,KFSYMJ,KFASYJ,L,NREMAI,
     1       NRECS ,NREMP1
      INTEGER KESYM0 , KEASY0 , KESYMJ , KEASYJ
C
      COMMON /ISOTOP/ IQUANT,AMASS
C
      COMMON /ELECTR/ EC,ZC1,ZC2,ZC3,ZELEC
C
      COMMON /VALUES/ RHO,EPS,EPSP,EPSPP,EPSPPP,
     1               CR,SR,CSE,SNE,CRE,SRE,CORO
C
      COMMON /MOLCUL/ RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1               AA1,AA3,
     2               F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3               F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4               F13,F1A13,F2A13,F3A13,
     5               F111,F1A111,F2A111,F333,F1A333,F2A333,
     6               F113,F1A113,F2A113,F133,F1A133,F2A133,
     7               F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8               F1333,FA1333,F1133,FA1133,
     8               RE12 , RE32 , M1 , M2 , M3 , M ,
     9               U1 , U3 , U13 , V ,
     1               SYMM
C
      COMMON /INTEG/  ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1               RHOREF , VMIN , V0TYPE ,
     1               NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2               NSEPP2 , NSEQP1 , KSTYPA , LSTYPA
C
      COMMON /DIMEN/  MBASIS ,  V2MAX  , V2MXP1 ,
     1               JMAX   , JMAXP1 , MDIM   , NFSYM0 , NFASY0 ,
     2               NFSYMJ , NFASYJ
C
      COMMON /LSFIT/  PARMAX , NUMPAR , ISOMAX , IVAR
C
      COMMON /SYS/    THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1                     THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2                     VELLGT , PLANCK , AVOGNO , PI , PREC ,
     4                     NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5                     NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6                     NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7                     NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6                     ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7                     IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8                     NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER ,
     9                       NATTS , PRTINT
C
      COMMON/BCOEFF/
     1      B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      COMMON/CRCOEF/
     1      CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
C
      COMMON/MORSE/RMK,AAS
      COMMON/MODIM/NOBAS,MBASP1,LENIW
C
C
      COMMON /DIPOLE/P0,PA1,PA2,PA3,PA4,PA5,PA6,PA7,PA8,
     2               P1,P1A1,P2A1,P3A1,P4A1,
     2               P3,P1A3,P2A3,P3A3,P4A3,
     3               P11,P1A11,P2A11,P3A11,P33,P1A33,P2A33,P3A33,
     4               P13,P1A13,P2A13,P3A13,
     5               P111,P1A111,P2A111,P333,P1A333,P2A333,
     6               P113,P1A113,P2A113,P133,P1A133,P2A133,
     7               P1111,PA1111,P3333,PA3333,P1113,PA1113,
     8               P1333,PA1333,P1133,PA1133,
     1               O0,OA1,OA2,OA3,OA4,OA5,OA6,OA7,OA8,
     2               O1,O1A1,O2A1,O3A1,O4A1,
     2               O3,O1A3,O2A3,O3A3,O4A3,
     3               O11,O1A11,O2A11,O3A11,O33,O1A33,O2A33,O3A33,
     4               O13,O1A13,O2A13,O3A13,
     5               O111,O1A111,O2A111,O333,O1A333,O2A333,
     6               O113,O1A113,O2A113,O133,O1A133,O2A133,
     7               O1111,OA1111,O3333,OA3333,O1113,OA1113,
     8               O1333,OA1333,O1133,OA1133
C
      CONVU=PLANCK*AVOGNO*1.0E+16/(4.0D+00*PI*PI*VELLGT)
      U1=M1*(M3+M2)*RE12*RE12
      U3=M3*(M1+M2)*RE32*RE32
      U13=M1*M3*RE12*RE32
      V=M2*(M1+M2+M3)*RE12*RE32
      CORHOE=COS(RHOE)
      EPSC1=(U1-U3)/SQRT((U1+U3)**2-4.0E0*U13**2)
      EPSC2=SQRT((U1+U3-2.0E0*U13)/(U1+U3+2.0E0*U13))
C
C     START LOOP OVER RHO
C
      DO 1000 I=1,NSTINT
      RHO=FLOAT(I)*HSTEP
      EPS=0.5D0*RHO+EPSC1*ATAN(EPSC2*TAN(0.5D0*RHO))
      CR=COS(RHO)
      SR=SIN(RHO)
      CSE=COS(EPS)
      SNE=SIN(EPS)
      CRE=CR*CSE+SR*SNE
      SRE=SR*CSE-CR*SNE
      EPSP=(U1+U13*CR)/(U1+U3+2.0E0*U13*CR)
      EPSPP=U13*SR*(U1-U3)/(U1+U3+2.0E0*U13*CR)**2
      EPSPPP=U13*(U1-U3)*(CR/(U1+U3+2.0E0*U13*CR)**2
     1     +4.0E0*U13*SR*SR/(U1+U3+2.0E0*U13*CR)**3)
C
C     GENERATE THE COEFFICIENTS IN THE EXPANSIONS OF THE S I'S
C     IN TERMS OF THE DELTA R I'S.
C
      CALL BCOEF
C
C     GENERATE THE COEFFICIENTS IN THE EXPANSIONS OF COS RHO BAR
C     IN TERMS OF THE DELTA R I'S.
C
      CALL COSRB
C
C     GENERATE THE COEFFICIENTS IN THE EXPANSIONS OF THE MU
C     TENSOR ELEMENTS AND THE VIBRATIONAL ANGULAR MOMENTA IN
C     TERMS OF THE DELTA R I'S.
C
      CALL MUTENS ( MUXXY , MUYYY , MUZZY ,
     2             MUYZY , MURRY , MUXRY ,
     3             PXMXX1  , PXMXX3 , PRMXR1 , PRMXR3 ,
     2             PXMXR1  , PXMXR3 , PRMRR1 , PRMRR3 ,
     3             DMZ     , DMY  , POTSYM  )
C
C     GENERATE THE LEADING TERM IN THE PSEUDOPOTENTIAL TERM
C     U0 (SEE PAPER BY SARKA AND BUNKER FOR NOTATION). THE
C     PURELY VIBRATIONAL CONTRIBUTION TO U0 IS GENERATED IN U0VIB,
C     FOR THE PURELY ROTATIONAL CONTRIBUTION WE USE SARKA AND
C     BUNKER'S RESULT WITH C(RHO) = -1/SIN(RHO)*SIN(RHO)
C
      CALL U0VIB( UVVAL )
      URVAL = -MUXXY(1)/8.0D+00 - (M1+M2+M3)**2*MUXXY(1)*U13*U13/
     1                 (8.0D+00*(U1*U3-U13*U13)*(U1*U3-U13*U13*CR*CR))
C
C     GENERATE THE COEFFICIENTS IN THE EXPANSIONS OF THE
C     POTENTIAL ENERGY IN TERMS OF THE DELTA R I'S.
C
      CALL VPOT ( VCOEF )
C
C     THE VARIOUS EXPANSION COEFFICIENTS ARE NOW STORED IN
C     THE WORK ARRAY IN ORDER TO BE USED FOR CALCULATIONS
C     OF INTEGRALS
C
      IOSYM0=(I-1)*NFSYM0
      IOASY0=(I-1)*NFASY0
      IOSYMJ=(I-1)*NFSYMJ
      IOASYJ=(I-1)*NFASYJ
      SYMJ0(IOSYM0+1)=MURRY(1)
      SYMJ0(IOSYM0+2)=MURRY(2)
      SYMJ0(IOSYM0+3)=MURRY(4)
      SYMJ0(IOSYM0+4)=MURRY(6)
      SYMJ0(IOSYM0+5)=MURRY(7)
      SYMJ0(IOSYM0+6)=MURRY(9)
      SYMJ0(IOSYM0+7)=MURRY(11)
      SYMJ0(IOSYM0+8)=MURRY(13)
      SYMJ0(IOSYM0+9)=MURRY(15)
      SYMJ0(IOSYM0+10)=CONVU*(UVVAL+URVAL)
      SYMJ0(IOSYM0+11)=VCOEF(2)
      SYMJ0(IOSYM0+12)=VCOEF(4)
      SYMJ0(IOSYM0+13)=VCOEF(6)
      SYMJ0(IOSYM0+14)=VCOEF(7)
      SYMJ0(IOSYM0+15)=VCOEF(9)
      SYMJ0(IOSYM0+16)=VCOEF(11)
      SYMJ0(IOSYM0+17)=VCOEF(13)
      SYMJ0(IOSYM0+18)=VCOEF(15)
      SYMJ0(IOSYM0+19)=-CR
      SYMJ0(IOSYM0+20)=CR1/AA1
      SYMJ0(IOSYM0+21)=(CR1/2.0D+00+CR11/AA1)/AA1
      SYMJ0(IOSYM0+22)=CR13/(AA1*AA3)
      SYMJ0(IOSYM0+23)=PXMXR1(2)+PRMRR1(2)
      SYMJ0(IOSYM0+24)=PXMXR1(3)+PRMRR1(3)
      SYMJ0(IOSYM0+25)=PXMXR1(4)+PRMRR1(4)
      SYMJ0(IOSYM0+26)=PXMXR1(5)+PRMRR1(5)
      SYMJ0(IOSYM0+27)=PXMXR1(6)+PRMRR1(6)
      SYMJ0(IOSYM0+28)=PXMXR1(7)+PRMRR1(7)
      SYMJ0(IOSYM0+29)=PXMXR1(8)+PRMRR1(8)
      SYMJ0(IOSYM0+30)=PXMXR1(9)+PRMRR1(9)
      SYMJ0(IOSYM0+31)=PXMXR1(10)+PRMRR1(10)
      SYMJ0(IOSYM0+32)=DMZ(1)
      SYMJ0(IOSYM0+33)=DMZ(2)
      SYMJ0(IOSYM0+34)=DMZ(4)
      SYMJ0(IOSYM0+35)=DMZ(6)
      SYMJ0(IOSYM0+36)=DMZ(7)
      SYMJ0(IOSYM0+37)=DMZ(9)
      SYMJ0(IOSYM0+38)=DMZ(11)
      SYMJ0(IOSYM0+39)=DMZ(13)
      SYMJ0(IOSYM0+40)=DMZ(15)
      ASYJ0(IOASY0+1)=MURRY(3)
      ASYJ0(IOASY0+2)=MURRY(5)
      ASYJ0(IOASY0+3)=MURRY(8)
      ASYJ0(IOASY0+4)=MURRY(10)
      ASYJ0(IOASY0+5)=MURRY(12)
      ASYJ0(IOASY0+6)=MURRY(14)
      ASYJ0(IOASY0+7)=VCOEF(3)
      ASYJ0(IOASY0+8)=VCOEF(5)
      ASYJ0(IOASY0+9)=VCOEF(8)
      ASYJ0(IOASY0+10)=VCOEF(10)
      ASYJ0(IOASY0+11)=VCOEF(12)
      ASYJ0(IOASY0+12)=VCOEF(14)
      ASYJ0(IOASY0+13)=CR3/AA3
      ASYJ0(IOASY0+14)=(CR3/2.0D+00+CR33/AA3)/AA3
      ASYJ0(IOASY0+15)=PXMXR3(2)+PRMRR3(2)
      ASYJ0(IOASY0+16)=PXMXR3(3)+PRMRR3(3)
      ASYJ0(IOASY0+17)=PXMXR3(4)+PRMRR3(4)
      ASYJ0(IOASY0+18)=PXMXR3(5)+PRMRR3(5)
      ASYJ0(IOASY0+19)=PXMXR3(6)+PRMRR3(6)
      ASYJ0(IOASY0+20)=PXMXR3(7)+PRMRR3(7)
      ASYJ0(IOASY0+21)=PXMXR3(8)+PRMRR3(8)
      ASYJ0(IOASY0+22)=PXMXR3(9)+PRMRR3(9)
      ASYJ0(IOASY0+23)=PXMXR3(10)+PRMRR3(10)
      ASYJ0(IOASY0+24)=DMZ(3)
      ASYJ0(IOASY0+25)=DMZ(5)
      ASYJ0(IOASY0+26)=DMZ(8)
      ASYJ0(IOASY0+27)=DMZ(10)
      ASYJ0(IOASY0+28)=DMZ(12)
      ASYJ0(IOASY0+29)=DMZ(14)
      SYMJP(IOSYMJ+1)=MUXXY(1)
      SYMJP(IOSYMJ+2)=MUXXY(2)
      SYMJP(IOSYMJ+3)=MUXXY(4)
      SYMJP(IOSYMJ+4)=MUXXY(6)
      SYMJP(IOSYMJ+5)=MUXXY(7)
      SYMJP(IOSYMJ+6)=MUXXY(9)
      SYMJP(IOSYMJ+7)=MUXXY(11)
      SYMJP(IOSYMJ+8)=MUXXY(13)
      SYMJP(IOSYMJ+9)=MUXXY(15)
      SYMJP(IOSYMJ+10)=MUYYY(1)
      SYMJP(IOSYMJ+11)=MUYYY(2)
      SYMJP(IOSYMJ+12)=MUYYY(4)
      SYMJP(IOSYMJ+13)=MUYYY(6)
      SYMJP(IOSYMJ+14)=MUYYY(7)
      SYMJP(IOSYMJ+15)=MUYYY(9)
      SYMJP(IOSYMJ+16)=MUYYY(11)
      SYMJP(IOSYMJ+17)=MUYYY(13)
      SYMJP(IOSYMJ+18)=MUYYY(15)
      SYMJP(IOSYMJ+19)=MUZZY(1)
      SYMJP(IOSYMJ+20)=MUZZY(2)
      SYMJP(IOSYMJ+21)=MUZZY(4)
      SYMJP(IOSYMJ+22)=MUZZY(6)
      SYMJP(IOSYMJ+23)=MUZZY(7)
      SYMJP(IOSYMJ+24)=MUZZY(9)
      SYMJP(IOSYMJ+25)=MUZZY(11)
      SYMJP(IOSYMJ+26)=MUZZY(13)
      SYMJP(IOSYMJ+27)=MUZZY(15)
      SYMJP(IOSYMJ+28)=MUYZY(2)
      SYMJP(IOSYMJ+29)=MUYZY(4)
      SYMJP(IOSYMJ+30)=MUYZY(6)
      SYMJP(IOSYMJ+31)=MUYZY(7)
      SYMJP(IOSYMJ+32)=MUYZY(9)
      SYMJP(IOSYMJ+33)=MUYZY(11)
      SYMJP(IOSYMJ+34)=MUYZY(13)
      SYMJP(IOSYMJ+35)=MUYZY(15)
      SYMJP(IOSYMJ+36)=MUXRY(2)
      SYMJP(IOSYMJ+37)=MUXRY(4)
      SYMJP(IOSYMJ+38)=MUXRY(6)
      SYMJP(IOSYMJ+39)=MUXRY(7)
      SYMJP(IOSYMJ+40)=MUXRY(9)
      SYMJP(IOSYMJ+41)=MUXRY(11)
      SYMJP(IOSYMJ+42)=MUXRY(13)
      SYMJP(IOSYMJ+43)=MUXRY(15)
      SYMJP(IOSYMJ+44)=PXMXX1(2)+PRMXR1(2)
      SYMJP(IOSYMJ+45)=PXMXX1(3)+PRMXR1(3)
      SYMJP(IOSYMJ+46)=PXMXX1(4)+PRMXR1(4)
      SYMJP(IOSYMJ+47)=PXMXX1(5)+PRMXR1(5)
      SYMJP(IOSYMJ+48)=PXMXX1(6)+PRMXR1(6)
      SYMJP(IOSYMJ+49)=PXMXX1(7)+PRMXR1(7)
      SYMJP(IOSYMJ+50)=PXMXX1(8)+PRMXR1(8)
      SYMJP(IOSYMJ+51)=PXMXX1(9)+PRMXR1(9)
      SYMJP(IOSYMJ+52)=PXMXX1(10)+PRMXR1(10)
      SYMJP(IOSYMJ+53)=DMY(1)
      SYMJP(IOSYMJ+54)=DMY(2)
      SYMJP(IOSYMJ+55)=DMY(4)
      SYMJP(IOSYMJ+56)=DMY(6)
      SYMJP(IOSYMJ+57)=DMY(7)
      SYMJP(IOSYMJ+58)=DMY(9)
      SYMJP(IOSYMJ+59)=DMY(11)
      SYMJP(IOSYMJ+60)=DMY(13)
      SYMJP(IOSYMJ+61)=DMY(15)
      ASYJP(IOASYJ+1)=MUXXY(3)
      ASYJP(IOASYJ+2)=MUXXY(5)
      ASYJP(IOASYJ+3)=MUXXY(8)
      ASYJP(IOASYJ+4)=MUXXY(10)
      ASYJP(IOASYJ+5)=MUXXY(12)
      ASYJP(IOASYJ+6)=MUXXY(14)
      ASYJP(IOASYJ+7)=MUYYY(3)
      ASYJP(IOASYJ+8)=MUYYY(5)
      ASYJP(IOASYJ+9)=MUYYY(8)
      ASYJP(IOASYJ+10)=MUYYY(10)
      ASYJP(IOASYJ+11)=MUYYY(12)
      ASYJP(IOASYJ+12)=MUYYY(14)
      ASYJP(IOASYJ+13)=MUZZY(3)
      ASYJP(IOASYJ+14)=MUZZY(5)
      ASYJP(IOASYJ+15)=MUZZY(8)
      ASYJP(IOASYJ+16)=MUZZY(10)
      ASYJP(IOASYJ+17)=MUZZY(12)
      ASYJP(IOASYJ+18)=MUZZY(14)
      ASYJP(IOASYJ+19)=MUYZY(1)
      ASYJP(IOASYJ+20)=MUYZY(3)
      ASYJP(IOASYJ+21)=MUYZY(5)
      ASYJP(IOASYJ+22)=MUYZY(8)
      ASYJP(IOASYJ+23)=MUYZY(10)
      ASYJP(IOASYJ+24)=MUYZY(12)
      ASYJP(IOASYJ+25)=MUYZY(14)
      ASYJP(IOASYJ+26)=MUXRY(3)
      ASYJP(IOASYJ+27)=MUXRY(5)
      ASYJP(IOASYJ+28)=MUXRY(8)
      ASYJP(IOASYJ+29)=MUXRY(10)
      ASYJP(IOASYJ+30)=MUXRY(12)
      ASYJP(IOASYJ+31)=MUXRY(14)
      ASYJP(IOASYJ+32)=PXMXX3(2)+PRMXR3(2)
      ASYJP(IOASYJ+33)=PXMXX3(3)+PRMXR3(3)
      ASYJP(IOASYJ+34)=PXMXX3(4)+PRMXR3(4)
      ASYJP(IOASYJ+35)=PXMXX3(5)+PRMXR3(5)
      ASYJP(IOASYJ+36)=PXMXX3(6)+PRMXR3(6)
      ASYJP(IOASYJ+37)=PXMXX3(7)+PRMXR3(7)
      ASYJP(IOASYJ+38)=PXMXX3(8)+PRMXR3(8)
      ASYJP(IOASYJ+39)=PXMXX3(9)+PRMXR3(9)
      ASYJP(IOASYJ+40)=PXMXX3(10)+PRMXR3(10)
      ASYJP(IOASYJ+41)=DMY(3)
      ASYJP(IOASYJ+42)=DMY(5)
      ASYJP(IOASYJ+43)=DMY(8)
      ASYJP(IOASYJ+44)=DMY(10)
      ASYJP(IOASYJ+45)=DMY(12)
      ASYJP(IOASYJ+46)=DMY(14)
1000  CONTINUE
      WRITE (NFIL1) (SYMJ0(L), L=1,KFSYM0)
      WRITE (NFIL2) (ASYJ0(L), L=1,KFASY0)
      WRITE (NFIL3) (SYMJP(L), L=1,KFSYMJ)
      WRITE (NFIL4) (ASYJP(L), L=1,KFASYJ)
      RETURN
      END
C
C
      SUBROUTINE BCOEF
      IMPLICIT REAL*8 (A-H,O-Z)
C             :
C DATE        : 24.04.1986
C AUTHOR      : PER JENSEN
C UPDATES     :
C LANGUAGE    : FORTRAN
C PURPOSE     : BCOEF CALCULATES (FOR A GIVEN RHO VALUE) THE EXPANSION
C             : COEFFICIENTS (TO FOURTH ORDER) OF THE S I'S IN TERMS
C             : OF THE DELTA R I'S.
C             :
C SUBPROGRAMS :
C      CALLED :
C             :
C INPUT       : RHO  INSTANTANEOUS VALUE OF THE BENDING COORDINATE
C             :
C OUTPUT      : THE EXPANSION COEFFICIENTS OF MINUS COSINE RHO BAR IN
C             : TERMS OF THE DELTA R I'S ARE OUTPUT IN COMMON CRCOEF
C             :
C             :
      REAL*8 M1,M2,M3,M,U1,U3,U13,V,RHO,EPS,
     1      CR,SR,CSE,SNE,
     2      CRE,SRE,CORO,EPSP,EPSPP,EPSPPP
C
      REAL*8 AMASS(3,10)
C
      REAL*8 RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1       AA1,AA3,
     2       F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3       F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4       F13,F1A13,F2A13,F3A13,
     5       F111,F1A111,F2A111,F333,F1A333,F2A333,
     6       F113,F1A113,F2A113,F133,F1A133,F2A133,
     7       F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8       F1333,FA1333,F1133,FA1133,
     8       RE12 , RE32 , RHOREF , VMIN
C
      REAL*8 ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1      PREC
C
      REAL*8 THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1      THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2      VELLGT , PLANCK , AVOGNO , DEGRAD , RADDEG ,
     3      PI
C
      REAL*8   B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      REAL*8   CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
      INTEGER NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5       NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6       NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7       NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6       ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7       IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8       NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER,
     9       ISOMAX , NATTS  , V0TYPE , IVAR(55) , PARMAX ,
     1       NUMPAR , PRTINT
C
      INTEGER V1 ,V2, V3 , V2MXP1, V2P1,
     1       NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2       NSEPP2 , NSEQP1 , MBASIS ,
     3       MDIM , NFSYM0, NFASY0, NFSYMJ, NFASYJ,
     4       KSTYPA(2) , LSTYPA(2) , JMAX , V2MAX , JMAXP1
C
      INTEGER IQUANT(5,10)
C
      LOGICAL SYMM
C
      REAL*8 RMK(2),AAS(2)
      INTEGER NOBAS,MBASP1,LENIW
      REAL*8 A11,A33,A13,A31,A111,A133,A113,A311,A333,A313
      COMMON /ISOTOP/ IQUANT,AMASS
C
      COMMON /VALUES/ RHO,EPS,EPSP,EPSPP,EPSPPP,
     1               CR,SR,CSE,SNE,CRE,SRE,CORO
C
      COMMON /MOLCUL/ RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1               AA1,AA3,
     2               F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3               F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4               F13,F1A13,F2A13,F3A13,
     5               F111,F1A111,F2A111,F333,F1A333,F2A333,
     6               F113,F1A113,F2A113,F133,F1A133,F2A133,
     7               F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8               F1333,FA1333,F1133,FA1133,
     8               RE12 , RE32 , M1 , M2 , M3 , M ,
     9               U1 , U3 , U13 , V ,
     1               SYMM
C
      COMMON /INTEG/  ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1               RHOREF , VMIN , V0TYPE ,
     1               NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2               NSEPP2 , NSEQP1 , KSTYPA , LSTYPA
C
      COMMON /DIMEN/  MBASIS ,  V2MAX  , V2MXP1 ,
     1               JMAX   , JMAXP1 , MDIM   , NFSYM0 , NFASY0 ,
     2               NFSYMJ , NFASYJ
C
      COMMON /LSFIT/  PARMAX , NUMPAR , ISOMAX , IVAR
C
      COMMON /SYS/    THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1                     THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2                     VELLGT , PLANCK , AVOGNO , PI , PREC ,
     4                     NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5                     NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6                     NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7                     NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6                     ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7                     IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8                     NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER ,
     9                       NATTS , PRTINT
C
      COMMON/BCOEFF/
     1      B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      COMMON/CRCOEF/
     1      CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
C
      COMMON/MORSE/RMK,AAS
      COMMON/MODIM/NOBAS,MBASP1,LENIW
      A11=2.E0*RE12
      A13=0.E0
      A111=(V**2-SR**2*U13**2+2.E0*SR**2*U3*U1)/(V**2+2.E0*V*SR**2*
     1 U13+SR**4*U13**2)
      A133=(SR**2*U3**2*RE12**2)/((V**2+2.E0*V*SR**2*U13+SR**4*U13
     1 **2)*RE32**2)
      A113=(2.E0*SR**2*U13*U3*CR*RE12)/((V**2+2.E0*V*SR**2*U13+SR**4
     1 *U13**2)*RE32)
      A31=0.E0
      A33=2.E0*RE32
      A311=(SR**2*U1**2*RE32**2)/((V**2+2.E0*V*SR**2*U13+SR**4*U13
     1 **2)*RE12**2)
      A333=(V**2-SR**2*U13**2+2.E0*SR**2*U3*U1)/(V**2+2.E0*V*SR**2*
     1 U13+SR**4*U13**2)
      A313=(2.E0*SR**2*U13*U1*CR*RE32)/((V**2+2.E0*V*SR**2*U13+SR**4
     1 *U13**2)*RE12)
      B11=1.E0
      B13=0.E0
      B31=0.E0
      B33=1.E0
      B111=(-A111+1.E0)/(2.E0*RE12)
      B133=(-A133)/(2.E0*RE12)
      B113=(-A113)/(2.E0*RE12)
      B311=(-A311)/(2.E0*RE32)
      B333=(-A333+1.E0)/(2.E0*RE32)
      B313=(-A313)/(2.E0*RE32)
      B1111=(RE12*A113*A311+2.E0*A111**2*RE32-2.E0*A111*RE32)/(4.E0*
     1 RE12**2*RE32)
      B1333=(A133*(2.E0*RE12*A333-2.E0*RE12+A113*RE32))/(4.E0*RE12**2*
     1 RE32)
      B1113=(RE12*A113*A313+2.E0*RE12*A133*A311+3.E0*A111*A113*RE32-
     1 A113*RE32)/(4.E0*RE12**2*RE32)
      B1133=(RE12*A113*A333-RE12*A113+2.E0*RE12*A133*A313+2.E0*A111*
     1 A133*RE32+A113**2*RE32)/(4.E0*RE12**2*RE32)
      B3111=(A311*(RE12*A313+2.E0*A111*RE32-2.E0*RE32))/(4.E0*RE12*
     1 RE32**2)
      B3333=(2.E0*RE12*A333**2-2.E0*RE12*A333+A133*RE32*A313)/(4.E0*
     1 RE12*RE32**2)
      B3113=(2.E0*RE12*A311*A333+RE12*A313**2+A111*RE32*A313+2.E0*
     1 A113*RE32*A311-RE32*A313)/(4.E0*RE12*RE32**2)
      B3133=(3.E0*RE12*A313*A333-RE12*A313+A113*RE32*A313+2.E0*A133*
     1 RE32*A311)/(4.E0*RE12*RE32**2)
      B11111=(-RE12**2*A113*A311*A313-RE12**2*A133*A311**2-5.E0*
     1 RE12*A111*A113*RE32*A311+3.E0*RE12*A113*RE32*A311-5.E0*A111**
     1 3*RE32**2+6.E0*A111**2*RE32**2-A111*RE32**2)/(8.E0*RE12**3*
     1 RE32**2)
      B13333=(A133*(-5.E0*RE12**2*A333**2+6.E0*RE12**2*A333-RE12**2-
     1 3.E0*RE12*A113*RE32*A333+3.E0*RE12*A113*RE32
     1 -2.E0*RE12*A133*RE32
     1 *A313-A111*A133*RE32**2-A113**2*RE32**2))/(8.E0*RE12**3*
     1 RE32**2)
      B11113=(-2.E0*RE12**2*A113*A311*A333-RE12**2*A113*A313**2-4.E0
     1 *RE12**2*A133*A311*A313-4.E0*RE12*A111*A113*RE32*A313-8.E0*
     1 RE12*A111*A133*RE32*A311-4.E0*RE12*A113**2*RE32*A311+2.E0*
     1 RE12*A113*RE32*A313+4.E0*RE12*A133*RE32*A311-10.E0*A111**2*
     1 A113*RE32**2+6.E0*A111*A113*RE32**2)/(8.E0*RE12**3*RE32**2)
      B11333=(-2.E0*RE12**2*A113*A333**2+2.E0*RE12**2*A113*A333-8.E0*
     1 RE12**2*A133*A313*A333+4.E0*RE12**2*A133*A313-4.E0*RE12*A111*
     1 A133*RE32*A333+4.E0*RE12*A111*A133*RE32-2.E0*RE12*A113**2*
     1 RE32*A333+2.E0*RE12*A113**2*RE32-6.E0*RE12*A113*A133*RE32*
     1 A313-4.E0*RE12*A133**2*RE32*A311-6.E0*A111*A113*A133*RE32**2-
     1 A113**3*RE32**2)/(8.E0*RE12**3*RE32**2)
      B11133=(-3.E0*RE12**2*A113*A313*A333+RE12**2*A113*A313-6.E0*
     1 RE12**2*A133*A311*A333+2.E0*RE12**2*A133*A311-3.E0*RE12**2*
     1 A133*A313**2-3.E0*RE12*A111*A113*RE32*A333+3.E0*RE12*A111*
     1 A113*RE32-6.E0*RE12*A111*A133*RE32*A313-3.E0*RE12*A113**2*
     1 RE32*A313-9.E0*RE12*A113*A133*RE32*A311+RE12*A113*RE32*A333
     1 -RE12*A113*RE32+2.E0*RE12*A133*RE32*A313-6.E0*A111**2*A133*
     1 RE32**2-6.E0*A111*A113**2*RE32**2+2.E0*A111*A133*RE32**2+A113
     1 **2*RE32**2)/(8.E0*RE12**3*RE32**2)
      B31111=(A311*(-RE12**2*A311*A333-RE12**2*A313**2-3.E0*RE12*
     1 A111*RE32*A313-2.E0*RE12*A113*RE32*A311+3.E0*RE12*RE32*A313-
     1 5.E0*A111**2*RE32**2+6.E0*A111*RE32**2-RE32**2))/(8.E0*RE12**2*
     1 RE32**3)
      B33333=(-5.E0*RE12**2*A333**3+6.E0*RE12**2*A333**2-RE12**2*
     1 A333-5.E0*RE12*A133*RE32*A313*A333+3.E0*RE12*A133*RE32*A313-
     1 A113*A133*RE32**2*A313-A133**2*RE32**2*A311)/(8.E0*RE12**2*
     1 RE32**3)
      B31113=(-6.E0*RE12**2*A311*A313*A333-RE12**2*A313**3-4.E0*RE12
     1 *A111*RE32*A311*A333-2.E0*RE12*A111*RE32*A313**2-6.E0*RE12*
     1 A113*RE32*A311*A313-4.E0*RE12*A133*RE32*A311**2+4.E0*RE12*
     1 RE32*A311*A333+2.E0*RE12*RE32*A313**2-2.E0*A111**2*RE32**2*
     1 A313-8.E0*A111*A113*RE32**2*A311+2.E0*A111*RE32**2*A313+4.E0*
     1 A113*RE32**2*A311)/(8.E0*RE12**2*RE32**3)
      B31333=(-10.E0*RE12**2*A313*A333**2+6.E0*RE12**2*A313*A333-4.E0*
     1 RE12*A113*RE32*A313*A333+2.E0*RE12*A113*RE32*A313-8.E0*RE12*
     1 A133*RE32*A311*A333+4.E0*RE12*A133*RE32*A311-4.E0*RE12*A133*
     1 RE32*A313**2-2.E0*A111*A133*RE32**2*A313-A113**2*RE32**2*
     1 A313-4.E0*A113*A133*RE32**2*A311)/(8.E0*RE12**2*RE32**3)
      B31133=(-6.E0*RE12**2*A311*A333**2+2.E0*RE12**2*A311*A333-6.E0*
     1 RE12**2*A313**2*A333+RE12**2*A313**2-3.E0*RE12*A111*RE32*
     1 A313*A333+RE12*A111*RE32*A313-6.E0*RE12*A113*RE32*A311*A333
     1 +2.E0*RE12*A113*RE32*A311-3.E0*RE12*A113*RE32*A313**2-9.E0*RE12
     1 *A133*RE32*A311*A313+3.E0*RE12*RE32*A313*A333-RE12*RE32*
     1 A313-3.E0*A111*A113*RE32**2*A313-6.E0*A111*A133*RE32**2*A311-
     1 3.E0*A113**2*RE32**2*A311+A113*RE32**2*A313+2.E0*A133*RE32**2*
     1 A311)/(8.E0*RE12**2*RE32**3)
      END
C
C
      SUBROUTINE COSRB
      IMPLICIT REAL*8 (A-H,O-Z)
C             :
C DATE        : 24.04.1986
C AUTHOR      : PER JENSEN
C UPDATES     :
C LANGUAGE    : FORTRAN
C PURPOSE     : CALCULATION OF THE EXPANSION COEFFICIENTS OF COSINE RHO
C             : BAR IN TERMS OF THE DELTA R I'S.
C             : THE CODE IS GENERATED BY REDUCE.
C             :
C SUBPROGRAMS :
C      CALLED :
C             :
C INPUT       : RHO  INSTANTANEOUS VALUE OF THE BENDING COORDINATE
C             :
C OUTPUT      : THE EXPANSION COEFFICIENTS OF MINUS COSINE RHO BAR IN
C             : TERMS OF THE DELTA R I'S ARE OUTPUT IN COMMON CRCOEF
C             :
C             :
      REAL*8 M1,M2,M3,M,U1,U3,U13,V,RHO,EPS,
     1      CR,SR,CSE,SNE,
     2      CRE,SRE,CORO,EPSP,EPSPP,EPSPPP
C
      REAL*8 AMASS(3,10)
C
      REAL*8 RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1       AA1,AA3,
     2       F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3       F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4       F13,F1A13,F2A13,F3A13,
     5       F111,F1A111,F2A111,F333,F1A333,F2A333,
     6       F113,F1A113,F2A113,F133,F1A133,F2A133,
     7       F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8       F1333,FA1333,F1133,FA1133,
     8       RE12 , RE32 , RHOREF , VMIN
C
      REAL*8 ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1      PREC
C
      REAL*8 THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1      THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2      VELLGT , PLANCK , AVOGNO , DEGRAD , RADDEG ,
     3      PI
C
      REAL*8   B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      REAL*8   CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
      INTEGER NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5       NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6       NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7       NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6       ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7       IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8       NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER,
     9       ISOMAX , NATTS  , V0TYPE , IVAR(55) , PARMAX ,
     1       NUMPAR , PRTINT
C
      INTEGER V1 ,V2, V3 , V2MXP1, V2P1,
     1       NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2       NSEPP2 , NSEQP1 , MBASIS ,
     3       MDIM , NFSYM0, NFASY0, NFSYMJ, NFASYJ,
     4       KSTYPA(2) , LSTYPA(2) , JMAX , V2MAX , JMAXP1
C
      INTEGER IQUANT(5,10)
C
      LOGICAL SYMM
C
      REAL*8 RMK(2),AAS(2)
      INTEGER NOBAS,MBASP1,LENIW
      REAL*8 A11,A33,A13,A31,A111,A133,A113,A311,A333,A313,
     1      C11,C13,C211,C233,C213,
     2      Q1,Q3,Q11,Q33,Q13,Q111,Q333,Q113,Q133,Q1111,Q3333,
     3      Q1113,Q1333,Q1133
      COMMON /ISOTOP/ IQUANT,AMASS
C
      COMMON /VALUES/ RHO,EPS,EPSP,EPSPP,EPSPPP,
     1               CR,SR,CSE,SNE,CRE,SRE,CORO
C
      COMMON /MOLCUL/ RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1               AA1,AA3,
     2               F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3               F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4               F13,F1A13,F2A13,F3A13,
     5               F111,F1A111,F2A111,F333,F1A333,F2A333,
     6               F113,F1A113,F2A113,F133,F1A133,F2A133,
     7               F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8               F1333,FA1333,F1133,FA1133,
     8               RE12 , RE32 , M1 , M2 , M3 , M ,
     9               U1 , U3 , U13 , V ,
     1               SYMM
C
      COMMON /INTEG/  ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1               RHOREF , VMIN , V0TYPE ,
     1               NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2               NSEPP2 , NSEQP1 , KSTYPA , LSTYPA
C
      COMMON /DIMEN/  MBASIS ,  V2MAX  , V2MXP1 ,
     1               JMAX   , JMAXP1 , MDIM   , NFSYM0 , NFASY0 ,
     2               NFSYMJ , NFASYJ
C
      COMMON /LSFIT/  PARMAX , NUMPAR , ISOMAX , IVAR
C
      COMMON /SYS/    THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1                     THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2                     VELLGT , PLANCK , AVOGNO , PI , PREC ,
     4                     NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5                     NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6                     NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7                     NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6                     ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7                     IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8                     NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER ,
     9                       NATTS , PRTINT
C
      COMMON/BCOEFF/
     1      B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      COMMON/CRCOEF/
     1      CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
C
      COMMON/MORSE/RMK,AAS
      COMMON/MODIM/NOBAS,MBASP1,LENIW
      A11=2.E0*RE12
      A13=0.E0
      A111=(V**2-SR**2*U13**2+2.E0*SR**2*U3*U1)/(V**2+2.E0*V*SR**2*
     1 U13+SR**4*U13**2)
      A133=(SR**2*U3**2*RE12**2)/((V**2+2.E0*V*SR**2*U13+SR**4*U13
     1 **2)*RE32**2)
      A113=(2.E0*SR**2*U13*U3*CR*RE12)/((V**2+2.E0*V*SR**2*U13+SR**4
     1 *U13**2)*RE32)
      A31=0.E0
      A33=2.E0*RE32
      A311=(SR**2*U1**2*RE32**2)/((V**2+2.E0*V*SR**2*U13+SR**4*U13
     1 **2)*RE12**2)
      A333=(V**2-SR**2*U13**2+2.E0*SR**2*U3*U1)/(V**2+2.E0*V*SR**2*
     1 U13+SR**4*U13**2)
      A313=(2.E0*SR**2*U13*U1*CR*RE32)/((V**2+2.E0*V*SR**2*U13+SR**4
     1 *U13**2)*RE12)
      C11=((V*CR-SR**2*U1)*RE32)/(V+SR**2*U13)
      C13=((V*CR-SR**2*U3)*RE12)/(V+SR**2*U13)
      C211=(-(V+U13)*SR**2*U1*RE32)/((V**2+2.E0*V*SR**2*U13+SR**4*
     1 U13**2)*RE12)
      C233=(-(V+U13)*SR**2*U3*RE12)/((V**2+2.E0*V*SR**2*U13+SR**4*
     1 U13**2)*RE32)
      C213=((V**2+SR**2*U13**2+SR**2*U3*U1)*CR)/(V**2+2.E0*V*SR**2
     1 *U13+SR**4*U13**2)
      Q1=(-RE32*CR+B31*C13+B11*C11)/(RE12*RE32)
      Q3=(-RE12*CR+B33*C13+B13*C11)/(RE12*RE32)
      Q11=(RE12*(B311*C13+B31**2*C233+B31*B11*C213+B111*C11+B11
     1 **2*C211)+RE32*CR-(B31*C13+B11*C11))/(RE12**2*RE32)
      Q33=(RE12*CR+RE32*(B333*C13+B33**2*C233+B33*B13*C213+B133*
     1 C11+B13**2*C211)-(B33*C13+B13*C11))/(RE12*RE32**2)
      Q13=(RE12*RE32*(B313*C13+2.E0*B33*B31*C233+B33*B11*C213+B31*
     1 B13*C213+B113*C11+2.E0*B13*B11*C211+CR)-RE12*(B31*C13+B11*
     1 C11)-RE32*(B33*C13+B13*C11))/(RE12**2*RE32**2)
      Q111=(RE12**2*(B3111*C13+2.E0*B311*B31*C233+B311*B11*C213+
     1 B31*B111*C213+B1111*C11+2.E0*B111*B11*C211)-RE12*(B311*C13+
     1 B31**2*C233+B31*B11*C213+B111*C11+B11**2*C211)-RE32*CR+
     1 B31*C13+B11*C11)/(RE12**3*RE32)
      Q333=(-RE12*CR+RE32**2*(B3333*C13+2.E0*B333*B33*C233+B333*
     1 B13*C213+B33*B133*C213+B1333*C11+2.E0*B133*B13*C211)-RE32*(
     1 B333*C13+B33**2*C233+B33*B13*C213+B133*C11+B13**2*C211)+
     1 B33*C13+B13*C11)/(RE12*RE32**3)
      Q113=(RE12**2*RE32*(B3113*C13+2.E0*B313*B31*C233+B313*B11*
     1 C213+2.E0*B311*B33*C233+B311*B13*C213+B33*B111*C213+B31*
     1 B113*C213+B1113*C11+2.E0*B113*B11*C211+2.E0*B111*B13*C211)-
     1 RE12**2*(B311*C13+B31**2*C233+B31*B11*C213+B111*C11+B11**
     1 2*C211)+RE12*RE32*(-B313*C13-2.E0*B33*B31*C233-B33*B11*C213
     1 -B31*B13*C213-B113*C11-2.E0*B13*B11*C211-CR)+RE12*(B31*C13+
     1 B11*C11)+RE32*(B33*C13+B13*C11))/(RE12**3*RE32**2)
      Q133=(RE12*RE32**2*(B3133*C13+2.E0*B313*B33*C233+B313*B13*
     1 C213+2.E0*B333*B31*C233+B333*B11*C213+B33*B113*C213+B31*
     1 B133*C213+B1133*C11+2.E0*B113*B13*C211+2.E0*B133*B11*C211)+
     1 RE12*RE32*(-B313*C13-2.E0*B33*B31*C233-B33*B11*C213-B31*B13
     1 *C213-B113*C11-2.E0*B13*B11*C211-CR)+RE12*(B31*C13+B11*C11)
     1 -RE32**2*(B333*C13+B33**2*C233+B33*B13*C213+B133*C11+B13
     1 **2*C211)+RE32*(B33*C13+B13*C11))/(RE12**2*RE32**3)
      Q1111=(RE12**3*(B31111*C13+2.E0*B3111*B31*C233+B3111*B11*
     1 C213+B311**2*C233+B311*B111*C213+B31*B1111*C213+B11111*
     1 C11+2.E0*B1111*B11*C211+B111**2*C211)+RE12**2*(-B3111*C13-
     1 2.E0*B311*B31*C233-B311*B11*C213-B31*B111*C213-B1111*C11-2.E0*
     1 B111*B11*C211)+RE12*(B311*C13+B31**2*C233+B31*B11*C213+
     1 B111*C11+B11**2*C211)+RE32*CR-(B31*C13+B11*C11))/(RE12**4
     1 *RE32)
      Q3333=(RE12*CR+RE32**3*(2.E0*B3333*B33*C233+B3333*B13*C213+
     1 B333**2*C233+B333*B133*C213+B33*B1333*C213+B13333*C11+2.E0*
     1 B1333*B13*C211+B133**2*C211+C13*B33333)+RE32**2*(-B3333*
     1 C13-2.E0*B333*B33*C233-B333*B13*C213-B33*B133*C213-B1333*
     1 C11-2.E0*B133*B13*C211)+RE32*(B333*C13+B33**2*C233+B33*B13*
     1 C213+B133*C11+B13**2*C211)-(B33*C13+B13*C11))/(RE12*RE32
     1 **4)
      Q1113=(RE12**3*RE32*(2.E0*B3113*B31*C233+B3113*B11*C213+2.E0*
     1 B3111*B33*C233+B3111*B13*C213+2.E0*B313*B311*C233+B313*B111
     1 *C213+B311*B113*C213+B33*B1111*C213+B31*B1113*C213+B11113
     1 *C11+2.E0*B1113*B11*C211+2.E0*B1111*B13*C211+2.E0*B113*B111*
     1 C211+C13*B31113)+RE12**3*(-B3111*C13-2.E0*B311*B31*C233-
     1 B311*B11*C213-B31*B111*C213-B1111*C11-2.E0*B111*B11*C211)+
     1 RE12**2*RE32*(-B3113*C13-2.E0*B313*B31*C233-B313*B11*C213-
     1 2.E0*B311*B33*C233-B311*B13*C213-B33*B111*C213-B31*B113*C213
     1 -B1113*C11-2.E0*B113*B11*C211-2.E0*B111*B13*C211)+RE12**2*(
     1 B311*C13+B31**2*C233+B31*B11*C213+B111*C11+B11**2*C211)+
     1 RE12*RE32*(B313*C13+2.E0*B33*B31*C233+B33*B11*C213+B31*B13*
     1 C213+B113*C11+2.E0*B13*B11*C211+CR)-RE12*(B31*C13+B11*C11)-
     1 RE32*(B33*C13+B13*C11))/(RE12**4*RE32**2)
      Q1333=(RE32**3*RE12*(2.E0*B1133*B13*C211+B1133*B33*C213+2.E0*
     1 B1333*B11*C211+B1333*B31*C213+2.E0*B113*B133*C211+B113*B333
     1 *C213+B133*B313*C213+B11*B3333*C213+B13*B3133*C213+B31333
     1 *C13+2.E0*B3133*B33*C233+2.E0*B3333*B31*C233+2.E0*B313*B333*
     1 C233+C11*B11333)+RE32**3*(-B1333*C11-2.E0*B133*B13*C211-
     1 B133*B33*C213-B13*B333*C213-B3333*C13-2.E0*B333*B33*C233)+
     1 RE32**2*RE12*(-B1133*C11-2.E0*B113*B13*C211-B113*B33*C213-
     1 2.E0*B133*B11*C211-B133*B31*C213-B11*B333*C213-B13*B313*C213
     1 -B3133*C13-2.E0*B313*B33*C233-2.E0*B333*B31*C233)+RE32**2*(
     1 B133*C11+B13**2*C211+B13*B33*C213+B333*C13+B33**2*C233)+
     1 RE32*RE12*(B113*C11+2.E0*B11*B13*C211+B11*B33*C213+B13*B31*
     1 C213+B313*C13+2.E0*B31*B33*C233+CR)-RE32*(B13*C11+B33*C13)-
     1 RE12*(B11*C11+B31*C13))/(RE32**4*RE12**2)
      Q1133=(RE12**2*RE32**2*(2.E0*B3133*B31*C233+B3133*B11*C213+
     1 2.E0*B3113*B33*C233+B3113*B13*C213+B313**2*C233+B313*B113*
     1 C213+2.E0*B333*B311*C233+B333*B111*C213+B311*B133*C213+B33*
     1 B1113*C213+B31*B1133*C213+B11133*C11+2.E0*B1133*B11*C211+2.E0
     1 *B1113*B13*C211+B113**2*C211+2.E0*B133*B111*C211+C13*B31133
     1 )+RE12**2*RE32*(-B3113*C13-2.E0*B313*B31*C233-B313*B11*C213
     1 -2.E0*B311*B33*C233-B311*B13*C213-B33*B111*C213-B31*B113*
     1 C213-B1113*C11-2.E0*B113*B11*C211-2.E0*B111*B13*C211)+RE12**2
     1 *(B311*C13+B31**2*C233+B31*B11*C213+B111*C11+B11**2*C211)
     1 +RE12*RE32**2*(-B3133*C13-2.E0*B313*B33*C233-B313*B13*C213-
     1 2.E0*B333*B31*C233-B333*B11*C213-B33*B113*C213-B31*B133*C213
     1 -B1133*C11-2.E0*B113*B13*C211-2.E0*B133*B11*C211)+RE12*RE32*(
     1 B313*C13+2.E0*B33*B31*C233+B33*B11*C213+B31*B13*C213+B113*
     1 C11+2.E0*B13*B11*C211+CR)-RE12*(B31*C13+B11*C11)+RE32**2*(
     1 B333*C13+B33**2*C233+B33*B13*C213+B133*C11+B13**2*C211)-
     1 RE32*(B33*C13+B13*C11))/(RE12**3*RE32**3)
      CR1=-Q1
      CR3=-Q3
      CR11=-Q11
      CR33=-Q33
      CR13=-Q13
      CR111=-Q111
      CR333=-Q333
      CR113=-Q113
      CR133=-Q133
      CR1111=-Q1111
      CR3333=-Q3333
      CR1113=-Q1113
      CR1333=-Q1333
      CR1133=-Q1133
      RETURN
      END
C
C
      SUBROUTINE AMAT ( A1Y1,A1Z1,A2Y1,A2Z1,A3Y1,A3Z1,
     2                 A1Y3,A1Z3,A2Y3,A2Z3,A3Y3,A3Z3,
     3                 AP1Y1,AP1Z1,AP2Y1,AP2Z1,AP3Y1,AP3Z1,
     4                 AP1Y3,AP1Z3,AP2Y3,AP2Z3,AP3Y3,AP3Z3,
     5                 YE1,ZE1,YE2,ZE2,YE3,ZE3,
     6                 YEP1,ZEP1,YEP2,ZEP2,YEP3,ZEP3,
     7                 YEPP1,ZEPP1,YEPP2,ZEPP2,YEPP3,ZEPP3)
      IMPLICIT REAL*8 (A-H,O-Z)
C            :
C DATE       : 24.04.1986
C AUTHOR     : PER JENSEN
C UPDATES    :
C LANGUAGE   : FORTRAN
C PURPOSE    : CALCULATION OF THE A MATRIX, ITS DERIVATIVES AND THE
C            : A VECTOR COMPONENTS AND THEIR DERIVATIVES.
C            : THE CODE IS GENERATED BY REDUCE.
C            :
      REAL*8 M1,M2,M3,M,U1,U3,U13,V,RHO,EPS,
     1      CR,SR,CSE,SNE,
     2      CRE,SRE,CORO,EPSP,EPSPP,EPSPPP
C
      REAL*8 AMASS(3,10)
C
      REAL*8 RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1       AA1,AA3,
     2       F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3       F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4       F13,F1A13,F2A13,F3A13,
     5       F111,F1A111,F2A111,F333,F1A333,F2A333,
     6       F113,F1A113,F2A113,F133,F1A133,F2A133,
     7       F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8       F1333,FA1333,F1133,FA1133,
     8       RE12 , RE32 , RHOREF , VMIN
C
      REAL*8 ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1      PREC
C
      REAL*8 THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1      THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2      VELLGT , PLANCK , AVOGNO , DEGRAD , RADDEG ,
     3      PI
C
      REAL*8   B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      REAL*8   CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
      INTEGER NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5       NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6       NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7       NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6       ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7       IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8       NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER,
     9       ISOMAX , NATTS  , V0TYPE , IVAR(55) , PARMAX ,
     1       NUMPAR , PRTINT
C
      INTEGER V1 ,V2, V3 , V2MXP1, V2P1,
     1       NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2       NSEPP2 , NSEQP1 , MBASIS ,
     3       MDIM , NFSYM0, NFASY0, NFSYMJ, NFASYJ,
     4       KSTYPA(2) , LSTYPA(2) , JMAX , V2MAX , JMAXP1
C
      INTEGER IQUANT(5,10)
C
      LOGICAL SYMM
C
      REAL*8 RMK(2),AAS(2)
      INTEGER NOBAS,MBASP1,LENIW
      REAL*8  A1Y1,A1Z1,A2Y1,A2Z1,A3Y1,A3Z1,
     2       A1Y3,A1Z3,A2Y3,A2Z3,A3Y3,A3Z3,
     3       AP1Y1,AP1Z1,AP2Y1,AP2Z1,AP3Y1,AP3Z1,
     4       AP1Y3,AP1Z3,AP2Y3,AP2Z3,AP3Y3,AP3Z3,
     5       YE1,ZE1,YE2,ZE2,YE3,ZE3,
     6       YEP1,ZEP1,YEP2,ZEP2,YEP3,ZEP3,
     7       YEPP1,ZEPP1,YEPP2,ZEPP2,YEPP3,ZEPP3
      COMMON /ISOTOP/ IQUANT,AMASS
C
      COMMON /VALUES/ RHO,EPS,EPSP,EPSPP,EPSPPP,
     1               CR,SR,CSE,SNE,CRE,SRE,CORO
C
      COMMON /MOLCUL/ RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1               AA1,AA3,
     2               F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3               F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4               F13,F1A13,F2A13,F3A13,
     5               F111,F1A111,F2A111,F333,F1A333,F2A333,
     6               F113,F1A113,F2A113,F133,F1A133,F2A133,
     7               F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8               F1333,FA1333,F1133,FA1133,
     8               RE12 , RE32 , M1 , M2 , M3 , M ,
     9               U1 , U3 , U13 , V ,
     1               SYMM
C
      COMMON /INTEG/  ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1               RHOREF , VMIN , V0TYPE ,
     1               NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2               NSEPP2 , NSEQP1 , KSTYPA , LSTYPA
C
      COMMON /DIMEN/  MBASIS ,  V2MAX  , V2MXP1 ,
     1               JMAX   , JMAXP1 , MDIM   , NFSYM0 , NFASY0 ,
     2               NFSYMJ , NFASYJ
C
      COMMON /LSFIT/  PARMAX , NUMPAR , ISOMAX , IVAR
C
      COMMON /SYS/    THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1                     THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2                     VELLGT , PLANCK , AVOGNO , PI , PREC ,
     4                     NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5                     NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6                     NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7                     NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6                     ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7                     IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8                     NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER ,
     9                       NATTS , PRTINT
C
      COMMON/BCOEFF/
     1      B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      COMMON/CRCOEF/
     1      CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
C
      COMMON/MORSE/RMK,AAS
      COMMON/MODIM/NOBAS,MBASP1,LENIW
      A1Y1=((M3+M2)*SRE*M2)/(SR**2*M1*M3+M*M2)
      A1Z1=(-(M3+M2)*CRE*M2)/(SR**2*M1*M3+M*M2)
      A2Y1=(-((M3+M2)*SRE+CR*SNE*M3)*M1)/(
     1 SR**2*M1*M3+M*M2)
      A2Z1=(((M3+M2)*CRE-CR*CSE*M3)*M1)/(
     1 SR**2*M1*M3+M*M2)
      A3Y1=(CR*SNE*M1*M2)/(SR**2*M1*M3+M*
     1 M2)
      A3Z1=(CR*CSE*M1*M2)/(SR**2*M1*M3+M*
     1 M2)
      A1Y3=(CR*SRE*M3*M2)/(SR**2*M1*M3+M*
     1 M2)
      A1Z3=(-CR*CRE*M3*M2)/(SR**2*M1*M3+M*
     1 M2)
      A2Y3=(-((M1+M2)*SNE+CR*SRE*M1)*M3)/(
     1 SR**2*M1*M3+M*M2)
      A2Z3=(-((M1+M2)*CSE-CR*CRE*M1)*M3)/(
     1 SR**2*M1*M3+M*M2)
      A3Y3=((M1+M2)*SNE*M2)/(SR**2*M1*M3+M*M2)
      A3Z3=((M1+M2)*CSE*M2)/(SR**2*M1*M3+M*M2)
      AP1Y1=(((SR**2*M1*M3+M*M2)*(CR*U13+U3)*
     1 CRE-2.E0*(2.E0*CR*U13+U3+U1)*SR*CR*SRE
     1 *M1*M3)*(M3+M2)*M2)/((SR**2*M1*M3+M*M2)**2*(2.E0
     1 *CR*U13+U3+U1))
      AP1Z1=(((SR**2*M1*M3+M*M2)*(CR*U13+U3)*
     1 SRE+2.E0*(2.E0*CR*U13+U3+U1)*SR*CR*CRE
     1 *M1*M3)*(M3+M2)*M2)/((SR**2*M1*M3+M*M2)**2*(2.E0
     1 *CR*U13+U3+U1))
      AP2Y1=((((2.E0*CR*U13+U3+U1)*SR*SNE*M3
     1 -(CR*U13+U3)*(M3+M2)*CRE-(CR*U13+U1)*CR
     1 *CSE*M3)*(SR**2*M1*M3+M*M2)+2.E0*((M3+M2)*
     1 SRE+CR*SNE*M3)*(2.E0*CR*U13+U3+U1)*
     1 SR*CR*M1*M3)*M1)/((SR**2*M1*M3+M*M2)**2
     1 *(2.E0*CR*U13+U3+U1))
      AP2Z1=((((2.E0*CR*U13+U3+U1)*SR*CSE*M3
     1 -(CR*U13+U3)*(M3+M2)*SRE+(CR*U13+U1)*CR
     1 *SNE*M3)*(SR**2*M1*M3+M*M2)-2.E0*((M3+M2)*
     1 CRE-CR*CSE*M3)*(2.E0*CR*U13+U3+U1)*
     1 SR*CR*M1*M3)*M1)/((SR**2*M1*M3+M*M2)**2
     1 *(2.E0*CR*U13+U3+U1))
      AP3Y1=(-(((2.E0*CR*U13+U3+U1)*SR*SNE-(
     1 CR*U13+U1)*CR*CSE)*(SR**2*M1*M3+M*
     1 M2)+2.E0*(2.E0*CR*U13+U3+U1)*SR*CR**2*SNE
     1 *M1*M3)*M1*M2)/((SR**2*M1*M3+M*M2)**2*(2.E0*CR
     1 *U13+U3+U1))
      AP3Z1=(-(((2.E0*CR*U13+U3+U1)*SR*CSE+(
     1 CR*U13+U1)*CR*SNE)*(SR**2*M1*M3+M*
     1 M2)+2.E0*(2.E0*CR*U13+U3+U1)*SR*CR**2*CSE
     1 *M1*M3)*M1*M2)/((SR**2*M1*M3+M*M2)**2*(2.E0*CR
     1 *U13+U3+U1))
      AP1Y3=(-(((2.E0*CR*U13+U3+U1)*SR*SRE-(
     1 CR*U13+U3)*CR*CRE)*(SR**2*M1*M3+M*
     1 M2)+2.E0*(2.E0*CR*U13+U3+U1)*SR*CR**2*SRE
     1 *M1*M3)*M3*M2)/((SR**2*M1*M3+M*M2)**2*(2.E0*CR
     1 *U13+U3+U1))
      AP1Z3=((((2.E0*CR*U13+U3+U1)*SR*CRE+(
     1 CR*U13+U3)*CR*SRE)*(SR**2*M1*M3+M*
     1 M2)+2.E0*(2.E0*CR*U13+U3+U1)*SR*CR**2*CRE
     1 *M1*M3)*M3*M2)/((SR**2*M1*M3+M*M2)**2*(2.E0*CR
     1 *U13+U3+U1))
      AP2Y3=((((2.E0*CR*U13+U3+U1)*SR*SRE*M1
     1 -(CR*U13+U3)*CR*CRE*M1-(CR*U13+U1)
     1 *(M1+M2)*CSE)*(SR**2*M1*M3+M*M2)+2.E0*((M1+M2)*
     1 SNE+CR*SRE*M1)*(2.E0*CR*U13+U3+U1)*
     1 SR*CR*M1*M3)*M3)/((SR**2*M1*M3+M*M2)**2
     1 *(2.E0*CR*U13+U3+U1))
      AP2Z3=(-(((2.E0*CR*U13+U3+U1)*SR*CRE*
     1 M1+(CR*U13+U3)*CR*SRE*M1-(CR*U13+
     1 U1)*(M1+M2)*SNE)*(SR**2*M1*M3+M*M2)-2.E0*((M1+M2
     1 )*CSE-CR*CRE*M1)*(2.E0*CR*U13+U3+U1)*
     1 SR*CR*M1*M3)*M3)/((SR**2*M1*M3+M*M2)**2
     1 *(2.E0*CR*U13+U3+U1))
      AP3Y3=(((SR**2*M1*M3+M*M2)*(CR*U13+U1)*
     1 CSE-2.E0*(2.E0*CR*U13+U3+U1)*SR*CR*SNE
     1 *M1*M3)*(M1+M2)*M2)/((SR**2*M1*M3+M*M2)**2*(2.E0
     1 *CR*U13+U3+U1))
      AP3Z3=(-((SR**2*M1*M3+M*M2)*(CR*U13+U1)*
     1 SNE+2.E0*(2.E0*CR*U13+U3+U1)*SR*CR*CSE
     1 *M1*M3)*(M1+M2)*M2)/((SR**2*M1*M3+M*M2)**2*(2.E0
     1 *CR*U13+U3+U1))
      YE1=((M3+M2)*SRE*RE12-SNE*RE32*M3)/M
      YE2=(-(SRE*RE12*M1+SNE*RE32*M3))/M
      YE3=((M1+M2)*SNE*RE32-SRE*RE12*M1)/M
      ZE1=(-((M3+M2)*CRE*RE12+CSE*RE32*M3))/M
      ZE2=(CRE*RE12*M1-CSE*RE32*M3)/M
      ZE3=((M1+M2)*CSE*RE32+CRE*RE12*M1)/M
      YEP1=((CR*U13+U3)*(M3+M2)*CRE*RE12-(CR
     1 *U13+U1)*CSE*RE32*M3)/((2.E0*CR*U13+U3+U1)*M
     1 )
      YEP2=(-((CR*U13+U3)*CRE*RE12*M1+(CR*
     1 U13+U1)*CSE*RE32*M3))/((2.E0*CR*U13+U3+U1)*M)
      YEP3=(-((CR*U13+U3)*CRE*RE12*M1-(CR*
     1 U13+U1)*(M1+M2)*CSE*RE32))/((2.E0*CR*U13+U3+U1)*
     1 M)
      ZEP1=((CR*U13+U3)*(M3+M2)*SRE*RE12+(CR
     1 *U13+U1)*SNE*RE32*M3)/((2.E0*CR*U13+U3+U1)*M
     1 )
      ZEP2=(-((CR*U13+U3)*SRE*RE12*M1-(CR*
     1 U13+U1)*SNE*RE32*M3))/((2.E0*CR*U13+U3+U1)*M)
      ZEP3=(-((CR*U13+U3)*SRE*RE12*M1+(CR*
     1 U13+U1)*(M1+M2)*SNE*RE32))/((2.E0*CR*U13+U3+U1)*
     1 M)
      YEPP1=(2.E0*((CR*U13+U3)*(M3+M2)*CRE*RE12-(
     1 CR*U13+U1)*CSE*RE32*M3)*SR*U13-(2.E0*CR
     1 *U13+U3+U1)*(M3+M2)*SR*CRE*RE12*U13+(2.E0*
     1 CR*U13+U3+U1)*SR*CSE*RE32*M3*U13-(CR
     1 *U13+U3)**2*(M3+M2)*SRE*RE12+(CR*U13+U1)**
     1 2*SNE*RE32*M3)/((2.E0*CR*U13+U3+U1)**2*M)
      YEPP2=(-(2.E0*((CR*U13+U3)*CRE*RE12*M1+(CR
     1 *U13+U1)*CSE*RE32*M3)*SR*U13-(2.E0*CR*
     1 U13+U3+U1)*SR*CRE*RE12*M1*U13-(2.E0*CR*U13
     1 +U3+U1)*SR*CSE*RE32*M3*U13-(CR*U13+U3)**
     1 2*SRE*RE12*M1-(CR*U13+U1)**2*SNE*RE32*M3)
     1 )/((2.E0*CR*U13+U3+U1)**2*M)
      YEPP3=(-(2.E0*((CR*U13+U3)*CRE*RE12*M1-(CR
     1 *U13+U1)*(M1+M2)*CSE*RE32)*SR*U13+(2.E0*CR
     1 *U13+U3+U1)*(M1+M2)*SR*CSE*RE32*U13-(2.E0*
     1 CR*U13+U3+U1)*SR*CRE*RE12*M1*U13-(CR
     1 *U13+U3)**2*SRE*RE12*M1+(CR*U13+U1)**2*(M1
     1 +M2)*SNE*RE32))/((2.E0*CR*U13+U3+U1)**2*M)
      ZEPP1=(2.E0*((CR*U13+U3)*(M3+M2)*SRE*RE12+(
     1 CR*U13+U1)*SNE*RE32*M3)*SR*U13-(2.E0*CR
     1 *U13+U3+U1)*(M3+M2)*SR*SRE*RE12*U13-(2.E0*
     1 CR*U13+U3+U1)*SR*SNE*RE32*M3*U13+(CR
     1 *U13+U3)**2*(M3+M2)*CRE*RE12+(CR*U13+U1)**
     1 2*CSE*RE32*M3)/((2.E0*CR*U13+U3+U1)**2*M)
      ZEPP2=(-(2.E0*((CR*U13+U3)*SRE*RE12*M1-(CR
     1 *U13+U1)*SNE*RE32*M3)*SR*U13-(2.E0*CR*
     1 U13+U3+U1)*SR*SRE*RE12*M1*U13+(2.E0*CR*U13
     1 +U3+U1)*SR*SNE*RE32*M3*U13+(CR*U13+U3)**
     1 2*CRE*RE12*M1-(CR*U13+U1)**2*CSE*RE32*M3)
     1 )/((2.E0*CR*U13+U3+U1)**2*M)
      ZEPP3=(-(2.E0*((CR*U13+U3)*SRE*RE12*M1+(CR
     1 *U13+U1)*(M1+M2)*SNE*RE32)*SR*U13-(2.E0*CR
     1 *U13+U3+U1)*(M1+M2)*SR*SNE*RE32*U13-(2.E0*
     1 CR*U13+U3+U1)*SR*SRE*RE12*M1*U13+(CR
     1 *U13+U3)**2*CRE*RE12*M1+(CR*U13+U1)**2*(M1
     1 +M2)*CSE*RE32))/((2.E0*CR*U13+U3+U1)**2*M)
      RETURN
      END
C
C
      SUBROUTINE VPOT ( VCOEF )
      IMPLICIT REAL*8 (A-H,O-Z)
C             :
C DATE        : 30.04.1986
C AUTHOR      : PER JENSEN
C UPDATES     :
C LANGUAGE    : FORTRAN
C PURPOSE     : CALCULATION OF THE EXPANSION COEFFICIENTS (IN THE
C             : Y I'S) OF THE BEND-STRETCH POTENTIAL ENERGY
C             : FUNCTION.
C SUBPROGRAMS :
C      CALLED : TRNSV0,TRNSRY,TRNSPT
C             :
C INPUT       : RHO         INSTANTANEOUS VALUE OF THE BENDING COORDINAT
C             :
C OUTPUT      : VCOEF(1:15) EXPANSION COEFFICIENTS OF THE BEND-STRETCH
C             :             POTENTIAL ENERGY FUNCTION IN TERMS OF THE
C             :             YI PARAMETERS.
C             :
C             :
C    THE ARRAY CONTAINS THE COEFFICIENTS OF THE FOLLOWING
C    QUANTITIES:
C
C    I             VCOEF(I)
C  -------------------------------------------------------------
C    1             1
C    2             Y1
C    3             Y3
C    4             Y1**2
C    5             Y3**2
C    6             Y1*Y3
C    7             Y1**3
C    8             Y3**3
C    9             Y1**2*Y3
C   10             Y1*Y3**2
C   11             Y1**4
C   12             Y3**4
C   13             Y1**3*Y3
C   14             Y1*Y3**3
C   15             Y1**2*Y3**2
C
      REAL*8 M1,M2,M3,M,U1,U3,U13,V,RHO,EPS,
     1      CR,SR,CSE,SNE,
     2      CRE,SRE,CORO,EPSP,EPSPP,EPSPPP
C
      REAL*8 AMASS(3,10)
C
      REAL*8 RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1       AA1,AA3,
     2       F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3       F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4       F13,F1A13,F2A13,F3A13,
     5       F111,F1A111,F2A111,F333,F1A333,F2A333,
     6       F113,F1A113,F2A113,F133,F1A133,F2A133,
     7       F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8       F1333,FA1333,F1133,FA1133,
     8       RE12 , RE32 , RHOREF , VMIN
C
      REAL*8 ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1      PREC
C
      REAL*8 THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1      THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2      VELLGT , PLANCK , AVOGNO , DEGRAD , RADDEG ,
     3      PI
C
      REAL*8   B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      REAL*8   CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
      INTEGER NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5       NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6       NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7       NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6       ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7       IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8       NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER,
     9       ISOMAX , NATTS  , V0TYPE , IVAR(55) , PARMAX ,
     1       NUMPAR , PRTINT
C
      INTEGER V1 ,V2, V3 , V2MXP1, V2P1,
     1       NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2       NSEPP2 , NSEQP1 , MBASIS ,
     3       MDIM , NFSYM0, NFASY0, NFSYMJ, NFASYJ,
     4       KSTYPA(2) , LSTYPA(2) , JMAX , V2MAX , JMAXP1
C
      INTEGER IQUANT(5,10)
C
      LOGICAL SYMM
C
      REAL*8 RMK(2),AAS(2)
      INTEGER NOBAS,MBASP1,LENIW
      REAL*8 VCOEF(15),V0COER(15),V0COEY(15)
      COMMON /ISOTOP/ IQUANT,AMASS
C
      COMMON /VALUES/ RHO,EPS,EPSP,EPSPP,EPSPPP,
     1               CR,SR,CSE,SNE,CRE,SRE,CORO
C
      COMMON /MOLCUL/ RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1               AA1,AA3,
     2               F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3               F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4               F13,F1A13,F2A13,F3A13,
     5               F111,F1A111,F2A111,F333,F1A333,F2A333,
     6               F113,F1A113,F2A113,F133,F1A133,F2A133,
     7               F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8               F1333,FA1333,F1133,FA1133,
     8               RE12 , RE32 , M1 , M2 , M3 , M ,
     9               U1 , U3 , U13 , V ,
     1               SYMM
C
      COMMON /INTEG/  ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1               RHOREF , VMIN , V0TYPE ,
     1               NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2               NSEPP2 , NSEQP1 , KSTYPA , LSTYPA
C
      COMMON /DIMEN/  MBASIS ,  V2MAX  , V2MXP1 ,
     1               JMAX   , JMAXP1 , MDIM   , NFSYM0 , NFASY0 ,
     2               NFSYMJ , NFASYJ
C
      COMMON /LSFIT/  PARMAX , NUMPAR , ISOMAX , IVAR
C
      COMMON /SYS/    THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1                     THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2                     VELLGT , PLANCK , AVOGNO , PI , PREC ,
     4                     NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5                     NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6                     NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7                     NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6                     ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7                     IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8                     NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER ,
     9                       NATTS , PRTINT
C
      COMMON/BCOEFF/
     1      B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      COMMON/CRCOEF/
     1      CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
C
      COMMON/MORSE/RMK,AAS
      COMMON/MODIM/NOBAS,MBASP1,LENIW
      CORO=COS(RHOREF)-COS(RHO)
      CALL TRNSV0 ( V0COER )
      CALL TRNSRY ( V0COER , V0COEY )
      CORO=COS(RHOE)-COS(RHO)
      CALL TRNSPT ( VCOEF )
      VCOEF(1)=VCOEF(1)+V0COEY(1)
      VCOEF(2)=VCOEF(2)+V0COEY(2)
      VCOEF(3)=VCOEF(3)+V0COEY(3)
      VCOEF(4)=VCOEF(4)+V0COEY(4)
      VCOEF(5)=VCOEF(5)+V0COEY(5)
      VCOEF(6)=VCOEF(6)+V0COEY(6)
      VCOEF(7)=VCOEF(7)+V0COEY(7)
      VCOEF(8)=VCOEF(8)+V0COEY(8)
      VCOEF(9)=VCOEF(9)+V0COEY(9)
      VCOEF(10)=VCOEF(10)+V0COEY(10)
      VCOEF(11)=VCOEF(11)+V0COEY(11)
      VCOEF(12)=VCOEF(12)+V0COEY(12)
      VCOEF(13)=VCOEF(13)+V0COEY(13)
      VCOEF(14)=VCOEF(14)+V0COEY(14)
      VCOEF(15)=VCOEF(15)+V0COEY(15)
      RETURN
      END
C
C
      SUBROUTINE TRNSV0 ( V0COEF )
      IMPLICIT REAL*8 (A-H,O-Z)
C             :
C DATE        : 24.04.1986
C AUTHOR      : PER JENSEN
C UPDATES     :
C LANGUAGE    : FORTRAN
C PURPOSE     : TRANSFORMATION OF THE PURE BENDING POTENTIAL FROM THE
C             : RHO BAR DEPENDENT FORM TO THE RHO DEPENDENT FORM.
C             : EXPANSION COEFFICIENTS FOR R SUB I'S ARE CALCULATED.
C             : THE CODE IS GENERATED BY REDUCE.
C             :
C SUBPROGRAMS :
C      CALLED :
C             :
C INPUT       : RHO          INSTANTANEOUS VALUE OF THE BENDING COORDINA
C             :
C OUTPUT      : V0COEF(1:15) EXPANSION COEFFICIENTS OF THE BEND-STRETCH
C             :              POTENTIAL ENERGY FUNCTION IN TERMS OF THE
C             :              YI PARAMETERS.
C             :
C             :
C    THE ARRAY CONTAINS THE COEFFICIENTS OF THE FOLLOWING
C    QUANTITIES:
C
C    I             VCOEF(I)
C  -------------------------------------------------------------
C    1             1
C    2             R1
C    3             R3
C    4             R1**2
C    5             R3**2
C    6             R1*R3
C    7             R1**3
C    8             R3**3
C    9             R1**2*R3
C   10             R1*R3**2
C   11             R1**4
C   12             R3**4
C   13             R1**3*R3
C   14             R1*R3**3
C   15             R1**2*R3**2
C
      REAL*8 M1,M2,M3,M,U1,U3,U13,V,RHO,EPS,
     1      CR,SR,CSE,SNE,
     2      CRE,SRE,CORO,EPSP,EPSPP,EPSPPP
C
      REAL*8 AMASS(3,10)
C
      REAL*8 RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1       AA1,AA3,
     2       F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3       F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4       F13,F1A13,F2A13,F3A13,
     5       F111,F1A111,F2A111,F333,F1A333,F2A333,
     6       F113,F1A113,F2A113,F133,F1A133,F2A133,
     7       F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8       F1333,FA1333,F1133,FA1133,
     8       RE12 , RE32 , RHOREF , VMIN
C
      REAL*8 ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1      PREC
C
      REAL*8 THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1      THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2      VELLGT , PLANCK , AVOGNO , DEGRAD , RADDEG ,
     3      PI
C
      REAL*8   B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      REAL*8   CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
      INTEGER NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5       NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6       NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7       NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6       ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7       IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8       NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER,
     9       ISOMAX , NATTS  , V0TYPE , IVAR(55) , PARMAX ,
     1       NUMPAR , PRTINT
C
      INTEGER V1 ,V2, V3 , V2MXP1, V2P1,
     1       NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2       NSEPP2 , NSEQP1 , MBASIS ,
     3       MDIM , NFSYM0, NFASY0, NFSYMJ, NFASYJ,
     4       KSTYPA(2) , LSTYPA(2) , JMAX , V2MAX , JMAXP1
C
      INTEGER IQUANT(5,10)
C
      LOGICAL SYMM
C
      REAL*8 RMK(2),AAS(2)
      INTEGER NOBAS,MBASP1,LENIW
      REAL*8  CORO2,CORO3,CORO4,CORO5,CORO6,CORO7,
     4       Q1,Q3,Q11,Q33,Q13,
     5       Q111,Q333,Q113,Q133,
     6       Q1111,Q3333,Q1113,Q1333,Q1133,
     7       V0COEF(15),ANS1
      COMMON /ISOTOP/ IQUANT,AMASS
C
      COMMON /VALUES/ RHO,EPS,EPSP,EPSPP,EPSPPP,
     1               CR,SR,CSE,SNE,CRE,SRE,CORO
C
      COMMON /MOLCUL/ RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1               AA1,AA3,
     2               F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3               F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4               F13,F1A13,F2A13,F3A13,
     5               F111,F1A111,F2A111,F333,F1A333,F2A333,
     6               F113,F1A113,F2A113,F133,F1A133,F2A133,
     7               F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8               F1333,FA1333,F1133,FA1133,
     8               RE12 , RE32 , M1 , M2 , M3 , M ,
     9               U1 , U3 , U13 , V ,
     1               SYMM
C
      COMMON /INTEG/  ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1               RHOREF , VMIN , V0TYPE ,
     1               NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2               NSEPP2 , NSEQP1 , KSTYPA , LSTYPA
C
      COMMON /DIMEN/  MBASIS ,  V2MAX  , V2MXP1 ,
     1               JMAX   , JMAXP1 , MDIM   , NFSYM0 , NFASY0 ,
     2               NFSYMJ , NFASYJ
C
      COMMON /LSFIT/  PARMAX , NUMPAR , ISOMAX , IVAR
C
      COMMON /SYS/    THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1                     THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2                     VELLGT , PLANCK , AVOGNO , PI , PREC ,
     4                     NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5                     NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6                     NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7                     NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6                     ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7                     IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8                     NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER ,
     9                       NATTS , PRTINT
C
      COMMON/BCOEFF/
     1      B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      COMMON/CRCOEF/
     1      CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
C
      COMMON/MORSE/RMK,AAS
      COMMON/MODIM/NOBAS,MBASP1,LENIW
      CORO2=CORO*CORO
      CORO3=CORO2*CORO
      CORO4=CORO3*CORO
      CORO5=CORO4*CORO
      CORO6=CORO5*CORO
      CORO7=CORO6*CORO
      Q1=CORO*(8.E0*CORO6*FA8+7.E0*CORO5*FA7+6.E0*CORO4*FA6+5.E0*
     1 CORO3*FA5+4.E0*CORO2*FA4+3.E0*CORO*FA3+2.E0*FA2)*CR1
     2 +FA1*CR1
      Q3=CORO*(8.E0*CORO6*FA8+7.E0*CORO5*FA7+6.E0*CORO4*FA6+5.E0*
     1 CORO3*FA5+4.E0*CORO2*FA4+3.E0*CORO*FA3+2.E0*FA2)*CR3
     2 +FA1*CR3
      Q11=8.E0*CR11*CORO7*FA8+7.E0*CR11*CORO6*FA7+6.E0*CR11*CORO**
     1 5*FA6+5.E0*CR11*CORO4*FA5+4.E0*CR11*CORO3*FA4+3.E0*CR11*
     1 CORO2*FA3+2.E0*CR11*CORO*FA2+28.E0*CR1**2*CORO6*FA8+21.E0*
     1 CR1**2*CORO5*FA7+15.E0*CR1**2*CORO4*FA6+10.E0*CR1**2*CORO
     1 **3*FA5+6.E0*CR1**2*CORO2*FA4+3.E0*CR1**2*CORO*FA3+CR1**2*
     1 FA2+FA1*CR11
      Q33=8.E0*CR33*CORO7*FA8+7.E0*CR33*CORO6*FA7+6.E0*CR33*CORO**
     1 5*FA6+5.E0*CR33*CORO4*FA5+4.E0*CR33*CORO3*FA4+3.E0*CR33*
     1 CORO2*FA3+2.E0*CR33*CORO*FA2+28.E0*CR3**2*CORO6*FA8+21.E0*
     1 CR3**2*CORO5*FA7+15.E0*CR3**2*CORO4*FA6+10.E0*CR3**2*CORO
     1 **3*FA5+6.E0*CR3**2*CORO2*FA4+3.E0*CR3**2*CORO*FA3+CR3**2*
     1 FA2+FA1*CR33
      Q13=8.E0*CR13*CORO7*FA8+7.E0*CR13*CORO6*FA7+6.E0*CR13*CORO**
     1 5*FA6+5.E0*CR13*CORO4*FA5+4.E0*CR13*CORO3*FA4+3.E0*CR13*
     1 CORO2*FA3+2.E0*CR13*CORO*FA2+56.E0*CR3*CR1*CORO6*FA8+42.E0*
     1 CR3*CR1*CORO5*FA7+30.E0*CR3*CR1*CORO4*FA6+20.E0*CR3*CR1*
     1 CORO3*FA5+12.E0*CR3*CR1*CORO2*FA4+6.E0*CR3*CR1*CORO*FA3+
     1 2.E0*CR3*CR1*FA2+FA1*CR13
      Q111=8.E0*CR111*CORO7*FA8+7.E0*CR111*CORO6*FA7+6.E0*CR111*
     1 CORO5*FA6+5.E0*CR111*CORO4*FA5+4.E0*CR111*CORO3*FA4+3.E0*
     1 CR111*CORO2*FA3+2.E0*CR111*CORO*FA2+56.E0*CR11*CR1*CORO6*
     1 FA8+42.E0*CR11*CR1*CORO5*FA7+30.E0*CR11*CR1*CORO4*FA6+20.E0
     1 *CR11*CR1*CORO3*FA5+12.E0*CR11*CR1*CORO2*FA4+6.E0*CR11*
     1 CR1*CORO*FA3+2.E0*CR11*CR1*FA2+56.E0*CR1**3*CORO5*FA8+35.E0*
     1 CR1**3*CORO4*FA7+20.E0*CR1**3*CORO3*FA6+10.E0*CR1**3*CORO
     1 **2*FA5+4.E0*CR1**3*CORO*FA4+CR1**3*FA3+FA1*CR111
      Q333=8.E0*CR333*CORO7*FA8+7.E0*CR333*CORO6*FA7+6.E0*CR333*
     1 CORO5*FA6+5.E0*CR333*CORO4*FA5+4.E0*CR333*CORO3*FA4+3.E0*
     1 CR333*CORO2*FA3+2.E0*CR333*CORO*FA2+56.E0*CR33*CR3*CORO6*
     1 FA8+42.E0*CR33*CR3*CORO5*FA7+30.E0*CR33*CR3*CORO4*FA6+20.E0
     1 *CR33*CR3*CORO3*FA5+12.E0*CR33*CR3*CORO2*FA4+6.E0*CR33*
     1 CR3*CORO*FA3+2.E0*CR33*CR3*FA2+56.E0*CR3**3*CORO5*FA8+35.E0*
     1 CR3**3*CORO4*FA7+20.E0*CR3**3*CORO3*FA6+10.E0*CR3**3*CORO
     1 **2*FA5+4.E0*CR3**3*CORO*FA4+CR3**3*FA3+FA1*CR333
      Q113=8.E0*CR113*CORO7*FA8+7.E0*CR113*CORO6*FA7+6.E0*CR113*
     1 CORO5*FA6+5.E0*CR113*CORO4*FA5+4.E0*CR113*CORO3*FA4+3.E0*
     1 CR113*CORO2*FA3+2.E0*CR113*CORO*FA2+56.E0*CR13*CR1*CORO6*
     1 FA8+42.E0*CR13*CR1*CORO5*FA7+30.E0*CR13*CR1*CORO4*FA6+20.E0
     1 *CR13*CR1*CORO3*FA5+12.E0*CR13*CR1*CORO2*FA4+6.E0*CR13*
     1 CR1*CORO*FA3+2.E0*CR13*CR1*FA2+56.E0*CR11*CR3*CORO6*FA8+42.E0
     1 *CR11*CR3*CORO5*FA7+30.E0*CR11*CR3*CORO4*FA6+20.E0*CR11*
     1 CR3*CORO3*FA5+12.E0*CR11*CR3*CORO2*FA4+6.E0*CR11*CR3*CORO
     1 *FA3+2.E0*CR11*CR3*FA2+168.E0*CR3*CR1**2*CORO5*FA8+105.E0*CR3
     1 *CR1**2*CORO4*FA7+60.E0*CR3*CR1**2*CORO3*FA6+30.E0*CR3*
     1 CR1**2*CORO2*FA5+12.E0*CR3*CR1**2*CORO*FA4+3.E0*CR3*CR1**2*
     1 FA3+FA1*CR113
      Q133=8.E0*CR133*CORO7*FA8+7.E0*CR133*CORO6*FA7+6.E0*CR133*
     1 CORO5*FA6+5.E0*CR133*CORO4*FA5+4.E0*CR133*CORO3*FA4+3.E0*
     1 CR133*CORO2*FA3+2.E0*CR133*CORO*FA2+56.E0*CR13*CR3*CORO6*
     1 FA8+42.E0*CR13*CR3*CORO5*FA7+30.E0*CR13*CR3*CORO4*FA6+20.E0
     1 *CR13*CR3*CORO3*FA5+12.E0*CR13*CR3*CORO2*FA4+6.E0*CR13*
     1 CR3*CORO*FA3+2.E0*CR13*CR3*FA2+56.E0*CR33*CR1*CORO6*FA8+42.E0
     1 *CR33*CR1*CORO5*FA7+30.E0*CR33*CR1*CORO4*FA6+20.E0*CR33*
     1 CR1*CORO3*FA5+12.E0*CR33*CR1*CORO2*FA4+6.E0*CR33*CR1*CORO
     1 *FA3+2.E0*CR33*CR1*FA2+168.E0*CR3**2*CR1*CORO5*FA8+105.E0*CR3
     1 **2*CR1*CORO4*FA7+60.E0*CR3**2*CR1*CORO3*FA6+30.E0*CR3**2
     1 *CR1*CORO2*FA5+12.E0*CR3**2*CR1*CORO*FA4+3.E0*CR3**2*CR1*
     1 FA3+FA1*CR133
      Q1111=8.E0*CR1111*CORO7*FA8+7.E0*CR1111*CORO6*FA7+6.E0*
     1 CR1111*CORO5*FA6+5.E0*CR1111*CORO4*FA5+4.E0*CR1111*CORO**
     1 3*FA4+3.E0*CR1111*CORO2*FA3+2.E0*CR1111*CORO*FA2+56.E0*CR111*
     1 CR1*CORO6*FA8+42.E0*CR111*CR1*CORO5*FA7+30.E0*CR111*CR1*
     1 CORO4*FA6+20.E0*CR111*CR1*CORO3*FA5+12.E0*CR111*CR1*CORO
     1 **2*FA4+6.E0*CR111*CR1*CORO*FA3+2.E0*CR111*CR1*FA2+28.E0*CR11**
     1 2*CORO6*FA8+21.E0*CR11**2*CORO5*FA7+15.E0*CR11**2*CORO4
     1 *FA6+10.E0*CR11**2*CORO3*FA5+6.E0*CR11**2*CORO2*FA4+3.E0*
     1 CR11**2*CORO*FA3+CR11**2*FA2+168.E0*CR11*CR1**2*CORO5*FA8
     1 +105.E0*CR11*CR1**2*CORO4*FA7+60.E0*CR11*CR1**2*CORO3*FA6
     1 +30.E0*CR11*CR1**2*CORO2*FA5+12.E0*CR11*CR1**2*CORO*FA4+3.E0*
     1 CR11*CR1**2*FA3+70.E0*CR1**4*CORO4*FA8+35.E0*CR1**4*CORO3
     1 *FA7+15.E0*CR1**4*CORO2*FA6+5.E0*CR1**4*CORO*FA5+CR1**4*FA4
     1 +FA1*CR1111
      Q3333=8.E0*CR3333*CORO7*FA8+7.E0*CR3333*CORO6*FA7+6.E0*
     1 CR3333*CORO5*FA6+5.E0*CR3333*CORO4*FA5+4.E0*CR3333*CORO**
     1 3*FA4+3.E0*CR3333*CORO2*FA3+2.E0*CR3333*CORO*FA2+56.E0*CR333*
     1 CR3*CORO6*FA8+42.E0*CR333*CR3*CORO5*FA7+30.E0*CR333*CR3*
     1 CORO4*FA6+20.E0*CR333*CR3*CORO3*FA5+12.E0*CR333*CR3*CORO
     1 **2*FA4+6.E0*CR333*CR3*CORO*FA3+2.E0*CR333*CR3*FA2+28.E0*CR33**
     1 2*CORO6*FA8+21.E0*CR33**2*CORO5*FA7+15.E0*CR33**2*CORO4
     1 *FA6+10.E0*CR33**2*CORO3*FA5+6.E0*CR33**2*CORO2*FA4+3.E0*
     1 CR33**2*CORO*FA3+CR33**2*FA2+168.E0*CR33*CR3**2*CORO5*FA8
     1 +105.E0*CR33*CR3**2*CORO4*FA7+60.E0*CR33*CR3**2*CORO3*FA6
     1 +30.E0*CR33*CR3**2*CORO2*FA5+12.E0*CR33*CR3**2*CORO*FA4+3.E0*
     1 CR33*CR3**2*FA3+70.E0*CR3**4*CORO4*FA8+35.E0*CR3**4*CORO3
     1 *FA7+15.E0*CR3**4*CORO2*FA6+5.E0*CR3**4*CORO*FA5+CR3**4*FA4
     1 +FA1*CR3333
      ANS1=280.E0*CR3*CR1**3*CORO4*FA8+140.E0*CR3*CR1**3*CORO3*
     1 FA7+60.E0*CR3*CR1**3*CORO2*FA6+20.E0*CR3*CR1**3*CORO*FA5+4.E0
     1 *CR3*CR1**3*FA4
      Q1113=8.E0*CR1113*CORO7*FA8+7.E0*CR1113*CORO6*FA7+6.E0*
     1 CR1113*CORO5*FA6+5.E0*CR1113*CORO4*FA5+4.E0*CR1113*CORO**
     1 3*FA4+3.E0*CR1113*CORO2*FA3+2.E0*CR1113*CORO*FA2+56.E0*CR113*
     1 CR1*CORO6*FA8+42.E0*CR113*CR1*CORO5*FA7+30.E0*CR113*CR1*
     1 CORO4*FA6+20.E0*CR113*CR1*CORO3*FA5+12.E0*CR113*CR1*CORO
     1 **2*FA4+6.E0*CR113*CR1*CORO*FA3+2.E0*CR113*CR1*FA2+56.E0*CR111*
     1 CR3*CORO6*FA8+42.E0*CR111*CR3*CORO5*FA7+30.E0*CR111*CR3*
     1 CORO4*FA6+20.E0*CR111*CR3*CORO3*FA5+12.E0*CR111*CR3*CORO
     1 **2*FA4+6.E0*CR111*CR3*CORO*FA3+2.E0*CR111*CR3*FA2+56.E0*CR13*
     1 CR11*CORO6*FA8+42.E0*CR13*CR11*CORO5*FA7+30.E0*CR13*CR11*
     1 CORO4*FA6+20.E0*CR13*CR11*CORO3*FA5+12.E0*CR13*CR11*CORO
     1 **2*FA4+6.E0*CR13*CR11*CORO*FA3+2.E0*CR13*CR11*FA2+168.E0*CR13*
     1 CR1**2*CORO5*FA8+105.E0*CR13*CR1**2*CORO4*FA7+60.E0*CR13*
     1 CR1**2*CORO3*FA6+30.E0*CR13*CR1**2*CORO2*FA5+12.E0*CR13*
     1 CR1**2*CORO*FA4+3.E0*CR13*CR1**2*FA3+336.E0*CR11*CR3*CR1*CORO
     1 **5*FA8+210.E0*CR11*CR3*CR1*CORO4*FA7+120.E0*CR11*CR3*CR1*
     1 CORO3*FA6+60.E0*CR11*CR3*CR1*CORO2*FA5+24.E0*CR11*CR3*CR1
     1 *CORO*FA4+6.E0*CR11*CR3*CR1*FA3+ANS1+FA1*CR1113
      ANS1=280.E0*CR3**3*CR1*CORO4*FA8+140.E0*CR3**3*CR1*CORO3*
     1 FA7+60.E0*CR3**3*CR1*CORO2*FA6+20.E0*CR3**3*CR1*CORO*FA5+4.E0
     1 *CR3**3*CR1*FA4
      Q1333=8.E0*CR1333*CORO7*FA8+7.E0*CR1333*CORO6*FA7+6.E0*
     1 CR1333*CORO5*FA6+5.E0*CR1333*CORO4*FA5+4.E0*CR1333*CORO**
     1 3*FA4+3.E0*CR1333*CORO2*FA3+2.E0*CR1333*CORO*FA2+56.E0*CR133*
     1 CR3*CORO6*FA8+42.E0*CR133*CR3*CORO5*FA7+30.E0*CR133*CR3*
     1 CORO4*FA6+20.E0*CR133*CR3*CORO3*FA5+12.E0*CR133*CR3*CORO
     1 **2*FA4+6.E0*CR133*CR3*CORO*FA3+2.E0*CR133*CR3*FA2+56.E0*CR333*
     1 CR1*CORO6*FA8+42.E0*CR333*CR1*CORO5*FA7+30.E0*CR333*CR1*
     1 CORO4*FA6+20.E0*CR333*CR1*CORO3*FA5+12.E0*CR333*CR1*CORO
     1 **2*FA4+6.E0*CR333*CR1*CORO*FA3+2.E0*CR333*CR1*FA2+56.E0*CR13*
     1 CR33*CORO6*FA8+42.E0*CR13*CR33*CORO5*FA7+30.E0*CR13*CR33*
     1 CORO4*FA6+20.E0*CR13*CR33*CORO3*FA5+12.E0*CR13*CR33*CORO
     1 **2*FA4+6.E0*CR13*CR33*CORO*FA3+2.E0*CR13*CR33*FA2+168.E0*CR13*
     1 CR3**2*CORO5*FA8+105.E0*CR13*CR3**2*CORO4*FA7+60.E0*CR13*
     1 CR3**2*CORO3*FA6+30.E0*CR13*CR3**2*CORO2*FA5+12.E0*CR13*
     1 CR3**2*CORO*FA4+3.E0*CR13*CR3**2*FA3+336.E0*CR33*CR3*CR1*CORO
     1 **5*FA8+210.E0*CR33*CR3*CR1*CORO4*FA7+120.E0*CR33*CR3*CR1*
     1 CORO3*FA6+60.E0*CR33*CR3*CR1*CORO2*FA5+24.E0*CR33*CR3*CR1
     1 *CORO*FA4+6.E0*CR33*CR3*CR1*FA3+ANS1+FA1*CR1333
      ANS1=168.E0*CR33*CR1**2*CORO5*FA8+105.E0*CR33*CR1**2*CORO4
     1 *FA7+60.E0*CR33*CR1**2*CORO3*FA6+30.E0*CR33*CR1**2*CORO2*
     1 FA5+12.E0*CR33*CR1**2*CORO*FA4+3.E0*CR33*CR1**2*FA3+168.E0*CR11
     1 *CR3**2*CORO5*FA8+105.E0*CR11*CR3**2*CORO4*FA7+60.E0*CR11
     1 *CR3**2*CORO3*FA6+30.E0*CR11*CR3**2*CORO2*FA5+12.E0*CR11*
     1 CR3**2*CORO*FA4+3.E0*CR11*CR3**2*FA3+420.E0*CR3**2*CR1**2*
     1 CORO4*FA8+210.E0*CR3**2*CR1**2*CORO3*FA7+90.E0*CR3**2*CR1
     1 **2*CORO2*FA6+30.E0*CR3**2*CR1**2*CORO*FA5+6.E0*CR3**2*CR1
     1 **2*FA4
      Q1133=8.E0*CR1133*CORO7*FA8+7.E0*CR1133*CORO6*FA7+6.E0*
     1 CR1133*CORO5*FA6+5.E0*CR1133*CORO4*FA5+4.E0*CR1133*CORO**
     1 3*FA4+3.E0*CR1133*CORO2*FA3+2.E0*CR1133*CORO*FA2+56.E0*CR133*
     1 CR1*CORO6*FA8+42.E0*CR133*CR1*CORO5*FA7+30.E0*CR133*CR1*
     1 CORO4*FA6+20.E0*CR133*CR1*CORO3*FA5+12.E0*CR133*CR1*CORO
     1 **2*FA4+6.E0*CR133*CR1*CORO*FA3+2.E0*CR133*CR1*FA2+56.E0*CR113*
     1 CR3*CORO6*FA8+42.E0*CR113*CR3*CORO5*FA7+30.E0*CR113*CR3*
     1 CORO4*FA6+20.E0*CR113*CR3*CORO3*FA5+12.E0*CR113*CR3*CORO2
     1 *FA4+6.E0*CR113*CR3*CORO*FA3+2.E0*CR113*CR3*FA2+28.E0*CR13**
     1 2*CORO6*FA8+21.E0*CR13**2*CORO5*FA7+15.E0*CR13**2*CORO4
     1 *FA6+10.E0*CR13**2*CORO3*FA5+6.E0*CR13**2*CORO2*FA4+3.E0*
     1 CR13**2*CORO*FA3+CR13**2*FA2+336.E0*CR13*CR3*CR1*CORO5*
     1 FA8+210.E0*CR13*CR3*CR1*CORO4*FA7+120.E0*CR13*CR3*CR1*CORO3
     1 *FA6+60.E0*CR13*CR3*CR1*CORO2*FA5+24.E0*CR13*CR3*CR1*
     1 CORO*FA4+6.E0*CR13*CR3*CR1*FA3+56.E0*CR33*CR11*CORO6*FA8+
     1 42.E0*CR33*CR11*CORO5*FA7+30.E0*CR33*CR11*CORO4*FA6+20.E0*
     1 CR33*CR11*CORO3*FA5+12.E0*CR33*CR11*CORO2*FA4+6.E0*CR33*
     1 CR11*CORO*FA3+2.E0*CR33*CR11*FA2+ANS1+FA1*CR1133
      V0COEF(1)=0.0E0
      V0COEF(2)=Q1
      V0COEF(3)=Q3
      V0COEF(4)=Q11
      V0COEF(5)=Q33
      V0COEF(6)=Q13
      V0COEF(7)=Q111
      V0COEF(8)=Q333
      V0COEF(9)=Q113
      V0COEF(10)=Q133
      V0COEF(11)=Q1111
      V0COEF(12)=Q3333
      V0COEF(13)=Q1113
      V0COEF(14)=Q1333
      V0COEF(15)=Q1133
      RETURN
      END
C
C
      SUBROUTINE TRNSRY ( RCOEF , YCOEF )
      IMPLICIT REAL*8 (A-H,O-Z)
C            :
C DATE       : 24.04.1986
C AUTHOR     : PER JENSEN
C UPDATES    :
C LANGUAGE   : FORTRAN
C PURPOSE    : TRANSFORMATION OF A FOURTH ORDER POLYNOMIAL IN THE R
C            : SUB I'S TO A FOURTH ORDER POLYNOMIAL IN THE Y SUB I'S
C            : THE CODE IS GENERATED BY REDUCE.
C            :
C INPUT      : RCOEF(1:15) THE COEFFICIENTS OF A FOURTH ORDER POLYNOMIAL
C            :             IN THE DELTA R I'S.
C            :
C OUTPUT     : YCOEF(1:15) THE COEFFICIENTS OF THE CORRESPONDING
C            :             POLYNOMIAL IN THE Y I'S.
C            :
      REAL*8 M1,M2,M3,M,U1,U3,U13,V,RHO,EPS,
     1      CR,SR,CSE,SNE,
     2      CRE,SRE,CORO,EPSP,EPSPP,EPSPPP
C
      REAL*8 AMASS(3,10)
C
      REAL*8 RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1       AA1,AA3,
     2       F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3       F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4       F13,F1A13,F2A13,F3A13,
     5       F111,F1A111,F2A111,F333,F1A333,F2A333,
     6       F113,F1A113,F2A113,F133,F1A133,F2A133,
     7       F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8       F1333,FA1333,F1133,FA1133,
     8       RE12 , RE32 , RHOREF , VMIN
C
      REAL*8 ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1      PREC
C
      REAL*8 THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1      THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2      VELLGT , PLANCK , AVOGNO , DEGRAD , RADDEG ,
     3      PI
C
      REAL*8   B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      REAL*8   CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
      INTEGER NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5       NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6       NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7       NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6       ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7       IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8       NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER,
     9       ISOMAX , NATTS  , V0TYPE , IVAR(55) , PARMAX ,
     1       NUMPAR , PRTINT
C
      INTEGER V1 ,V2, V3 , V2MXP1, V2P1,
     1       NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2       NSEPP2 , NSEQP1 , MBASIS ,
     3       MDIM , NFSYM0, NFASY0, NFSYMJ, NFASYJ,
     4       KSTYPA(2) , LSTYPA(2) , JMAX , V2MAX , JMAXP1
C
      INTEGER IQUANT(5,10)
C
      LOGICAL SYMM
C
      REAL*8 RMK(2),AAS(2)
      INTEGER NOBAS,MBASP1,LENIW
      REAL*8 RCOEF(15),YCOEF(15)
      REAL*8 FCR0,FCR1,FCR3,FCR11,FCR33,FCR13,
     1      FCR111,FCR333,FCR113,FCR133,
     2      FCR1111,FCR3333,FCR1113,FCR1333,FCR1133,
     3      Q0,Q1,Q3,Q11,Q33,Q13,
     4      Q111,Q333,Q113,Q133,
     5      Q1111,Q3333,Q1113,Q1333,Q1133
      COMMON /ISOTOP/ IQUANT,AMASS
C
      COMMON /VALUES/ RHO,EPS,EPSP,EPSPP,EPSPPP,
     1               CR,SR,CSE,SNE,CRE,SRE,CORO
C
      COMMON /MOLCUL/ RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1               AA1,AA3,
     2               F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3               F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4               F13,F1A13,F2A13,F3A13,
     5               F111,F1A111,F2A111,F333,F1A333,F2A333,
     6               F113,F1A113,F2A113,F133,F1A133,F2A133,
     7               F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8               F1333,FA1333,F1133,FA1133,
     8               RE12 , RE32 , M1 , M2 , M3 , M ,
     9               U1 , U3 , U13 , V ,
     1               SYMM
C
      COMMON /INTEG/  ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1               RHOREF , VMIN , V0TYPE ,
     1               NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2               NSEPP2 , NSEQP1 , KSTYPA , LSTYPA
C
      COMMON /DIMEN/  MBASIS ,  V2MAX  , V2MXP1 ,
     1               JMAX   , JMAXP1 , MDIM   , NFSYM0 , NFASY0 ,
     2               NFSYMJ , NFASYJ
C
      COMMON /LSFIT/  PARMAX , NUMPAR , ISOMAX , IVAR
C
      COMMON /SYS/    THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1                     THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2                     VELLGT , PLANCK , AVOGNO , PI , PREC ,
     4                     NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5                     NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6                     NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7                     NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6                     ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7                     IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8                     NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER ,
     9                       NATTS , PRTINT
C
      COMMON/BCOEFF/
     1      B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      COMMON/CRCOEF/
     1      CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
C
      COMMON/MORSE/RMK,AAS
      COMMON/MODIM/NOBAS,MBASP1,LENIW
      FCR0=RCOEF(1)
      FCR1=RCOEF(2)
      FCR3=RCOEF(3)
      FCR11=RCOEF(4)
      FCR33=RCOEF(5)
      FCR13=RCOEF(6)
      FCR111=RCOEF(7)
      FCR333=RCOEF(8)
      FCR113=RCOEF(9)
      FCR133=RCOEF(10)
      FCR1111=RCOEF(11)
      FCR3333=RCOEF(12)
      FCR1113=RCOEF(13)
      FCR1333=RCOEF(14)
      FCR1133=RCOEF(15)
      Q0=FCR0
      Q1=FCR1/AA1
      Q3=FCR3/AA3
      Q11=(2.E0*FCR11+FCR1*AA1)/(2.E0*AA1**2)
      Q33=(2.E0*FCR33+FCR3*AA3)/(2.E0*AA3**2)
      Q13=FCR13/(AA3*AA1)
      Q111=(3.E0*FCR111+3.E0*FCR11*AA1+FCR1*AA1**2)/(3.E0*AA1**3)
      Q333=(3.E0*FCR333+3.E0*FCR33*AA3+FCR3*AA3**2)/(3.E0*AA3**3)
      Q113=(2.E0*FCR113+FCR13*AA1)/(2.E0*AA3*AA1**2)
      Q133=(2.E0*FCR133+FCR13*AA3)/(2.E0*AA3**2*AA1)
      Q1111=(12.E0*FCR1111+18.E0*FCR111*AA1+11.E0*FCR11*AA1**2+3.E0*FCR1
     1 *AA1**3)/(12.E0*AA1**4)
      Q3333=(12.E0*FCR3333+18.E0*FCR333*AA3+11.E0*FCR33*AA3**2+3.E0*FCR3
     1 *AA3**3)/(12.E0*AA3**4)
      Q1113=(3.E0*FCR1113+3.E0*FCR113*AA1+FCR13*AA1**2)/(3.E0*AA3*AA1
     1 **3)
      Q1333=(3.E0*FCR1333+3.E0*FCR133*AA3+FCR13*AA3**2)/(3.E0*AA3**3*
     1 AA1)
      Q1133=(4.E0*FCR1133+2.E0*FCR133*AA1+2.E0*FCR113*AA3+FCR13*AA3*
     1 AA1)/(4.E0*AA3**2*AA1**2)
      YCOEF(1)=Q0
      YCOEF(2)=Q1
      YCOEF(3)=Q3
      YCOEF(4)=Q11
      YCOEF(5)=Q33
      YCOEF(6)=Q13
      YCOEF(7)=Q111
      YCOEF(8)=Q333
      YCOEF(9)=Q113
      YCOEF(10)=Q133
      YCOEF(11)=Q1111
      YCOEF(12)=Q3333
      YCOEF(13)=Q1113
      YCOEF(14)=Q1333
      YCOEF(15)=Q1133
      RETURN
      END
C
C
      SUBROUTINE TRNSSR ( XS , XR )
      IMPLICIT REAL*8 (A-H,O-Z)
C            :
C DATE       : 28.04.1986
C AUTHOR     : PER JENSEN
C UPDATES    :
C LANGUAGE   : FORTRAN
C PURPOSE    : TRANSFORMATION FROM A SECOND ORDER POLYNOMIAL IN THE
C            : S I'S TO A FOURTH ORDER POLYNOMIAL IN THE DELTA R I'S.E0
C            : THE CODE IS GENERATED BY REDUCE.
C            :
      REAL*8 M1,M2,M3,M,U1,U3,U13,V,RHO,EPS,
     1      CR,SR,CSE,SNE,
     2      CRE,SRE,CORO,EPSP,EPSPP,EPSPPP
C
      REAL*8 AMASS(3,10)
C
      REAL*8 RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1       AA1,AA3,
     2       F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3       F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4       F13,F1A13,F2A13,F3A13,
     5       F111,F1A111,F2A111,F333,F1A333,F2A333,
     6       F113,F1A113,F2A113,F133,F1A133,F2A133,
     7       F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8       F1333,FA1333,F1133,FA1133,
     8       RE12 , RE32 , RHOREF , VMIN
C
      REAL*8 ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1      PREC
C
      REAL*8 THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1      THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2      VELLGT , PLANCK , AVOGNO , DEGRAD , RADDEG ,
     3      PI
C
      REAL*8   B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      REAL*8   CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
      INTEGER NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5       NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6       NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7       NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6       ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7       IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8       NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER,
     9       ISOMAX , NATTS  , V0TYPE , IVAR(55) , PARMAX ,
     1       NUMPAR , PRTINT
C
      INTEGER V1 ,V2, V3 , V2MXP1, V2P1,
     1       NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2       NSEPP2 , NSEQP1 , MBASIS ,
     3       MDIM , NFSYM0, NFASY0, NFSYMJ, NFASYJ,
     4       KSTYPA(2) , LSTYPA(2) , JMAX , V2MAX , JMAXP1
C
      INTEGER IQUANT(5,10)
C
      LOGICAL SYMM
C
      REAL*8 RMK(2),AAS(2)
      INTEGER NOBAS,MBASP1,LENIW
      REAL*8 XS(6),XR(15)
      COMMON /ISOTOP/ IQUANT,AMASS
C
      COMMON /VALUES/ RHO,EPS,EPSP,EPSPP,EPSPPP,
     1               CR,SR,CSE,SNE,CRE,SRE,CORO
C
      COMMON /MOLCUL/ RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1               AA1,AA3,
     2               F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3               F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4               F13,F1A13,F2A13,F3A13,
     5               F111,F1A111,F2A111,F333,F1A333,F2A333,
     6               F113,F1A113,F2A113,F133,F1A133,F2A133,
     7               F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8               F1333,FA1333,F1133,FA1133,
     8               RE12 , RE32 , M1 , M2 , M3 , M ,
     9               U1 , U3 , U13 , V ,
     1               SYMM
C
      COMMON /INTEG/  ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1               RHOREF , VMIN , V0TYPE ,
     1               NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2               NSEPP2 , NSEQP1 , KSTYPA , LSTYPA
C
      COMMON /DIMEN/  MBASIS ,  V2MAX  , V2MXP1 ,
     1               JMAX   , JMAXP1 , MDIM   , NFSYM0 , NFASY0 ,
     2               NFSYMJ , NFASYJ
C
      COMMON /LSFIT/  PARMAX , NUMPAR , ISOMAX , IVAR
C
      COMMON /SYS/    THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1                     THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2                     VELLGT , PLANCK , AVOGNO , PI , PREC ,
     4                     NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5                     NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6                     NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7                     NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6                     ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7                     IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8                     NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER ,
     9                       NATTS , PRTINT
C
      COMMON/BCOEFF/
     1      B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      COMMON/CRCOEF/
     1      CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
C
      COMMON/MORSE/RMK,AAS
      COMMON/MODIM/NOBAS,MBASP1,LENIW
      XR(1) = XS(1)
      XR(2)=B31*XS(3)+B11*XS(2)
      XR(3)=B33*XS(3)+B13*XS(2)
      XR(4)=
     1 B311*XS(3)+B31**2*XS(5)+B31*B11*XS(6)+B111*XS(2)+B11**2*XS(4)
      XR(5)=
     1 B333*XS(3)+B33**2*XS(5)+B33*B13*XS(6)+B133*XS(2)+B13**2*XS(4)
      XR(6)=
     1 B313*XS(3)+2.E0*B33*B31*XS(5)+B33*B11*XS(6)+B31*B13*XS(6)+
     2 B113*XS(2)+2.E0*B13*B11*XS(4)
      XR(7)=
     1 B3111*XS(3)+2.E0*B311*B31*XS(5)+B311*B11*XS(6)+B31*B111*
     2 XS(6)+B1111*XS(2)+2.E0*B111*B11*XS(4)
      XR(8)=
     1 B3333*XS(3)+2.E0*B333*B33*XS(5)+B333*B13*XS(6)+B33*B133*
     2 XS(6)+B1333*XS(2)+2.E0*B133*B13*XS(4)
      XR(9)=
     1 B3113*XS(3)+2.E0*B313*B31*XS(5)+B313*B11*XS(6)+2.E0*B311*B33*
     2 XS(5)+B311*B13*XS(6)+B33*B111*XS(6)+B31*B113*XS(6)+B1113*XS(2)+
     3 2.E0*B113*B11*XS(4)+2.E0*B111*B13*XS(4)
      XR(10)=
     1 B3133*XS(3)+2.E0*B313*B33*XS(5)+B313*B13*XS(6)+2.E0*B333*B31*
     2 XS(5)+B333*B11*XS(6)+B33*B113*XS(6)+B31*B133*XS(6)+B1133*XS(2)+
     3 2.E0*B113*B13*XS(4)+2.E0*B133*B11*XS(4)
      XR(11)=
     1 B31111*XS(3)+2.E0*B3111*B31*XS(5)+B3111*B11*XS(6)+B311**2*
     2 XS(5)+B311*B111*XS(6)+B31*B1111*XS(6)+B11111*XS(2)+2.E0*B1111*
     3 B11*XS(4)+B111**2*XS(4)
      XR(12)=
     1 2.E0*B3333*B33*XS(5)+B3333*B13*XS(6)+B333**2*XS(5)+B333*
     2 B133*XS(6)+B33*B1333*XS(6)+B13333*XS(2)+2.E0*B1333*B13*XS(4)+
     3 B133**2*XS(4)+XS(3)*B33333
      XR(13)=
     1 2.E0*B3113*B31*XS(5)+B3113*B11*XS(6)+2.E0*B3111*B33*XS(5)+
     2 B3111*B13*XS(6)+2.E0*B313*B311*XS(5)+B313*B111*XS(6)+B311*B113
     3 *XS(6)+B33*B1111*XS(6)+B31*B1113*XS(6)+B11113*XS(2)+2.E0*B1113*
     4 B11*XS(4)+2.E0*B1111*B13*XS(4)+2.E0*B113*B111*XS(4)+XS(3)*B31113
      XR(14)=
     1 2.E0*B3133*B33*XS(5)+B3133*B13*XS(6)+2.E0*B3333*B31*XS(5)+
     2 B3333*B11*XS(6)+2.E0*B313*B333*XS(5)+B313*B133*XS(6)+B333*B113
     3 *XS(6)+B33*B1133*XS(6)+B31*B1333*XS(6)+B11333*XS(2)+2.E0*B1133*
     4 B13*XS(4)+2.E0*B1333*B11*XS(4)+2.E0*B113*B133*XS(4)+XS(3)*B31333
      XR(15)=
     1 2.E0*B3133*B31*XS(5)+B3133*B11*XS(6)+2.E0*B3113*B33*XS(5)+
     2 B3113*B13*XS(6)+B313**2*XS(5)+B313*B113*XS(6)+2.E0*B333*B311*
     3 XS(5)+B333*B111*XS(6)+B311*B133*XS(6)+B33*B1113*XS(6)+B31*
     4 B1133*XS(6)+B11133*XS(2)+2.E0*B1133*B11*XS(4)+2.E0*B1113
     5 *B13*XS(4)+B113**2*XS(4)+2.E0*B133*B111*XS(4)
     6 +XS(3)*B31133
      RETURN
      END
C
C
      SUBROUTINE NUMFCT ( F1 , F2 , V0 , IRR , GRHO )
      IMPLICIT REAL*8 (A-H,O-Z)
C             :
C DATE        : 26.05.1986
C AUTHOR      : PER JENSEN (WITH HELP FROM R. BEARDSWORTH)
C UPDATES     :
C LANGUAGE    : FORTRAN
C             :
C
C     SUBROUTINE CALCULATES THE VALUES OF GRHO(RHO) ,F1(RHO) , F2(RHO) ,
C     AND 2 I0PP(RHO) / HBAR**2
C
C                        (-               (-             -) -)
C               (  0)1/4 (      (  0)-1/2 (      (  0)1/4 )  )
C     GRHO(P) = (MU )    ( J  , (MU )     ( J  , (MU )    )  )
C                        (  P             (  P            )  )
C                        (-               (-             -) -)
C
C             (  0)1/4 ( 0 )1/2    2  ( (  0)-1/4 ( 0 )-1/2 )
C     F (P) = (MU )    (I  )      D   ( (MU )     (I  )     )
C      1                 PP       --  (             PP      )
C                                    2
C                                 DP
C
C
C              0    0
C     F (P) = I   MU
C      2       PP   ZZ
C
C
C             0        _2      16
C     I0 = 2 I   H C / H  N  10
C             PP           A
C
C
      REAL*8 M1,M2,M3,M,U1,U3,U13,V,RHO,EPS,
     1      CR,SR,CSE,SNE,
     2      CRE,SRE,CORO,EPSP,EPSPP,EPSPPP
C
      REAL*8 AMASS(3,10)
C
      REAL*8 RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1       AA1,AA3,
     2       F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3       F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4       F13,F1A13,F2A13,F3A13,
     5       F111,F1A111,F2A111,F333,F1A333,F2A333,
     6       F113,F1A113,F2A113,F133,F1A133,F2A133,
     7       F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8       F1333,FA1333,F1133,FA1133,
     8       RE12 , RE32 , RHOREF , VMIN
C
      REAL*8 ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1      PREC
C
      REAL*8 THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1      THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2      VELLGT , PLANCK , AVOGNO , DEGRAD , RADDEG ,
     3      PI
C
      REAL*8   B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      REAL*8   CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
      INTEGER NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5       NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6       NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7       NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6       ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7       IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8       NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER,
     9       ISOMAX , NATTS  , V0TYPE , IVAR(55) , PARMAX ,
     1       NUMPAR , PRTINT
C
      INTEGER V1 ,V2, V3 , V2MXP1, V2P1,
     1       NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2       NSEPP2 , NSEQP1 , MBASIS ,
     3       MDIM , NFSYM0, NFASY0, NFSYMJ, NFASYJ,
     4       KSTYPA(2) , LSTYPA(2) , JMAX , V2MAX , JMAXP1
C
      INTEGER IQUANT(5,10)
C
      LOGICAL SYMM
C
      REAL*8 RMK(2),AAS(2)
      INTEGER NOBAS,MBASP1,LENIW
      REAL*8 I0,I0P,I0PP,IRRVAL,IRRP,IRRPP
      REAL*8 CE,SE,C2R,S2R,CRME,SRME,ECOEF1,ECOEF2,
     1      F1VAL,F2VAL,GVAL,V0VAL,F2COEF,CRHOE ,
     2      HELP1 , HELP3
      REAL*8 F1(NSTINT),F2(NSTINT),V0(NSTINT),IRR(NSTINT),
     1      GRHO(NSTINT)
      INTEGER I
      COMMON /ISOTOP/ IQUANT,AMASS
C
      COMMON /VALUES/ RHO,EPS,EPSP,EPSPP,EPSPPP,
     1               CR,SR,CSE,SNE,CRE,SRE,CORO
C
      COMMON /MOLCUL/ RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1               AA1,AA3,
     2               F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3               F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4               F13,F1A13,F2A13,F3A13,
     5               F111,F1A111,F2A111,F333,F1A333,F2A333,
     6               F113,F1A113,F2A113,F133,F1A133,F2A133,
     7               F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8               F1333,FA1333,F1133,FA1133,
     8               RE12 , RE32 , M1 , M2 , M3 , M ,
     9               U1 , U3 , U13 , V ,
     1               SYMM
C
      COMMON /INTEG/  ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1               RHOREF , VMIN , V0TYPE ,
     1               NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2               NSEPP2 , NSEQP1 , KSTYPA , LSTYPA
C
      COMMON /DIMEN/  MBASIS ,  V2MAX  , V2MXP1 ,
     1               JMAX   , JMAXP1 , MDIM   , NFSYM0 , NFASY0 ,
     2               NFSYMJ , NFASYJ
C
      COMMON /LSFIT/  PARMAX , NUMPAR , ISOMAX , IVAR
C
      COMMON /SYS/    THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1                     THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2                     VELLGT , PLANCK , AVOGNO , PI , PREC ,
     4                     NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5                     NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6                     NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7                     NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6                     ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7                     IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8                     NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER ,
     9                       NATTS , PRTINT
C
      COMMON/BCOEFF/
     1      B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      COMMON/CRCOEF/
     1      CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
C
      COMMON/MORSE/RMK,AAS
      COMMON/MODIM/NOBAS,MBASP1,LENIW
      IF (IPRINT .NE. 0) WRITE (NFIL6,9000)
      IF (PRTINT .LT. NSTINT .AND. IPRINT .NE. 0)
     1                        WRITE (NFIL6,9001)
      ECOEF1=(U1-U3)/SQRT((U1+U3)**2-4.0E0*U13**2)
      ECOEF2=SQRT((U1+U3-2.0E0*U13)/(U1+U3+2.0E0*U13))
      F2COEF=1.0E0/(U1*U3-U13**2)
      CRHOE=COS(RHOREF)
      DO 1000 I=1,NSTINT
      RHO=FLOAT(I)*HSTEP
      EPS=0.5D0*RHO+ECOEF1*ATAN(ECOEF2*TAN(0.5D0*RHO))
      CR=COS(RHO)
      SR=SIN(RHO)
      CE=COS(EPS)
      SE=SIN(EPS)
      C2R=CR*CR-SR*SR
      S2R=2.0E0*CR*SR
      CRME=CR*CE+SR*SE
C
C       CALCULATE DERIVATIVES OF EPSILON, I SUB RHO RHO AND THE
C       DETERMINANT OF THE I SUB 0 TENSOR, I0. EXPRESSIONS FOR
C       EPSILON PRIME AND I SUB RHO RHO ARE TAKEN FROM THE JENSEN
C       COMP. PHYS. REP. PAPER, THE EXPRESSION FOR I0 IS TAKEN
C       FROM HISTORICAL NRB NOTES BY P.R. BUNKER.
C
      I0=(U1*U3-U13*U13*CR*CR)*SR*SR
      I0P=(U1*U3-U13*U13*C2R)*S2R
      I0PP=2.0E0*U13*U13*S2R*S2R+2.0E0*(U1*U3-U13*U13*C2R)*C2R
      IRRVAL=(U1*U3-U13*U13*CR*CR)/(U1+U3+2.0D+00*U13*CR)
      HELP1=U1+U13*CR
      HELP3=U3+U13*CR
      IRRP=2.0D+00*U13*SR*HELP1*HELP3/(HELP1+HELP3)**2
      IRRPP=2.0E0*U13*(HELP1*HELP3*CR*(HELP1+HELP3)
     1    -U13*SR*SR*(HELP1-HELP3)**2)/(HELP1+HELP3)**3
C
C       CALCULATE F1
C
      F1VAL= - IRRP*I0P/(4.0E0*I0*IRRVAL) - 3.0E0*I0P*I0P/(1.6E1*I0*I0)
     1      + I0PP/(4.0D+00*I0) +3.0E0*IRRP*IRRP/(4.0E0*IRRVAL*IRRVAL)
     2      - IRRPP/(2.0E0*IRRVAL)
C
C       CALCULATE F2
C
      F2VAL= (U1*CRME*CRME+U3*CE*CE+2.0E0*U13*CE*CRME)*IRRVAL
     1      *F2COEF/(SR*SR)
C
C       CALCULATE THE V0 VALUE
C
      CORO=CRHOE-CR
      V0VAL =  (((((((FA8*CORO+FA7)*CORO+FA6)*CORO+FA5)*CORO
     1        +FA4)*CORO+FA3)*CORO+FA2)*CORO+FA1)*CORO-VMIN
C
C       CALCULATE THE G FUNCTION
C
      GVAL =  I0PP/(4.0E0*I0) - 3.0E0*I0P*I0P/(1.6E1*I0*I0)
C
      F1(I)=F1VAL
      F2(I)=F2VAL
      V0(I)=V0VAL
      IRR(I)=IRRVAL/M
      GRHO(I)=GVAL
1000  CONTINUE
      IF (IPRINT .EQ. 0) RETURN
      RHO=0.0D+00
      DO 2000 I=1,NSTINT
      RHO=RHO+HSTEP
      IF (MOD(I,PRTINT) .EQ. 0)
     1  WRITE (NFIL6,9002) I , RHO , F1(I) , F2(I), IRR(I) , V0(I)
2000  CONTINUE
      RETURN
9000  FORMAT(1H0,' MORBID.POT.INF   CALCULATION OF F1 , F2 , I0PP ',
     1           'AND V0 FOR WAVE FUNCTION DIFFERENTIAL EQUATION',//)
9001  FORMAT(1H ,15X,'STEP    RHO',6X,'F  (RHO)',8X,'F  (RHO)',10X,'I0',
     1           17X,'V',/,1H ,33X,'1',15X,'2',18X,'PP',16X,'0  ',/)
9002  FORMAT(1H ,15X,I4,2X,F7.4,3F16.8,F18.8)
C
      END

C
C
      SUBROUTINE WAVFUN ( EV2K , F1 , F2 , V0 , I0 , GRHO , RTI0 ,
     1                   PHIB , PHPR , XJACO , YRHS , XTX , XTY ,
     2                   CS , AS   , IA1   , IA2  ,
     3                   LENIAR )
      IMPLICIT REAL*8 (A-H,O-Z)
      REAL*8 M1,M2,M3,M,U1,U3,U13,V,RHO,EPS,
     1      CR,SR,CSE,SNE,
     2      CRE,SRE,CORO,EPSP,EPSPP,EPSPPP
C
      REAL*8 AMASS(3,10)
C
      REAL*8 RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1       AA1,AA3,
     2       F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3       F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4       F13,F1A13,F2A13,F3A13,
     5       F111,F1A111,F2A111,F333,F1A333,F2A333,
     6       F113,F1A113,F2A113,F133,F1A133,F2A133,
     7       F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8       F1333,FA1333,F1133,FA1133,
     8       RE12 , RE32 , RHOREF , VMIN
C
      REAL*8 ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1      PREC
C
      REAL*8 THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1      THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2      VELLGT , PLANCK , AVOGNO , DEGRAD , RADDEG ,
     3      PI
C
      REAL*8   B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      REAL*8   CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
      INTEGER NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5       NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6       NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7       NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6       ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7       IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8       NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER,
     9       ISOMAX , NATTS  , V0TYPE , IVAR(55) , PARMAX ,
     1       NUMPAR , PRTINT
C
      INTEGER V1 ,V2, V3 , V2MXP1, V2P1,
     1       NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2       NSEPP2 , NSEQP1 , MBASIS ,
     3       MDIM , NFSYM0, NFASY0, NFSYMJ, NFASYJ,
     4       KSTYPA(2) , LSTYPA(2) , JMAX , V2MAX , JMAXP1
C
      INTEGER IQUANT(5,10)
C
      LOGICAL SYMM
C
      REAL*8 RMK(2),AAS(2)
      INTEGER NOBAS,MBASP1,LENIW
C
      INTEGER LENREC,LENIAR,I,L,IERR,NUMNOD,NTRIES,NP,II,NPST,
     1       IFAIL,IPHST,IDEST,IEND,NRECS,KREC,KP1,NM1,
     2       NOFCT,IREMAI,IOFFS
C
      REAL*8 CONVIV,FACODD,FACEVE,EOLD,PCOUT,PCIN,OLDPHI,
     1      SUM,ALPHA,SUMM,SUMP,TRIALE,IRRVAL,IRRP,
     2      PHIDER,FCTVAL,HELP1,HELP3
C
      REAL*8 EV2K(V2MXP1,JMAXP1) , F1(NSTINT) , F2(NSTINT) ,
C
     1      V0(NSTINT) , I0(NSTINT) , GRHO(NSTINT) , RTI0(NSTINT) ,
C
     2      PHIB(NSTINT) , PHPR(NSTINT) , XJACO(NSERIN,NSEPP2) ,
C
     3      YRHS(NSERIN) , XTX(NSEPP2,NSEPP2) , XTY(NSEPP2) ,
C
     4      CS(NSEPP2) , AS(NSEQP1) ,
C
     4      DER(4) , EREST(4)
C
      INTEGER IA1(LENIAR),IA2(LENIAR)
C
C BEFORE COMMENCING THE NUMEROV-COOLEY NUMERICAL INTEGRATION WE
C STORE THE FOLLOWING FUNCTION IN THE F1 ARRAY:
C
C                       0                 _2
C     W  = F  (P ) + 2 I   (P ) V  (P ) / H
C      I    1   I       PP   I   0   I
C
C                  -1                           2
C V  IS GIVEN IN CM  , AND I   IS GIVEN IN AMU A .
C  0                        PP
C
C THE CONVERSION FACTOR CONVIV CONVERTS UNITS SO THAT WI IS A
C DIMENSIONLESS NUMBER.
C
      COMMON /ISOTOP/ IQUANT,AMASS
C
      COMMON /VALUES/ RHO,EPS,EPSP,EPSPP,EPSPPP,
     1               CR,SR,CSE,SNE,CRE,SRE,CORO
C
      COMMON /MOLCUL/ RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1               AA1,AA3,
     2               F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3               F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4               F13,F1A13,F2A13,F3A13,
     5               F111,F1A111,F2A111,F333,F1A333,F2A333,
     6               F113,F1A113,F2A113,F133,F1A133,F2A133,
     7               F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8               F1333,FA1333,F1133,FA1133,
     8               RE12 , RE32 , M1 , M2 , M3 , M ,
     9               U1 , U3 , U13 , V ,
     1               SYMM
C
      COMMON /INTEG/  ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1               RHOREF , VMIN , V0TYPE ,
     1               NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2               NSEPP2 , NSEQP1 , KSTYPA , LSTYPA
C
      COMMON /DIMEN/  MBASIS ,  V2MAX  , V2MXP1 ,
     1               JMAX   , JMAXP1 , MDIM   , NFSYM0 , NFASY0 ,
     2               NFSYMJ , NFASYJ
C
      COMMON /LSFIT/  PARMAX , NUMPAR , ISOMAX , IVAR
C
      COMMON /SYS/    THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1                     THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2                     VELLGT , PLANCK , AVOGNO , PI , PREC ,
     4                     NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5                     NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6                     NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7                     NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6                     ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7                     IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8                     NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER ,
     9                       NATTS , PRTINT
C
      COMMON/BCOEFF/
     1      B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      COMMON/CRCOEF/
     1      CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
C
      COMMON/MORSE/RMK,AAS
      COMMON/MODIM/NOBAS,MBASP1,LENIW
      IEND=2*NSTINT
      CONVIV=(8.0D+00*PI*PI*VELLGT)/(PLANCK*AVOGNO*1.0D+16)
      DO 100 I=1,NSTINT
100   RTI0(I)=SQRT(I0(I))
      DO 200 I=1,NSTINT
      F1(I)=F1(I)+CONVIV*I0(I)*V0(I)
200   I0(I)=CONVIV*I0(I)
C
C START LOOP OVER K TO CALCULATE WAVEFUNCTIONS
C
      DO 1002 KP1=1,JMAXP1
C
C WE NOW START THE LOOP OVER V2 TO GENERATE THE K=0 BENDING
C WAVEFUNCTIONS
C
      KQUA=KP1-1
      FACODD=2.0D+00*HSTEP/3.0D+00
      FACEVE=2.0D+00*FACODD
      DO 1000 V2P1=1,V2MXP1
      V2=V2P1-1
      EGUESS=TRIALE(KP1,V2P1,EV2K)
      EOLD=EGUESS
210   CALL NUMCOO ( F1 , F2 , V0 , I0 , GRHO , PHIB ,
     1             PHPR , XJACO , YRHS , XTX , XTY , CS ,
     2             AS , IA1 , IA2 ,
     3             LENIAR , PCOUT, IERR)
      IF (IERR .NE. 0) STOP
C
C COUNT THE NUMBER OF NODES IN THE WAVEFUNCTION FOUND
C
      NUMNOD=0
      NM1=NSTINT-1
      OLDPHI=PHIB(1)
      DO 230 I=2,NM1
      IF (OLDPHI*PHIB(I) .GT. 0.0D+00) GOTO 220
      IF (OLDPHI .EQ. 0.0D+00) GOTO 220
      NUMNOD=NUMNOD+1
220   OLDPHI=PHIB(I)
230   CONTINUE
      IF (NUMNOD .EQ. V2) GOTO 240
      WRITE (NFIL6,5000) KQUA,V2,NUMNOD,EGUESS,EOLD
      EGUESS=EGUESS+FLOAT(V2-NUMNOD)*ETRIAL
      EOLD=EGUESS
      NTRIES=NTRIES+1
      IF (NTRIES .GE. NSTNIN) GOTO 9000
      GOTO 210
240   EV2K(V2P1,KQUA+1)=EGUESS
C
C MULTIPLY THE WAVEFUNCTION WITH SQRT(IRR) (EQ. (6.4) OF JENSEN)
C
      DO 300 I=1,NSTINT
300   PHIB(I)=RTI0(I)*PHIB(I)
C
C NORMALIZE THE WAVEFUNCTION
C
      SUM=0.0E0
      DO 400 I=1,NSTINT,2
400   SUM=SUM+FACODD*PHIB(I)*PHIB(I)+FACEVE*PHIB(I+1)*PHIB(I+1)
      SUM=SQRT(SUM)
      DO 500 I=1,NSTINT
500   PHIB(I)=PHIB(I)/SUM
C
C WE DIFFERENTIATE THE FIRST NSERIN POINTS OF THE WAVEFUNCTION
C ANALYTICALLY
C
      RHO=0.0D+00
      ALPHA=FLOAT(KQUA)+0.5D+00
      DO 700 NP=1,NSERIN
      RHO=RHO+HSTEP
      CR=COS(RHO)
      SR=SIN(RHO)
      IRRVAL=(U1*U3-U13*U13*CR*CR)/(U1+U3+2.0D+00*U13*CR)
      HELP1=U1+U13*CR
      HELP3=U3+U13*CR
      IRRP=2.0D+00*U13*SR*HELP1*HELP3/(HELP1+HELP3)**2
      SUMM=AS(1)
      SUMP=0.0D+00
      DO 600 II=2,NSEQP1
      I=II-1
      SUMM=SUMM+AS(II)*RHO**(I+I)
600   SUMP=SUMP+FLOAT(I+I)*AS(II)*RHO**(I+I-1)
      PHIDER=(SUMM*ALPHA/RHO+SUMP)*RHO**ALPHA
      FCTVAL=SUMM*RHO**ALPHA
700   PHPR(NP)=RTI0(NP)*(PHIDER+0.5D+00*FCTVAL*IRRP/IRRVAL)
     1                                  /(SUM*PCOUT)
C
C THE REST OF THE WAY WE USE THE NAGLIB ROUTINE D04AAF
C
      NPST=NSERIN+1
      HBASE=1.0D+00
      DO 800 NP=NPST,NSTINT
      CALL D04AAF( NP , 1 , DER , EREST , PHIB , IFAIL )
      IF (IFAIL .NE. 0 .OR. ABS(DER(1)) .GT. THRSH4) GOTO 9010
      PHPR(NP)=DER(1)/HSTEP
800   CONTINUE
C
      KREC=KQUA*V2MXP1+V2P1
C
      WRITE (NFIL7,REC=KREC) (PHIB(I),I=1,NSTINT),
     1                       (PHPR(I),I=1,NSTINT)
1000  CONTINUE
1002  CONTINUE
C
      IF (IPRINT.EQ.0) RETURN
      WRITE (NFIL6,5010)
C
      DO 1200 V2P1=1,V2MXP1
      V2=V2P1-1
      WRITE (NFIL6,5020) V2,EV2K(V2P1,1)
1200  CONTINUE
      WRITE (NFIL6,5030)
C
      RETURN
C
9000  WRITE (NFIL6,9001) NSTNIN
9001  FORMAT(1H0,' MORBID.NMI.ERR  MAXIMUM NUMBER OF ATTEMPTS (',
     1      I3,') ATTAINED IN THE NUMEROV-COOLEY INTEGRATION')
      STOP
9010  CONTINUE
      IF (IFAIL .EQ. 0) GOTO 9020
      WRITE (NFIL6,9011) IFAIL
9011  FORMAT(1H0,' MORBID.NMI.ERR   DIFFERENTIAL OF WAVE FUNCTIONS',
     1          ' YIELDS IFAIL =',I2/
     2      1H ,'                  (SUBROUTINE WAVFUN)'/)
      STOP
9020  WRITE (NFIL6,9021) DER(1),THRSH4,NP
9021  FORMAT(1H0,' MORBID.NMI.ERR   ABSOLUTE ERROR ESTIMATE FOR THE ',
     1                          'FIRST DERIVATIVE OF THE WAVEFUNCTION'/
     2      1H ,'                  (',D11.3,') IS GREATER THAN THE ',
     3                             'LIMIT (',D11.3,')'/
     4      1H ,'                  IN STEP ',I4,' (SUBROUTINE WAVFUN)'/)
      STOP
C
5000  FORMAT(1H0,' MORBID.NMI.WRN  FOR KQUA = ',I2,', V2 = ',I3,
     1      ' DOES NOT EQUAL NUMBER OF NODES = ',I3/
     2      1H ,' EGUESS = ',F10.3,', ETRIAL = ',F10.3)
5010  FORMAT('1',5X,12('*'),' ENERGIES FROM THE K=0 NUMEROV',
     1      '-COOLEY INTEGRATION (CM-1) ',12('*')//
     2      ' ',17X,30('-')/' ',17X,'I',9X,'I',18X,'I'/
     3      ' ',17X,'I',4X,'V2',3X,'I',8X,'E ',8X,'I'/
     4     ' ',17X,'I',9X,'I',18X,'I'/' ',17X,30('-'))
5020  FORMAT(' ',17X,'I',3X,I3,3X,'I',3X,F12.5,3X,'I')
5030  FORMAT(' ',17X,30('-')//)
C
      END
C
C
      DOUBLE PRECISION FUNCTION TRIALE(K,J,ENERGY)
      IMPLICIT REAL*8 (A-H,O-Z)
      REAL*8 M1,M2,M3,M,U1,U3,U13,V,RHO,EPS,
     1      CR,SR,CSE,SNE,
     2      CRE,SRE,CORO,EPSP,EPSPP,EPSPPP
C
      REAL*8 AMASS(3,10)
C
      REAL*8 RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1       AA1,AA3,
     2       F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3       F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4       F13,F1A13,F2A13,F3A13,
     5       F111,F1A111,F2A111,F333,F1A333,F2A333,
     6       F113,F1A113,F2A113,F133,F1A133,F2A133,
     7       F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8       F1333,FA1333,F1133,FA1133,
     8       RE12 , RE32 , RHOREF , VMIN
C
      REAL*8 ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1      PREC
C
      REAL*8 THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1      THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2      VELLGT , PLANCK , AVOGNO , DEGRAD , RADDEG ,
     3      PI
C
      REAL*8   B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      REAL*8   CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
      INTEGER NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5       NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6       NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7       NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6       ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7       IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8       NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER,
     9       ISOMAX , NATTS  , V0TYPE , IVAR(55) , PARMAX ,
     1       NUMPAR , PRTINT
C
      INTEGER V1 ,V2, V3 , V2MXP1, V2P1,
     1       NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2       NSEPP2 , NSEQP1 , MBASIS ,
     3       MDIM , NFSYM0, NFASY0, NFSYMJ, NFASYJ,
     4       KSTYPA(2) , LSTYPA(2) , JMAX , V2MAX , JMAXP1
C
      INTEGER IQUANT(5,10)
C
      LOGICAL SYMM
C
      REAL*8 RMK(2),AAS(2)
      INTEGER NOBAS,MBASP1,LENIW
C
C     FUNCTION GUESSES A NEW STARTING VALUE FOR EGUESS FOR USE IN THE
C     NUMEROV - COOLEY INTEGRATION PROCEDURE.
C     HOW IT WORKS I DON'T KNOW.  IT IS TAKEN FROM SYMMETRIC NRB
C     OF AITKEN HOY.
C
      REAL*8 ENERGY(V2MXP1,JMAXP1)
      INTEGER K,J
      COMMON /ISOTOP/ IQUANT,AMASS
C
      COMMON /VALUES/ RHO,EPS,EPSP,EPSPP,EPSPPP,
     1               CR,SR,CSE,SNE,CRE,SRE,CORO
C
      COMMON /MOLCUL/ RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1               AA1,AA3,
     2               F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3               F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4               F13,F1A13,F2A13,F3A13,
     5               F111,F1A111,F2A111,F333,F1A333,F2A333,
     6               F113,F1A113,F2A113,F133,F1A133,F2A133,
     7               F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8               F1333,FA1333,F1133,FA1133,
     8               RE12 , RE32 , M1 , M2 , M3 , M ,
     9               U1 , U3 , U13 , V ,
     1               SYMM
C
      COMMON /INTEG/  ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1               RHOREF , VMIN , V0TYPE ,
     1               NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2               NSEPP2 , NSEQP1 , KSTYPA , LSTYPA
C
      COMMON /DIMEN/  MBASIS ,  V2MAX  , V2MXP1 ,
     1               JMAX   , JMAXP1 , MDIM   , NFSYM0 , NFASY0 ,
     2               NFSYMJ , NFASYJ
C
      COMMON /LSFIT/  PARMAX , NUMPAR , ISOMAX , IVAR
C
      COMMON /SYS/    THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1                     THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2                     VELLGT , PLANCK , AVOGNO , PI , PREC ,
     4                     NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5                     NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6                     NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7                     NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6                     ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7                     IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8                     NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER ,
     9                       NATTS , PRTINT
C
      COMMON/BCOEFF/
     1      B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      COMMON/CRCOEF/
     1      CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
C
      COMMON/MORSE/RMK,AAS
      COMMON/MODIM/NOBAS,MBASP1,LENIW
C
      IF (K.GE.2) GO TO 4
C
      IF (J-2) 11 , 2 , 3
C
2     TRIALE=3.0D+00*ENERGY(1,1)
      RETURN
C
3     TRIALE=ENERGY(J-1,K)*2.0D+00-ENERGY(J-2,K)
      RETURN
C
4     IF (J-2) 5 , 10 , 3
C
5     IF (RHOE.GE.0.5D+00) GO TO 7
6     IF (K.GT.2) GO TO 61
      TRIALE=ENERGY(1,K-1)+ENERGY(1,1)
C
      RETURN
C
61    TRIALE=ENERGY(1,K-1)*2.0D+00-ENERGY(1,K-2)
      RETURN
C
7     IF (K.LT.3) GO TO 9
8     TRIALE=ENERGY(1,K-1)*2.0D+00-ENERGY(1,K-2)
      RETURN
C
9     TRIALE=ENERGY(1,K-1)
      RETURN
C
10    TRIALE=ENERGY(1,K)+ENERGY(2,K-1)-ENERGY(1,K-1)
      RETURN
C
11    TRIALE=ETRIAL
      RETURN
C
      END
C
C
      SUBROUTINE NUMCOO ( F1 , F2 , V0 , I0 , GRHO , PHIB ,
     1                   PHPR , XJACO , YRHS , XTX , XTY , CS ,
     2                   AS , IA1 , IA2 ,
     3                   LENIAR , PCOUT, IERR)
      IMPLICIT REAL*8 (A-H,O-Z)
      REAL*8 M1,M2,M3,M,U1,U3,U13,V,RHO,EPS,
     1      CR,SR,CSE,SNE,
     2      CRE,SRE,CORO,EPSP,EPSPP,EPSPPP
C
      REAL*8 AMASS(3,10)
C
      REAL*8 RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1       AA1,AA3,
     2       F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3       F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4       F13,F1A13,F2A13,F3A13,
     5       F111,F1A111,F2A111,F333,F1A333,F2A333,
     6       F113,F1A113,F2A113,F133,F1A133,F2A133,
     7       F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8       F1333,FA1333,F1133,FA1133,
     8       RE12 , RE32 , RHOREF , VMIN
C
      REAL*8 ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1      PREC
C
      REAL*8 THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1      THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2      VELLGT , PLANCK , AVOGNO , DEGRAD , RADDEG ,
     3      PI
C
      REAL*8   B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      REAL*8   CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
      INTEGER NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5       NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6       NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7       NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6       ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7       IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8       NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER,
     9       ISOMAX , NATTS  , V0TYPE , IVAR(55) , PARMAX ,
     1       NUMPAR , PRTINT
C
      INTEGER V1 ,V2, V3 , V2MXP1, V2P1,
     1       NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2       NSEPP2 , NSEQP1 , MBASIS ,
     3       MDIM , NFSYM0, NFASY0, NFSYMJ, NFASYJ,
     4       KSTYPA(2) , LSTYPA(2) , JMAX , V2MAX , JMAXP1
C
      INTEGER IQUANT(5,10)
C
      LOGICAL SYMM
C
      REAL*8 RMK(2),AAS(2)
      INTEGER NOBAS,MBASP1,LENIW
      INTEGER LENIAR,KK,I,IC,IERR,NITER,NP1,NM1
      REAL*8 U,Y,HH,SUM,SUMOUT,SUMIN,PCOUT,PCIN,DE,YC,YCM1,YCP1
C
      REAL*8 F1(NSTINT) , F2(NSTINT) , V0(NSTINT) ,
C
     1      I0(NSTINT) , GRHO(NSTINT) , PHIB(NSTINT) , PHPR(NSTINT) ,
C
     2      XJACO(NSERIN,NSEPP2) , YRHS(NSERIN) , XTX(NSEPP2,NSEPP2) ,
C
     3      XTY(NSEPP2) , CS(NSEPP2) , AS(NSEQP1)
C
      INTEGER IA1(LENIAR),IA2(LENIAR)
      COMMON /ISOTOP/ IQUANT,AMASS
C
      COMMON /VALUES/ RHO,EPS,EPSP,EPSPP,EPSPPP,
     1               CR,SR,CSE,SNE,CRE,SRE,CORO
C
      COMMON /MOLCUL/ RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1               AA1,AA3,
     2               F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3               F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4               F13,F1A13,F2A13,F3A13,
     5               F111,F1A111,F2A111,F333,F1A333,F2A333,
     6               F113,F1A113,F2A113,F133,F1A133,F2A133,
     7               F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8               F1333,FA1333,F1133,FA1133,
     8               RE12 , RE32 , M1 , M2 , M3 , M ,
     9               U1 , U3 , U13 , V ,
     1               SYMM
C
      COMMON /INTEG/  ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1               RHOREF , VMIN , V0TYPE ,
     1               NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2               NSEPP2 , NSEQP1 , KSTYPA , LSTYPA
C
      COMMON /DIMEN/  MBASIS ,  V2MAX  , V2MXP1 ,
     1               JMAX   , JMAXP1 , MDIM   , NFSYM0 , NFASY0 ,
     2               NFSYMJ , NFASYJ
C
      COMMON /LSFIT/  PARMAX , NUMPAR , ISOMAX , IVAR
C
      COMMON /SYS/    THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1                     THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2                     VELLGT , PLANCK , AVOGNO , PI , PREC ,
     4                     NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5                     NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6                     NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7                     NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6                     ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7                     IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8                     NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER ,
     9                       NATTS , PRTINT
C
      COMMON/BCOEFF/
     1      B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      COMMON/CRCOEF/
     1      CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
C
      COMMON/MORSE/RMK,AAS
      COMMON/MODIM/NOBAS,MBASP1,LENIW
C
C     SUBROUTINE SOLVES EQN 6.5 , FOR THE GIVEN VALUE OF KQUA ,
C     BY THE NUMEROV - COOLEY TECHNIQUE.
C
C                  (                       0                  )
C      2           (                    2 I                   )
C     D            (                2      PP                 )
C     ---PHI (P) = ( F (P) + F (P) K  + ----- ( V   (P) - E ) ) PHI (P)
C       2   B      (  1       2         _2       EFF          )    B
C     DP           (                    H                     )
C
C     FOR THIS THE FOLLOWING DEFINTIONS (EQUATIONS 6.14 TO 6.17) ARE
C     NEEDED :-
C
C     PH  = PHI  (P )
C       I      B   I
C
C             0         _2
C     I  = 2 I   (P ) / H
C      I      PP   I
C
C                             2      0                   _2
C     U  = F  (P ) + F  (P ) K  + 2 I   (P ) V    (P ) / H
C      I    1   I     2   I          PP   I   EFF   I
C
C                 2
C     Y  = ( 1 - H  ( U  - I  E ) ) PH
C      I         --    I    I         I
C                12
C
C     STARTING FROM AN INITIAL GUESS FOR THE ENERGY , GIVEN IN WAVFUN
C     AN ITERATIVE SCHEME IS FOLLOWED. THIS IS PERFORMED BY USING THE
C     RECURSION RELATION (EQN 6.18) :-
C
C                           2
C     Y    + Y    - 2 Y  = H  ( U  - I  E ) PH
C      I+1    I-1      I         I    I       I
C
C     H IS HERE THE HSTEP LENGTH USED TO GENERATE THE F1 , F2 , I0'S
C
C     TO CALCULATE VALUES OF Y(I) AND PHIB(I) BOTH FROM RHO = 0
C     AND FROM RHO = RHOMAX. THESE TWO PARTS ARE CALLED THE OUTWARD
C     AND INWARD INTEGRATIONS RESPECTIVELY.
C     THE OUTWARD INTEGRATION IS CARRIED OUT UNTIL A MAXIMUM IS REACHED
C     IN THE WAVEFUNCTION. THIS CROSSING POINT (IC , YC , PC) IS THEN
C     THE STOPPING POINT USED FOR THE INWARD INTEGRATION.
C     BOTH SETS OF WAVEFUNCTIONS ARE SCALED SO THAT PC(OUT) = PC(IN) = 1
C     AN ERROR FOR THE ENERGY CAN BE CALCULATED FROM EQN 6.24 :-
C
C                                                         NSTINT
C               OUT           IN       2                    \--      2
C     D(E) = (-Y    + 2 Y  - Y    ) / H + U  - I  E ) Y  /   \  I  PH
C               C-1      C    C+1          C    C      C     /   I   I
C                                                           /--
C                                                           I=1
C
C     AND THIS IS ADDED TO THE EGUESS AT EACH ITERATION , WHEN D(E)
C     IS LESS THAN THRSH5 THE ITERATION HAS CONVERGED.
C
      U(I)=F1(I)+F2(I)*KK
C
      Y(I)=(1.0D+00-HH*(U(I)-I0(I)*EGUESS)/12.0D+00)*PHIB(I)
C
      HH=HSTEP*HSTEP
      KK=KQUA*KQUA
C
      PHIB(NSTINT)=0.0D+00
      PHIB(NSTINT-1)=PNM1
C
      NITER=0
C
100   CALL INTOUT ( F1 , F2 , V0 , I0 , GRHO , PHIB ,
     1             PHPR , XJACO , YRHS , XTX , XTY , CS ,
     2             AS , IA1 , IA2 ,
     3             LENIAR , SUMOUT , IC ,
     4             PCOUT, IERR)
      IF (IERR.NE.0) RETURN
C
      CALL INTIN ( F1 , F2 , V0 , I0 , GRHO , PHIB ,
     3            SUMIN , IC , PCIN)
C
      SUM=SUMIN/(PCIN*PCIN)+SUMOUT/(PCOUT*PCOUT)
C
      YC=Y(IC)/PCOUT
C
      YCM1=Y(IC-1)/PCOUT
C
      YCP1=Y(IC+1)/PCIN
C
      DE=((-YCM1+YC+YC-YCP1)/HH+(U(IC)-I0(IC)*EGUESS))*YC/SUM
C
      EGUESS=EGUESS+DE
C
      NITER=NITER+1
C
      IF (ABS(DE).LE.THRSH5) GO TO 150
C
      IF (NITER.EQ.NSTNIN) GO TO 900
C
      GO TO 100
C
C
150   DO 200 I=1,IC
C
      PHIB(I)=PHIB(I)/PCOUT
C
200   CONTINUE
C
      NP1=IC+1
      NM1=NSTINT-1
C
      DO 300 I=NP1,NM1
C
      PHIB(I)=PHIB(I)/PCIN
C
300   CONTINUE
C
C
      RETURN
C
900   WRITE (NFIL6,1000) NSTNIN , DE , THRSH5
      IERR=2
      RETURN
C
1000  FORMAT(1H ,' MORBID.NMI.ERR   ITERATION LIMIT REACHED IN',
     1          ' NUMERICAL INTEGRATION (NITER=',I2,')',/,
     2                      16X,'ENERGY DIFFERENCE =',D13.4,/,
     3                      16X,'CONVERGENCE THRESHOLD =',D13.4,/)
C
      END
C
C
      SUBROUTINE INTOUT ( F1 , F2 , V0 , I0 , GRHO , PHIB ,
     1                   PHPR , XJACO , YRHS , XTX , XTY , CS ,
     2                   AS , IA1 , IA2 ,
     3                   LENIAR , SUMOUT , IC ,
     4                   PCOUT, IERR)
      IMPLICIT REAL*8 (A-H,O-Z)
      REAL*8 M1,M2,M3,M,U1,U3,U13,V,RHO,EPS,
     1      CR,SR,CSE,SNE,
     2      CRE,SRE,CORO,EPSP,EPSPP,EPSPPP
C
      REAL*8 AMASS(3,10)
C
      REAL*8 RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1       AA1,AA3,
     2       F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3       F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4       F13,F1A13,F2A13,F3A13,
     5       F111,F1A111,F2A111,F333,F1A333,F2A333,
     6       F113,F1A113,F2A113,F133,F1A133,F2A133,
     7       F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8       F1333,FA1333,F1133,FA1133,
     8       RE12 , RE32 , RHOREF , VMIN
C
      REAL*8 ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1      PREC
C
      REAL*8 THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1      THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2      VELLGT , PLANCK , AVOGNO , DEGRAD , RADDEG ,
     3      PI
C
      REAL*8   B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      REAL*8   CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
      INTEGER NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5       NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6       NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7       NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6       ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7       IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8       NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER,
     9       ISOMAX , NATTS  , V0TYPE , IVAR(55) , PARMAX ,
     1       NUMPAR , PRTINT
C
      INTEGER V1 ,V2, V3 , V2MXP1, V2P1,
     1       NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2       NSEPP2 , NSEQP1 , MBASIS ,
     3       MDIM , NFSYM0, NFASY0, NFSYMJ, NFASYJ,
     4       KSTYPA(2) , LSTYPA(2) , JMAX , V2MAX , JMAXP1
C
      INTEGER IQUANT(5,10)
C
      LOGICAL SYMM
C
      REAL*8 RMK(2),AAS(2)
      INTEGER NOBAS,MBASP1,LENIW
      INTEGER LENIAR,KK,I,II,IC,NP1,NM1,IST,IEND,IERR
      REAL*8 U,HH,CONST,SUM,REDFAC,SUMOUT,PCOUT,YI,YIM1,YIP1
C
      REAL*8 F1(NSTINT) , F2(NSTINT) , V0(NSTINT) ,
C
     1      I0(NSTINT) , GRHO(NSTINT) , PHIB(NSTINT) , PHPR(NSTINT) ,
C
     2      XJACO(NSERIN,NSEPP2) , YRHS(NSERIN) , XTX(NSEPP2,NSEPP2) ,
C
     3      XTY(NSEPP2) , CS(NSEPP2) , AS(NSEQP1)
C
      INTEGER IA1(LENIAR),IA2(LENIAR)
      COMMON /ISOTOP/ IQUANT,AMASS
C
      COMMON /VALUES/ RHO,EPS,EPSP,EPSPP,EPSPPP,
     1               CR,SR,CSE,SNE,CRE,SRE,CORO
C
      COMMON /MOLCUL/ RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1               AA1,AA3,
     2               F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3               F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4               F13,F1A13,F2A13,F3A13,
     5               F111,F1A111,F2A111,F333,F1A333,F2A333,
     6               F113,F1A113,F2A113,F133,F1A133,F2A133,
     7               F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8               F1333,FA1333,F1133,FA1133,
     8               RE12 , RE32 , M1 , M2 , M3 , M ,
     9               U1 , U3 , U13 , V ,
     1               SYMM
C
      COMMON /INTEG/  ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1               RHOREF , VMIN , V0TYPE ,
     1               NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2               NSEPP2 , NSEQP1 , KSTYPA , LSTYPA
C
      COMMON /DIMEN/  MBASIS ,  V2MAX  , V2MXP1 ,
     1               JMAX   , JMAXP1 , MDIM   , NFSYM0 , NFASY0 ,
     2               NFSYMJ , NFASYJ
C
      COMMON /LSFIT/  PARMAX , NUMPAR , ISOMAX , IVAR
C
      COMMON /SYS/    THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1                     THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2                     VELLGT , PLANCK , AVOGNO , PI , PREC ,
     4                     NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5                     NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6                     NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7                     NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6                     ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7                     IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8                     NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER ,
     9                       NATTS , PRTINT
C
      COMMON/BCOEFF/
     1      B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      COMMON/CRCOEF/
     1      CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
C
      COMMON/MORSE/RMK,AAS
      COMMON/MODIM/NOBAS,MBASP1,LENIW
C
C     SUBROUTINE PERFORMS THE OUTWARD INTEGRATION OF NUMCOO ,
C     UNTIL THE FIRST MAXIMUM IN THE WAVE FUNCTION IS FOUND.
C     THE SUM I0(I)*PHIB(I)**2 IS SAVED FOR THE OUTWARD INTEGRATION
C     AND WILL LATER BR DIVIDED BY PC(OUT)**2.
C     THE FIRST NSERIN POINTS OF THE FUNCTION ARE CALCULATED BY
C     LSQCAP AS DESCRIBED THEREIN
C
      U(I)=F1(I)+F2(I)*KK
C
      KK=KQUA*KQUA
      HH=HSTEP*HSTEP
C
      CALL LSQCAP ( F1 , F2 , V0 , I0 , GRHO , PHIB ,
     1             PHPR , XJACO , YRHS , XTX , XTY , CS ,
     2             AS , IA1 , IA2 , LENIAR , IERR)
      IF (IERR.NE.0) RETURN
C
      SUM=0.0D+00
C
      NM1=NSERIN-1
C
      DO 100 I=1,NM1
C
      SUM=SUM+I0(I)*PHIB(I)*PHIB(I)
C
100   CONTINUE
C
      IST=NSERIN
      IEND=NSTINT-2
C
      YIM1=PHIB(NM1)*(1.0D+00-HH*(U(NM1)-I0(NM1)*EGUESS)/12.0D+00)
C
      YI=PHIB(NSERIN)*(1.0D+00-HH*(U(NSERIN)-I0(NSERIN)*EGUESS)
     1                        /12.0D+00)
C
C
      DO 200 I=IST,IEND
C
      CONST=HH*(U(I)-I0(I)*EGUESS)
C
      PHIB(I)=YI/(1.0D+00-CONST/12.0D+00)
C
      YIP1=CONST*PHIB(I)+YI+YI-YIM1
C
      IF (PHIB(I).LT.PHIB(I-1)) GO TO 300
C
      YIM1=YI
      YI=YIP1
C
      SUM=SUM+I0(I)*PHIB(I)*PHIB(I)
C
      IF (SUM .LT. THRSH3) GOTO 200
C
      REDFAC=SQRT(THRSH3)
C
      DO 150 II=1,I
C
150   PHIB(II)=PHIB(II)/REDFAC
C
      DO 160 II=1,NSEQP1
C
160   AS(II)=AS(II)/REDFAC
C
      YI=YI/REDFAC
C
      YIM1=YIM1/REDFAC
C
      SUM=SUM/THRSH3
C
200   CONTINUE
C
      GO TO 900
C
300   SUMOUT=SUM
C
      IC=I-1
C
      PCOUT=PHIB(IC)
C
      RETURN
C
900   WRITE (NFIL6,1000)
      IERR=1
C
      RETURN
C
1000  FORMAT(1H ,' MORBID.NMI.ERR   NO TURNING POINT FOUND IN ',
     1          'OUTWARD INTEGRATION',/)
C
      END
C
C
C
      SUBROUTINE INTIN ( F1 , F2 , V0 , I0 , GRHO , PHIB ,
     3                  SUMIN , IC , PCIN)
      IMPLICIT REAL*8 (A-H,O-Z)
      REAL*8 M1,M2,M3,M,U1,U3,U13,V,RHO,EPS,
     1      CR,SR,CSE,SNE,
     2      CRE,SRE,CORO,EPSP,EPSPP,EPSPPP
C
      REAL*8 AMASS(3,10)
C
      REAL*8 RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1       AA1,AA3,
     2       F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3       F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4       F13,F1A13,F2A13,F3A13,
     5       F111,F1A111,F2A111,F333,F1A333,F2A333,
     6       F113,F1A113,F2A113,F133,F1A133,F2A133,
     7       F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8       F1333,FA1333,F1133,FA1133,
     8       RE12 , RE32 , RHOREF , VMIN
C
      REAL*8 ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1      PREC
C
      REAL*8 THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1      THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2      VELLGT , PLANCK , AVOGNO , DEGRAD , RADDEG ,
     3      PI
C
      REAL*8   B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      REAL*8   CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
      INTEGER NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5       NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6       NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7       NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6       ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7       IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8       NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER,
     9       ISOMAX , NATTS  , V0TYPE , IVAR(55) , PARMAX ,
     1       NUMPAR , PRTINT
C
      INTEGER V1 ,V2, V3 , V2MXP1, V2P1,
     1       NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2       NSEPP2 , NSEQP1 , MBASIS ,
     3       MDIM , NFSYM0, NFASY0, NFSYMJ, NFASYJ,
     4       KSTYPA(2) , LSTYPA(2) , JMAX , V2MAX , JMAXP1
C
      INTEGER IQUANT(5,10)
C
      LOGICAL SYMM
C
      REAL*8 RMK(2),AAS(2)
      INTEGER NOBAS,MBASP1,LENIW
      INTEGER KK,I,IC,II,NP1,NM1,IST,IEND
      REAL*8 U,HH,CONST,SUM,SUMIN,PCIN,YI,YIM1,YIP1,CONS
C
      REAL*8 F1(NSTINT) , F2(NSTINT) , V0(NSTINT) ,
C
     1      I0(NSTINT) , GRHO(NSTINT) , PHIB(NSTINT)
      COMMON /ISOTOP/ IQUANT,AMASS
C
      COMMON /VALUES/ RHO,EPS,EPSP,EPSPP,EPSPPP,
     1               CR,SR,CSE,SNE,CRE,SRE,CORO
C
      COMMON /MOLCUL/ RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1               AA1,AA3,
     2               F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3               F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4               F13,F1A13,F2A13,F3A13,
     5               F111,F1A111,F2A111,F333,F1A333,F2A333,
     6               F113,F1A113,F2A113,F133,F1A133,F2A133,
     7               F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8               F1333,FA1333,F1133,FA1133,
     8               RE12 , RE32 , M1 , M2 , M3 , M ,
     9               U1 , U3 , U13 , V ,
     1               SYMM
C
      COMMON /INTEG/  ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1               RHOREF , VMIN , V0TYPE ,
     1               NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2               NSEPP2 , NSEQP1 , KSTYPA , LSTYPA
C
      COMMON /DIMEN/  MBASIS ,  V2MAX  , V2MXP1 ,
     1               JMAX   , JMAXP1 , MDIM   , NFSYM0 , NFASY0 ,
     2               NFSYMJ , NFASYJ
C
      COMMON /LSFIT/  PARMAX , NUMPAR , ISOMAX , IVAR
C
      COMMON /SYS/    THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1                     THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2                     VELLGT , PLANCK , AVOGNO , PI , PREC ,
     4                     NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5                     NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6                     NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7                     NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6                     ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7                     IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8                     NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER ,
     9                       NATTS , PRTINT
C
      COMMON/BCOEFF/
     1      B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      COMMON/CRCOEF/
     1      CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
C
      COMMON/MORSE/RMK,AAS
      COMMON/MODIM/NOBAS,MBASP1,LENIW
C
C     SUBROUTINE PERFORMS THE INWARD INTEGRATION FROM RHO=RHOMAX
C     STOPPING AT THE MAXIMUM IN THE WAVEFUNCTION DETERMINED IN
C     INTOUT. THE RECURSION RELATIONS GIVEN IN NUMCOO ARE USED
C     IN CONJUNCTION WITH THE TWO STARTING VALUES :-
C
C     PHI(RHOMAX) = 0
C
C     PHI(RHOMAX-H) = PNM1 ( O 10**-32 )
C
      U(I)=F1(I)+F2(I)*KK
C
      KK=KQUA*KQUA
      HH=HSTEP*HSTEP
C
      SUM=0.0D+00
C
      IST=IC+1
      IEND=NSTINT-1
C
      NM1=IEND
C
      YIP1=0.0D+00
C
      YI=PHIB(NM1)*(1.0D+00-HH*(U(NM1)-I0(NM1)*EGUESS)/12.0D+00)
C
      DO 200 II=IST,IEND
      I=IST+IEND-II
C
      CONST=HH*(U(I)-I0(I)*EGUESS)
C
      PHIB(I)=YI/(1.0D+00-CONST/12.0D+00)
C
      YIM1=CONST*PHIB(I)+YI+YI-YIP1
C
      YIP1=YI
      YI=YIM1
C
      SUM=SUM+I0(I)*PHIB(I)*PHIB(I)
C
200   CONTINUE
C
      SUMIN=SUM
C
      PCIN=YI/(1.0D+00-HH*(U(IC)-I0(IC)*EGUESS)/12.0D+00)
C
      RETURN
C
      END
C
C
      SUBROUTINE LSQCAP ( F1 , F2 , V0 , I0 , GRHO , PHIB ,
     1                   PHPR , XJACO , YRHS , XTX , XTY , CS ,
     2                   AS , IA1 , IA2 , LENIAR , IERR)
      IMPLICIT REAL*8 (A-H,O-Z)
      REAL*8 M1,M2,M3,M,U1,U3,U13,V,RHO,EPS,
     1      CR,SR,CSE,SNE,
     2      CRE,SRE,CORO,EPSP,EPSPP,EPSPPP
C
      REAL*8 AMASS(3,10)
C
      REAL*8 RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1       AA1,AA3,
     2       F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3       F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4       F13,F1A13,F2A13,F3A13,
     5       F111,F1A111,F2A111,F333,F1A333,F2A333,
     6       F113,F1A113,F2A113,F133,F1A133,F2A133,
     7       F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8       F1333,FA1333,F1133,FA1133,
     8       RE12 , RE32 , RHOREF , VMIN
C
      REAL*8 ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1      PREC
C
      REAL*8 THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1      THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2      VELLGT , PLANCK , AVOGNO , DEGRAD , RADDEG ,
     3      PI
C
      REAL*8   B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      REAL*8   CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
      INTEGER NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5       NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6       NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7       NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6       ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7       IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8       NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER,
     9       ISOMAX , NATTS  , V0TYPE , IVAR(55) , PARMAX ,
     1       NUMPAR , PRTINT
C
      INTEGER V1 ,V2, V3 , V2MXP1, V2P1,
     1       NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2       NSEPP2 , NSEQP1 , MBASIS ,
     3       MDIM , NFSYM0, NFASY0, NFSYMJ, NFASYJ,
     4       KSTYPA(2) , LSTYPA(2) , JMAX , V2MAX , JMAXP1
C
      INTEGER IQUANT(5,10)
C
      LOGICAL SYMM
C
      REAL*8 RMK(2),AAS(2)
      INTEGER NOBAS,MBASP1,LENIW
      INTEGER LENIAR,KK,I,NP1,NM1,IST,IEND,IERR,II,JJ,
     1       NPEND,NI,IRET,N,J
      REAL*8 U,HH,SUM,SUMOUT,PCOUT,YI,YIM1,YIP1,DET,TEST,
     1      RHOA,SUMRHS,ALPHA,COEFF
C
      REAL*8 F1(NSTINT) , F2(NSTINT) , V0(NSTINT) ,
C
     1      I0(NSTINT) , GRHO(NSTINT) , PHIB(NSTINT) , PHPR(NSTINT) ,
C
     2      XJACO(NSERIN,NSEPP2) , YRHS(NSERIN) , XTX(NSEPP2,NSEPP2) ,
C
     3      XTY(NSEPP2) , CS(NSEPP2) , AS(NSEQP1)
C
      INTEGER IA1(LENIAR),IA2(LENIAR)
      COMMON /ISOTOP/ IQUANT,AMASS
C
      COMMON /VALUES/ RHO,EPS,EPSP,EPSPP,EPSPPP,
     1               CR,SR,CSE,SNE,CRE,SRE,CORO
C
      COMMON /MOLCUL/ RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1               AA1,AA3,
     2               F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3               F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4               F13,F1A13,F2A13,F3A13,
     5               F111,F1A111,F2A111,F333,F1A333,F2A333,
     6               F113,F1A113,F2A113,F133,F1A133,F2A133,
     7               F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8               F1333,FA1333,F1133,FA1133,
     8               RE12 , RE32 , M1 , M2 , M3 , M ,
     9               U1 , U3 , U13 , V ,
     1               SYMM
C
      COMMON /INTEG/  ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1               RHOREF , VMIN , V0TYPE ,
     1               NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2               NSEPP2 , NSEQP1 , KSTYPA , LSTYPA
C
      COMMON /DIMEN/  MBASIS ,  V2MAX  , V2MXP1 ,
     1               JMAX   , JMAXP1 , MDIM   , NFSYM0 , NFASY0 ,
     2               NFSYMJ , NFASYJ
C
      COMMON /LSFIT/  PARMAX , NUMPAR , ISOMAX , IVAR
C
      COMMON /SYS/    THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1                     THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2                     VELLGT , PLANCK , AVOGNO , PI , PREC ,
     4                     NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5                     NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6                     NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7                     NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6                     ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7                     IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8                     NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER ,
     9                       NATTS , PRTINT
C
      COMMON/BCOEFF/
     1      B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      COMMON/CRCOEF/
     1      CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
C
      COMMON/MORSE/RMK,AAS
      COMMON/MODIM/NOBAS,MBASP1,LENIW
C
C     SUBROUTINE FITS THE FIRST NSERIN VALUES OF
C
C     T  = U  - I  E
C      I    I    I  GUESS
C
C     TO THE SERIES EXPANSION IN EQN. 6.30 :-
C
C                     P
C                   \--
C            C       \       2I
C     T(P) =  -2  +  /  C   P
C            ---    /--  2I
C             2     I=0
C            P
C
C     THIS IS DONE WITH A LEAST SQUARES METHOD , WITH THE EQUATIONS
C     BEING SOLVED BY THE ROUTINE SOLVD.
C     FROM THE VALUES OF C2I , THE VALUE ALPHA GIVEN BY (EQN. 6.34) :-
C
C                                    1/2
C     ALPHA = 1/2 ( 1 + ( 1 + 4 C   )    )
C                                -2
C
C     AND THE A2I'S GIVEN BY (EQN. 6.35) :-
C                                               P
C                                             \--
C    ((ALPHA+N+1)*(ALPHA+N+1) - C   ) A    =   \   C   A
C    (                           -2 )  N+2     /    2I  N-2I
C                                             /--
C                                             I=0
C
C     ARE CALCULATED.
C
C     FROM THE A2I'S VALUES OF PHIB(RHO) MAY BE CALCULATED FROM
C     EQN 6.32 :-
C                        Q
C                ALPHA \--       2I
C     PHIB(P) = P       \   A   P
C                       /    2I
C                      /--
C                      I=0
C
C
C
      IERR=0
      RHO=0.0D+00
C
      DO 50 N=1,NSERIN
C
      RHO=RHO+HSTEP
C
      DO 40 I=1,NSEPP2
C
40    XJACO(N,I)=RHO**(I+I-4)
C
      YRHS(N)=F1(N)+F2(N)*KQUA*KQUA-I0(N)*EGUESS
C
50    CONTINUE
C
      DO 340 I=1,NSEPP2
      SUMRHS=0.0D+00
      DO 320 J=1,NSEPP2
      SUM=0.0D+00
      DO 310 N=1,NSERIN
310   SUM=SUM+XJACO(N,I)*XJACO(N,J)
320   XTX(I,J)=SUM
      DO 330 N=1,NSERIN
330   SUMRHS=SUMRHS+XJACO(N,I)*YRHS(N)
340   XTY(I)=SUMRHS
      CALL SOLVD (XTX,IA1,IA2,NSEPP2,NSEPP2,LENIAR,DET,TEST)
      IF (TEST .NE. 0.0D+00) GOTO 900
      DO 360 I=1,NSEPP2
      SUM=0.0D+00
      DO 350 J=1,NSEPP2
350   SUM=SUM+XTX(I,J)*XTY(J)
360   CS(I)=SUM
C
      IF (CS(1).LT.-0.25D+00) CS(1)=-0.25D+00
C
      ALPHA=0.5*(1.0D+00+SQRT(1.0D+00+4.0D+00*CS(1)))
C
      AS(1)=1.0D+00
C
      IF (NSEQP1.LT.2) GO TO 120
C
      DO 100 JJ=2,NSEQP1
C
      N=JJ+JJ-4
C
      COEFF=(ALPHA+FLOAT(N+1))*(ALPHA+FLOAT(N+2))-CS(1)
C
      NPEND=MIN0(NSEPP2,JJ)
C
      SUM=0.0D+00
      DO 90 II=2,NPEND
      I=II-2
C
      NI=JJ-I-1
C
      SUM=SUM+CS(II)*AS(NI)
C
90    CONTINUE
C
      AS(JJ)=SUM/COEFF
C
100   CONTINUE
C
120   RHO=0.0D+00
C
      DO 200 N=1,NSERIN
C
      RHO=RHO+HSTEP
C
      RHOA=RHO**ALPHA
C
      SUM=0.0D+00
      DO 150 II=1,NSEQP1
      I=II-1
C
      SUM=SUM+AS(II)*RHO**(I+I)
C
150   CONTINUE
C
      PHIB(N)=RHOA*SUM
C
200   CONTINUE
C
      RETURN
C
900   IERR=5
      WRITE (NFIL6,5000) TEST
5000  FORMAT(1H0,' MORBID.SSO.ERR   SOLVD HAS FAILED IN SUBROUTINE',
     1          ' LSQCAP, TEST = ',D11.3)
      RETURN
C
      END
C
C
      SUBROUTINE SOLVD (X,I1,I2,MM,N,LENI,DET,TEST)
      IMPLICIT REAL*8 (A-H,O-Z)
      REAL*8 M1,M2,M3,M,U1,U3,U13,V,RHO,EPS,
     1      CR,SR,CSE,SNE,
     2      CRE,SRE,CORO,EPSP,EPSPP,EPSPPP
C
      REAL*8 AMASS(3,10)
C
      REAL*8 RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1       AA1,AA3,
     2       F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3       F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4       F13,F1A13,F2A13,F3A13,
     5       F111,F1A111,F2A111,F333,F1A333,F2A333,
     6       F113,F1A113,F2A113,F133,F1A133,F2A133,
     7       F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8       F1333,FA1333,F1133,FA1133,
     8       RE12 , RE32 , RHOREF , VMIN
C
      REAL*8 ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1      PREC
C
      REAL*8 THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1      THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2      VELLGT , PLANCK , AVOGNO , DEGRAD , RADDEG ,
     3      PI
C
      REAL*8   B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      REAL*8   CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
      INTEGER NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5       NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6       NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7       NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6       ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7       IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8       NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER,
     9       ISOMAX , NATTS  , V0TYPE , IVAR(55) , PARMAX ,
     1       NUMPAR , PRTINT
C
      INTEGER V1 ,V2, V3 , V2MXP1, V2P1,
     1       NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2       NSEPP2 , NSEQP1 , MBASIS ,
     3       MDIM , NFSYM0, NFASY0, NFSYMJ, NFASYJ,
     4       KSTYPA(2) , LSTYPA(2) , JMAX , V2MAX , JMAXP1
C
      INTEGER IQUANT(5,10)
C
      LOGICAL SYMM
C
      REAL*8 RMK(2),AAS(2)
      INTEGER NOBAS,MBASP1,LENIW
C
      INTEGER LENI,MM,N,I,J,K,IROW,JCOL
      INTEGER I1(LENI), I2(LENI)
      REAL*8 X(MM,N),T,DET,BIG,TEST,PIV,TEMP
      COMMON /ISOTOP/ IQUANT,AMASS
C
      COMMON /VALUES/ RHO,EPS,EPSP,EPSPP,EPSPPP,
     1               CR,SR,CSE,SNE,CRE,SRE,CORO
C
      COMMON /MOLCUL/ RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1               AA1,AA3,
     2               F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3               F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4               F13,F1A13,F2A13,F3A13,
     5               F111,F1A111,F2A111,F333,F1A333,F2A333,
     6               F113,F1A113,F2A113,F133,F1A133,F2A133,
     7               F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8               F1333,FA1333,F1133,FA1133,
     8               RE12 , RE32 , M1 , M2 , M3 , M ,
     9               U1 , U3 , U13 , V ,
     1               SYMM
C
      COMMON /INTEG/  ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1               RHOREF , VMIN , V0TYPE ,
     1               NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2               NSEPP2 , NSEQP1 , KSTYPA , LSTYPA
C
      COMMON /DIMEN/  MBASIS ,  V2MAX  , V2MXP1 ,
     1               JMAX   , JMAXP1 , MDIM   , NFSYM0 , NFASY0 ,
     2               NFSYMJ , NFASYJ
C
      COMMON /LSFIT/  PARMAX , NUMPAR , ISOMAX , IVAR
C
      COMMON /SYS/    THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1                     THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2                     VELLGT , PLANCK , AVOGNO , PI , PREC ,
     4                     NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5                     NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6                     NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7                     NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6                     ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7                     IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8                     NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER ,
     9                       NATTS , PRTINT
C
      COMMON/BCOEFF/
     1      B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      COMMON/CRCOEF/
     1      CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
C
      COMMON/MORSE/RMK,AAS
      COMMON/MODIM/NOBAS,MBASP1,LENIW
      EQUIVALENCE (BIG,TEMP,PIV)
C
C     INITIALIZATION
C
      DET = 1.E0
      TEMP = ABS(PREC)
      IF (TEMP .EQ. 0.E0)  TEMP = 0.5E-14
      TEST = 0.E0
      DO 1 I = 1,MM
      I2(I) = 0
      DO 1 J = 1,MM
1     TEST = TEST + X(I,J) * X(I,J)
      TEST = TEMP * SQRT(TEST) / MM
C
C     SEARCH FOR NEXT PIVOT, AVOIDING ROWS AND COLUMNS WHICH ALREADY
C     CONTAIN A PIVOT.
C
      DO 9 K = 1,MM
      BIG = 0.E0
      DO 3 I = 1,MM
      IF (I2(I) .NE. 0) GO TO 3
      DO 2 J = 1,MM
      IF (I2(J) .NE. 0) GO TO 2
      T =ABS(X(I,J))
      IF (T .LE. BIG) GO TO 2
      BIG = T
      IROW = I
      JCOL = J
2     CONTINUE
3     CONTINUE
      IF (BIG .LE. TEST) RETURN
C
C     RECORD POSITION OF PIVOT THEN MOVE PIVOTAL ROW SO PIVOT LIES ON
C     THE DIAGONAL. SCALE PIVOTAL ROW.
C
      I1(K) = JCOL
      I2(JCOL) = IROW
      IF (JCOL .EQ. IROW) GO TO 6
      DO 5 J = 1,N
      TEMP = X(IROW,J)
      X(IROW,J) = X(JCOL,J)
5     X(JCOL,J) = TEMP
      DET = -DET
6     DET = DET * X(JCOL,JCOL)
      PIV = 1.E0/X(JCOL,JCOL)
      DO 7 J = 1,N
      IF (J .NE. JCOL)  X(JCOL,J) = PIV * X(JCOL,J)
7     CONTINUE
      X(JCOL,JCOL) = PIV
C
C     ELIMINATE REMAINING ROWS.
C
      DO 9 I = 1,MM
      IF (I .EQ. JCOL)  GO TO 9
      PIV = -X(I,JCOL)
      DO 8 J = 1,N
      IF (J .NE. JCOL)  X(I,J) = X(I,J) + PIV * X(JCOL,J)
8     CONTINUE
      X(I,JCOL) = PIV * X(JCOL,JCOL)
9     CONTINUE
C
C     UNSCRAMBLE THE COLUMNS OF THE INVERSE ACCORDING TO THE ORIGINAL
C     POSITIONS OF THE PIVOTS.
C
      DO 11 K = 1,MM
      I = MM+1 - K
      JCOL = I1(I)
      IROW = I2(JCOL)
      IF (IROW .EQ. JCOL)  GO TO 11
      DO 10 I = 1,MM
      TEMP = X(I,IROW)
      X(I,IROW) = X(I,JCOL)
10    X(I,JCOL) = TEMP
11    CONTINUE
      TEST = 0.E0
      RETURN
      END
C
C
      SUBROUTINE D04AAF(IFUN, NDER, DER, EREST, FUN, IFAIL)
      IMPLICIT REAL*8 (A-H,O-Z)
      REAL*8 M1,M2,M3,M,U1,U3,U13,V,RHO,EPS,
     1      CR,SR,CSE,SNE,
     2      CRE,SRE,CORO,EPSP,EPSPP,EPSPPP
C
      REAL*8 AMASS(3,10)
C
      REAL*8 RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1       AA1,AA3,
     2       F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3       F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4       F13,F1A13,F2A13,F3A13,
     5       F111,F1A111,F2A111,F333,F1A333,F2A333,
     6       F113,F1A113,F2A113,F133,F1A133,F2A133,
     7       F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8       F1333,FA1333,F1133,FA1133,
     8       RE12 , RE32 , RHOREF , VMIN
C
      REAL*8 ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1      PREC
C
      REAL*8 THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1      THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2      VELLGT , PLANCK , AVOGNO , DEGRAD , RADDEG ,
     3      PI
C
      REAL*8   B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      REAL*8   CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
      INTEGER NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5       NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6       NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7       NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6       ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7       IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8       NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER,
     9       ISOMAX , NATTS  , V0TYPE , IVAR(55) , PARMAX ,
     1       NUMPAR , PRTINT
C
      INTEGER V1 ,V2, V3 , V2MXP1, V2P1,
     1       NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2       NSEPP2 , NSEQP1 , MBASIS ,
     3       MDIM , NFSYM0, NFASY0, NFSYMJ, NFASYJ,
     4       KSTYPA(2) , LSTYPA(2) , JMAX , V2MAX , JMAXP1
C
      INTEGER IQUANT(5,10)
C
      LOGICAL SYMM
C
      REAL*8 RMK(2),AAS(2)
      INTEGER NOBAS,MBASP1,LENIW
C
C     ***   PURPOSE   ***
C
C     A SUBROUTINE FOR NUMERICAL DIFFERENTIATION AT A POINT.  IT
C     RETURNS A SET OF APPROXIMATIONS TO THE J-TH ORDER DERIVATIVE
C     (J=1,2,...14) OF FUN(X) EVALUATED AT X = XVAL  AND, FOR EACH
C     DERIVATIVE, AN ERROR ESTIMATE ( WHICH INCLUDES THE EFFECT OF
C     AMPLIFICATION OF ROUND- OFF ERRORS).
C
C
C     ***   INPUT  PARAMETERS   ***
C
C     (1) XVAL   REAL.  THE ABSCISSA AT WHICH THE SET OF
C     DERIVATIVES IS REQUIRED.
C     (2) NDER   INTEGER. THE HIGHEST ORDER DERIVATIVE REQUIRED.
C     IF(NDER.GT.0)  ALL DERIVATIVES UP TO MIN(NDER,14) ARE
C     CALCULATED.
C     IF(NDER.LT.0 AND NDER EVEN)  EVEN ORDER DERIVATIVES
C     UP TO MIN(-NDER,14) ARE CALCULATED.
C     IF(NDER.LT.0 AND NDER ODD )  ODD  ORDER DERIVATIVES
C     UP TO MIN(-NDER,13) ARE CALCULATED.
C     (3) HBASE  REAL.  A STEP LENGTH.
C     (6) FUN    THE NAME OF A REAL*8 FUNCTION SUBPROGRAMME,
C     WHICH IS REQUIRED BY THE ROUTINE AS A SUBPROGRAMME
C     AND WHICH REPRESENTS THE FUNCTION BEING DIFFERENTIATED
C     THE ROUTINE REQUIRES 21 FUNCTION EVALUATIONS FUN(X)
C     LOCATED AT    X = XVAL    AND AT
C     X = XVAL + (2*J-1)*HBASE,  J=-9,-8, .... +9,+10.
C     THE FUNCTION VALUE AT  X = XVAL IS DISREGARDED WHEN
C     ONLY ODD ORDER DERIVATIVES ARE REQUIRED.
C
C     ***   OUTPUT PARAMETERS   ***
C
C     (4) DER(J)   J=1,2,...14.  REAL. A VECTOR OF
C     APPROXIMATIONS TO THE J-TH DERIVATIVE OF FUN(X)
C     EVALUATED AT X = XVAL.
C     (5) EREST(J) J=1,2,...14.  REAL. A VECTOR OF
C     ESTIMATES OF THE DABSOLUTE ACCURACY OF DER(J).  THESE
C     ARE NEGATIVE WHEN EREST(J).GT.ABS(DER(J)), OR WHEN,
C     FOR SOME OTHER REASON THE ROUTINE IS DOUBTFUL ABOUT
C     THE VALIDITY OF THE RESULT.
C
C     ***   IMPORTANT WARNING   ***
C
C     EREST IS AN ESTIMATE OF THE OVERALL ERROR.  IT IS ESSENTIAL
C     FOR
C     PROPER USE THAT THE USER CHECKS EACH VALUE OF DER
C     SUBSEQUENTLY
C     USED TO SEE THAT IT IS ACCURATE ENOUGH FOR HIS PURPOSES.
C     FAILURE TO DO THIS MAY RESULT IN THE CONTAMINATION OF ALL
C     SUBSEQUENT RESULTS.
C     IT IS TO BE EXPECTED THAT IN NEARLY ALL CASES  DER(14) WILL
C     BE
C     UNUSABLE.( 14 REPRESENTS A LIMIT IN WHICH FOR THE EASIEST
C     FUNCTION LIKELY TO BE ENCOUNTERED THIS ROUTINE MIGHT JUST
C     OBTAIN
C     AN APPROXIMATION OF THE CORRECT SIGN.)
C
C     ***   NOTE ON CALCULATION   ***
C
C     THE CALCULATION IS BASED ON THE EXTENDED T-TABLE (T SUB
C     K,P,S)
C     DESCRIBED IN LYNESS AND MOLER, NUM. MATH., 8, 458-464,(1966).
C     REFERENCES IN COMMENT CARDS TO TTAB(NK,NP,NS) REFER TO
C     T-TABLE
C     WITH NK=K+1,  NP=P+1,  NS=S+1.   SINCE ONLY PART OF THE
C     EXTENDED
C     T-TABLE IS NEEDED AT ONE TIME, THAT PART IS STORED IN
C     RTAB(10,7)
C     AND IS SUBSEQUENTLY OVERWRITTEN.  HERE
C     RTAB(NK,NP-NS+1)  =  TTAB(NK,NP,NS).
C
C     NAG COPYRIGHT 1976
C     MARK 5 RELEASE
C     MARK 6B REVISED  IER-116 (MAR 1978)
C     MARK 7 REVISED IER-139 (DEC 1978)
C     MARK 8 REVISED. IER-219 (MAR 1980)
C     MARK 8D REVISED. IER-271 (DEC 1980).
      INTEGER NDERP, NDER, NDPAR, IFAIL, N, NN1, NSQ, NPAR, NSMAX,J,
     1 NEGER, NS, NPMIN, NP, NKTOP, NPR, NK, NTOP, NMAX, NMIN,NUP, NLO,
     1 NTOPM2, JNS, P01AAF,NST2,II,IFUN
      REAL*8 SRNAME
      REAL*8 DER(4), EREST(4), FACT,
     1 ACOF(10),FZ, H, HFACT, HSQ, A, B, RANGE(7), RANMIN, TEMP, TERM,
     1RTAB(10,7), TZEROM(10), ERPREV, ERNOW, XJNS, XMAX, XMIN,XNUM,
     1 THRON2, ZERO, ONE, TWO, X02ACF, BIG, SMALL, X02ABF,HTEST, FTEST
      REAL*8 FUN(NSTINT)
      COMMON /ISOTOP/ IQUANT,AMASS
C
      COMMON /VALUES/ RHO,EPS,EPSP,EPSPP,EPSPPP,
     1               CR,SR,CSE,SNE,CRE,SRE,CORO
C
      COMMON /MOLCUL/ RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1               AA1,AA3,
     2               F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3               F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4               F13,F1A13,F2A13,F3A13,
     5               F111,F1A111,F2A111,F333,F1A333,F2A333,
     6               F113,F1A113,F2A113,F133,F1A133,F2A133,
     7               F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8               F1333,FA1333,F1133,FA1133,
     8               RE12 , RE32 , M1 , M2 , M3 , M ,
     9               U1 , U3 , U13 , V ,
     1               SYMM
C
      COMMON /INTEG/  ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1               RHOREF , VMIN , V0TYPE ,
     1               NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2               NSEPP2 , NSEQP1 , KSTYPA , LSTYPA
C
      COMMON /DIMEN/  MBASIS ,  V2MAX  , V2MXP1 ,
     1               JMAX   , JMAXP1 , MDIM   , NFSYM0 , NFASY0 ,
     2               NFSYMJ , NFASYJ
C
      COMMON /LSFIT/  PARMAX , NUMPAR , ISOMAX , IVAR
C
      COMMON /SYS/    THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1                     THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2                     VELLGT , PLANCK , AVOGNO , PI , PREC ,
     4                     NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5                     NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6                     NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7                     NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6                     ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7                     IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8                     NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER ,
     9                       NATTS , PRTINT
C
      COMMON/BCOEFF/
     1      B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      COMMON/CRCOEF/
     1      CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
C
      COMMON/MORSE/RMK,AAS
      COMMON/MODIM/NOBAS,MBASP1,LENIW
      DATA ZERO, ONE, TWO, THRON2 /0.0E0,1.0E0,2.0E0,1.5D0/
C
C     TO ALTER THE PRECISION OF THE WHOLE ROUTINE,ALTER THE
C     PRECISION
C     IN THE ABOVE DECLARATION AND DATA STATEMENTS
C
C     QUIT ON ZERO HBASE AND ZERO NDER.  SET CONTROL PARAMETER
C     NDPAR.
C     NDPAR = +1  ODD-ORDER DERIVATIVES ONLY.
C     NDPAR =  0  ALL DERIVATIVES
C     NDPAR = -1  EVEN-ORDER DERIVATIVES ONLY.
      BIG=16.0D+00**31.0D+00
      SMALL=16.0D+00**(-31.0D+00)
      IF (HBASE.EQ.ZERO) GO TO 20
      NDERP = NDER
      NDPAR = 0
      IF (NDER) 40, 20, 60
20    IFAIL=1
      RETURN
40    NDPAR = 4*(NDER/2) - 2*NDER - 1
      NDERP = -NDER
60    CONTINUE
      IF (NDERP.GT.4) NDERP = 4
C
C     NEXT, EVALUATE 21 FUNCTION VALUES , SET ACOF(N), AND SET
C     FIRST
C     COLUMN OF RTAB FOR ODD ORDER DERIVATIVES AND STORE IN TZEROM
C     THE
C     FIRST COLUMN OF RTAB FOR EVEN ORDER DERIVATIVES.
C     FZ = FUN(XVAL)
C
      FZ=FUN(IFUN)
      NST2=NSTINT+NSTINT
C
      DO 80 N=1,10
       NN1 = 2*N - 1
       NSQ = NN1*NN1
       ACOF(N) = NSQ
       XNUM = NN1
       H = HBASE*XNUM
C
       II=IFUN+NN1
       IF (II.GT.NSTINT) TEMP=ZERO
C
       IF (II.LE.NSTINT) TEMP=FUN(II)
C
       II=IFUN-NN1
       IF (II.EQ.0) TERM=ZERO
C
       IF (II.LT.0) TERM=-FUN(IABS(II))
C
       IF (II.GT.0) TERM=FUN(II)
C
       RTAB(N,1) = (TEMP-TERM)/(TWO*H)
       TZEROM(N) = (TEMP-FZ-FZ+TERM)/(TWO*H**2)
80    CONTINUE
C
C     SET UP FOR ODD-ORDER DERIVATIVES.
      IF (NDPAR.EQ.-1) GO TO 100
      NPAR = 1
      NSMAX = (NDERP+1)/2
      IF (NSMAX.LE.0) GO TO 380
      GO TO 140
C
C     SET UP FOR EVEN-ORDER DERIVATIVES.
100   CONTINUE
      NPAR = -1
      IF (NDPAR.EQ.+1) GO TO 460
      NSMAX = NDERP/2
      IF (NSMAX.LE.0) GO TO 460
C
C     SET THE FIRST COLUMN OF THE T-TABLE FOR EVEN ORDER
C     DERIVATIVES.
      DO 120 J=1,10
       RTAB(J,1) = TZEROM(J)
120   CONTINUE
140   CONTINUE
C
C     ODD-ORDER AND EVEN ORDER PATHS JOIN UP HERE.
C
      NEGER = 0
      HSQ = HBASE*HBASE
      FACT = ONE
      HFACT = ONE
      DO 360 NS=1,NSMAX
C
C     FROM HERE ON TO   STATEMENT 360 (NEAR END)  WE ARE DEALING
C     WITH A
C     SPECIFIED VALUE OF NS.
C
C     FOR EACH VALUE OF NP WE CALCULATE RANGE(NP)  WHICH IS THE
C     DIFFERE
C     BETWEEN THE GREATEST AND THE LEAST OF THE ELEMENTS
C     TTAB(NK,NP,NS)
C     AS WE GO ALONG WE DETERMINE ALSO THE MINIMUM OF RANGE(NP)
C     WHICH I
C     RANMIN = RANGE(NPMIN).
C     WE RETAIN NUP AND NLO WHICH ARE THE VALUES  OF NK GIVING THE
C     EXTREME VALUES OF TTAB(NK,NPMIN,NS).
C     THIS PART OF NS LOOP CONCLUDES AT STATEMENT NUMBER 280.
C
C
C     FIRST CALCULATE ELEMENTS OF T-TABLE  FOR CURRENT NS VALUE.
       NPMIN = NS
       IF (NS.EQ.1) NPMIN = 2
       DO 180 NP=NPMIN,7
          NKTOP = 10 - NP + 1
          NPR = NP - NS + 1
          DO 160 NK=1,NKTOP
             J = NP + NK - 1
             A = ACOF(J)
             B = ACOF(NK)
             TERM = ZERO
             TEMP = ZERO
             IF (NP.NE.NS) TEMP = A*RTAB(NK,NPR-1) -B*RTAB(NK+1,NPR-1)
             IF (NS.NE.1) TERM = -RTAB(NK,NPR) + RTAB(NK+1,NPR)
             RTAB(NK,NPR) = (TERM+TEMP)/(A-B)
160         CONTINUE
180      CONTINUE
C
C     NOW CALCULATE NUP,NLO AND RANMIN.
       DO 280 NP=NS,7
          NTOP = 11 - NP
          NPR = NP - NS + 1
          XMAX = RTAB(1,NPR)
          XMIN = RTAB(1,NPR)
          NMAX = 1
          NMIN = 1
C
          DO 200 NK=2,NTOP
             TEMP = RTAB(NK,NPR)
             IF (TEMP.GT.XMAX) NMAX = NK
             IF (TEMP.GT.XMAX) XMAX = TEMP
             IF (TEMP.LT.XMIN) NMIN = NK
             IF (TEMP.LT.XMIN) XMIN = TEMP
200         CONTINUE
C
          RANGE(NP) = XMAX - XMIN
          IF (NP.NE.NS) GO TO 220
          RANMIN = RANGE(NP)
          GO TO 240
220         CONTINUE
          IF (RANGE(NP).GE.RANMIN) GO TO 260
          RANMIN = RANGE(NP)
240         CONTINUE
          NPMIN = NP
          NUP = NMAX
          NLO = NMIN
          IF (NLO.EQ.NUP) NLO = NLO + 1
260         CONTINUE
280      CONTINUE
C
C     NEXT WE TAKE THE AVERAGE OF ALL EXCEPT THE EXTREME VALUES OF
C     TTAB(NK,NPMIN,NS) AS THE RESULT AND RANMIN AS THE ERROR
C     ESTIMATE.
       TERM = ZERO
       NTOP = 11 - NPMIN
       NTOPM2 = NTOP - 2
       XNUM = NTOPM2
       J = NPMIN - NS + 1
       DO 320 NK=1,NTOP
          IF (NK.EQ.NUP) GO TO 300
          IF (NK.EQ.NLO) GO TO 300
          TERM = TERM + RTAB(NK,J)
300         CONTINUE
320      CONTINUE
       TERM = TERM/XNUM
C
C     THE ABOVE RESULT AND ERROR ESTIMATE REFER TO TAYLOR
C     COEFFICIENT.
C     NEXT WE DO SCALING TO OBTAIN DERIVATIVE RESULTS INSTEAD.
C     JNS AND XJNS ARE ACTUAL ORDER OF DERIVATIVE BEING TREATED.
C     SAFETY FACTORS 1.5,1.5,2.0,2.0 AND 2.0 ARE MULTIPLIED INTO
C     THE
C     ERROR ESTIMATES FOR J = 10,11,12,13 AND 14 RESPECTIVELY.
C     THESE
C     HAVE BEEN CHOSEN BY INSPECTION OF PERFORMANCE STATISTICS.
C     THERE
C     IS NO ANALYTIC JUSTIFICATION FOR THESE PARTICULAR FACTORS.
       JNS = 2*NS - 1
       IF (NPAR.LT.0) JNS = 2*NS
       XJNS = JNS
       FACT = FACT*XJNS
C     TEST FOR UNDERFLOW OF HFACT
       IF (HFACT.GE.1.0E0) GO TO 330
       HTEST = HFACT*BIG
       FTEST = TERM*FACT
       IF ((TWO*RANMIN*FACT).GT.FTEST) FTEST = TWO*RANMIN*FACT
       IF (HTEST.GT.FTEST) GO TO 330
       DER(JNS) = BIG
       EREST(JNS) = -DER(JNS)
       NEGER = NEGER + 1
       GO TO 340
C     END OF CODE TO HANDLE ZERO HFACT
330      CONTINUE
       DER(JNS) = TERM*FACT/HFACT
       IF (JNS.EQ.10) RANMIN = THRON2*RANMIN
       IF (JNS.EQ.11) RANMIN = THRON2*RANMIN
       IF (JNS.GE.12) RANMIN = TWO*RANMIN
       EREST(JNS) = RANMIN*FACT/(HFACT)
C
C     SET SIGN OF EREST.  EREST NEGATIVE EITHER IF IT SWAMPS DER,
C     OR IF
C     TWO PREVIOUS CONSECUTIVE ERESTS OF THIS PARITY ARE NEGATIVE.
C     IT MAY ALSO BE SET NEGATIVE AT END (750).
       IF (NEGER.GE.2) EREST(JNS) = -EREST(JNS)
       IF (NEGER.GE.2) GO TO 340
       IF (TERM.LT.RANMIN) EREST(JNS) = -EREST(JNS)
       IF (-TERM.GE.RANMIN) EREST(JNS) = -EREST(JNS)
       IF (EREST(JNS).LT.ZERO) NEGER = NEGER + 1
       IF (EREST(JNS).GE.ZERO) NEGER = 0
340      CONTINUE
C
C     SECOND TEST FOR UNDERFLOW OF HFACT
       IF (HFACT.GE.1.0E0) GO TO 346
       IF (HFACT.EQ.0.0E0) GO TO 352
       IF (HSQ.GE.SMALL/HFACT) GO TO 346
       HFACT = 0.0E0
       GO TO 352
346      HFACT = HSQ*HFACT
352      FACT = FACT*(XJNS+ONE)
360   CONTINUE
C
380   CONTINUE
      IF (NPAR.GT.0) GO TO 100
C
C     SET SIGN OF EREST NEGATIVE IF TWO PREVIOUS CONSECUTIVE ERESTS
C     ARE NEGATIVE.
      IF (NDPAR.NE.0) GO TO 460
      IF (NDERP.LE.2) GO TO 460
      NEGER = 0
      ERPREV = EREST(1)
      DO 440 J=2,NDERP
       ERNOW = EREST(J)
       IF (NEGER.EQ.2) GO TO 400
       IF (ERPREV.GE.ZERO) GO TO 420
       IF (ERNOW.GE.ZERO) GO TO 420
400      NEGER = 2
       IF (ERNOW.GT.ZERO) EREST(J) = -ERNOW
420      ERPREV = ERNOW
440   CONTINUE
C
460   CONTINUE
      IFAIL = 0
C
C     DO 500 I=1,NDERP
C     EREST(I)=EREST(I)/DER(I)
C 500 CONTINUE
C
      RETURN
C     END OF D04AAF   ***   ***   ***   ***   ***
      END

C
C
      SUBROUTINE INVERT ( IA , IB , IO ,
     1                   MA , MB , MO )
      IMPLICIT REAL*8 (A-H,O-Z)
C            :
C DATE       : 24.04.1986
C AUTHOR     : PER JENSEN
C UPDATES    :
C LANGUAGE   : FORTRAN
C PURPOSE    : GIVEN A TWO BY TWO SYMMETRICAL MATRIX WHOSE ELEMENTS ARE
C            : FOURTH ORDER POLYNOMIALS IN THE R SUB I'S, INVERT
C            : CALCULATES THE EXPANSION COEFFICIENTS TO FOURTH ORDER OF
C            : ELEMENTS OF THE INVERSE MATRIX.
C            : THE CODE IS GENERATED BY REDUCE.
C            :
      REAL*8 M1,M2,M3,M,U1,U3,U13,V,RHO,EPS,
     1      CR,SR,CSE,SNE,
     2      CRE,SRE,CORO,EPSP,EPSPP,EPSPPP
C
      REAL*8 AMASS(3,10)
C
      REAL*8 RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1       AA1,AA3,
     2       F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3       F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4       F13,F1A13,F2A13,F3A13,
     5       F111,F1A111,F2A111,F333,F1A333,F2A333,
     6       F113,F1A113,F2A113,F133,F1A133,F2A133,
     7       F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8       F1333,FA1333,F1133,FA1133,
     8       RE12 , RE32 , RHOREF , VMIN
C
      REAL*8 ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1      PREC
C
      REAL*8 THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1      THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2      VELLGT , PLANCK , AVOGNO , DEGRAD , RADDEG ,
     3      PI
C
      REAL*8   B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      REAL*8   CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
      INTEGER NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5       NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6       NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7       NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6       ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7       IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8       NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER,
     9       ISOMAX , NATTS  , V0TYPE , IVAR(55) , PARMAX ,
     1       NUMPAR , PRTINT
C
      INTEGER V1 ,V2, V3 , V2MXP1, V2P1,
     1       NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2       NSEPP2 , NSEQP1 , MBASIS ,
     3       MDIM , NFSYM0, NFASY0, NFSYMJ, NFASYJ,
     4       KSTYPA(2) , LSTYPA(2) , JMAX , V2MAX , JMAXP1
C
      INTEGER IQUANT(5,10)
C
      LOGICAL SYMM
C
      REAL*8 RMK(2),AAS(2)
      INTEGER NOBAS,MBASP1,LENIW
      REAL*8 IA(15),IB(15),IO(15),MA(15),MB(15),MO(15),
     1       IA0,IA1,IA3,IA11,IA33,IA13,
     2       IA111,IA333,IA113,IA133,
     3       IA1111,IA3333,IA1113,IA1333,IA1133,
     4       IB0,IB1,IB3,IB11,IB33,IB13,
     5       IB111,IB333,IB113,IB133,
     6       IB1111,IB3333,IB1113,IB1333,IB1133,
     7       IO0,IO1,IO3,IO11,IO33,IO13,
     8       IO111,IO333,IO113,IO133,
     9       IO1111,IO3333,IO1113,IO1333,IO1133
      REAL*8 MA0,MA1,MA3,MA11,MA33,MA13,
     2       MA111,MA333,MA113,MA133,
     3       MA1111,MA3333,MA1113,MA1333,MA1133,
     4       MB0,MB1,MB3,MB11,MB33,MB13,
     5       MB111,MB333,MB113,MB133,
     6       MB1111,MB3333,MB1113,MB1333,MB1133,
     7       MO0,MO1,MO3,MO11,MO33,MO13,
     8       MO111,MO333,MO113,MO133,
     9       MO1111,MO3333,MO1113,MO1333,MO1133
      REAL*8 QA0,QA1,QA3,QA11,QA33,QA13,
     2       QA111,QA333,QA113,QA133,
     3       QA1111,QA3333,QA1113,QA1333,QA1133,
     4       QB0,QB1,QB3,QB11,QB33,QB13,
     5       QB111,QB333,QB113,QB133,
     6       QB1111,QB3333,QB1113,QB1333,QB1133,
     7       QO0,QO1,QO3,QO11,QO33,QO13,
     8       QO111,QO333,QO113,QO133,
     9       QO1111,QO3333,QO1113,QO1333,QO1133
      REAL*8  D,JAA,JBB,JAB
      COMMON /ISOTOP/ IQUANT,AMASS
C
      COMMON /VALUES/ RHO,EPS,EPSP,EPSPP,EPSPPP,
     1               CR,SR,CSE,SNE,CRE,SRE,CORO
C
      COMMON /MOLCUL/ RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1               AA1,AA3,
     2               F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3               F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4               F13,F1A13,F2A13,F3A13,
     5               F111,F1A111,F2A111,F333,F1A333,F2A333,
     6               F113,F1A113,F2A113,F133,F1A133,F2A133,
     7               F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8               F1333,FA1333,F1133,FA1133,
     8               RE12 , RE32 , M1 , M2 , M3 , M ,
     9               U1 , U3 , U13 , V ,
     1               SYMM
C
      COMMON /INTEG/  ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1               RHOREF , VMIN , V0TYPE ,
     1               NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2               NSEPP2 , NSEQP1 , KSTYPA , LSTYPA
C
      COMMON /DIMEN/  MBASIS ,  V2MAX  , V2MXP1 ,
     1               JMAX   , JMAXP1 , MDIM   , NFSYM0 , NFASY0 ,
     2               NFSYMJ , NFASYJ
C
      COMMON /LSFIT/  PARMAX , NUMPAR , ISOMAX , IVAR
C
      COMMON /SYS/    THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1                     THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2                     VELLGT , PLANCK , AVOGNO , PI , PREC ,
     4                     NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5                     NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6                     NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7                     NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6                     ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7                     IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8                     NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER ,
     9                       NATTS , PRTINT
C
      COMMON/BCOEFF/
     1      B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      COMMON/CRCOEF/
     1      CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
C
      COMMON/MORSE/RMK,AAS
      COMMON/MODIM/NOBAS,MBASP1,LENIW
      IA0=IA(1)
      IA1=IA(2)
      IA3=IA(3)
      IA11=IA(4)
      IA33=IA(5)
      IA13=IA(6)
      IA111=IA(7)
      IA333=IA(8)
      IA113=IA(9)
      IA133=IA(10)
      IA1111=IA(11)
      IA3333=IA(12)
      IA1113=IA(13)
      IA1333=IA(14)
      IA1133=IA(15)
      IB0=IB(1)
      IB1=IB(2)
      IB3=IB(3)
      IB11=IB(4)
      IB33=IB(5)
      IB13=IB(6)
      IB111=IB(7)
      IB333=IB(8)
      IB113=IB(9)
      IB133=IB(10)
      IB1111=IB(11)
      IB3333=IB(12)
      IB1113=IB(13)
      IB1333=IB(14)
      IB1133=IB(15)
      IO0=IO(1)
      IO1=IO(2)
      IO3=IO(3)
      IO11=IO(4)
      IO33=IO(5)
      IO13=IO(6)
      IO111=IO(7)
      IO333=IO(8)
      IO113=IO(9)
      IO133=IO(10)
      IO1111=IO(11)
      IO3333=IO(12)
      IO1113=IO(13)
      IO1333=IO(14)
      IO1133=IO(15)
      D=IA0*IB0-IO0*IO0
      JAA=IA0/D
      JBB=IB0/D
      JAB=IO0/D
      MA0=JBB
      MB0=JAA
      MO0=-JAB
      QA1=-(IA1*MA0+MO0*IO1)
      QB1=-(IB1*MB0+MO0*IO1)
      QO1=-(IA1*MO0+MB0*IO1)
      MB1=JAA*QB1-JAB*QO1
      MO1=-JAB*QB1+JBB*QO1
      MA1=(QA1-IO0*MO1)/IA0
      QA3=-(IA3*MA0+MO0*IO3)
      QB3=-(IB3*MB0+MO0*IO3)
      QO3=-(IA3*MO0+MB0*IO3)
      MB3= JAA*QB3- JAB*QO3
      MO3=-JAB*QB3+ JBB*QO3
      MA3=    (QA3-IO0*MO3)/IA0
      QA11=-(IA11*MA0+IA1*MA1+MO1
     1 *IO1+MO0*IO11)
      QB11=-(IB11*MB0+IB1*MB1+MO1
     1 *IO1+MO0*IO11)
      QO11=-(IA11*MO0+IA1*MO1+MB1
     1 *IO1+MB0*IO11)
      MB11= JAA*QB11- JAB*QO11
      MO11=-JAB*QB11+ JBB*QO11
      MA11=    (QA11-IO0*MO11)/IA0
      QA33=-(IA33*MA0+IA3*MA3+MO3
     1 *IO3+MO0*IO33)
      QB33=-(IB33*MB0+IB3*MB3+MO3
     1 *IO3+MO0*IO33)
      QO33=-(IA33*MO0+IA3*MO3+MB3
     1 *IO3+MB0*IO33)
      MB33= JAA*QB33- JAB*QO33
      MO33=-JAB*QB33+ JBB*QO33
      MA33=    (QA33-IO0*MO33)/IA0
      QA13=-(IA13*MA0+IA3*MA1+IA1*MA3+
     1 MO3*IO1+MO1*IO3+MO0*IO13)
      QB13=-(IB13*MB0+IB3*MB1+IB1*MB3+
     1 MO3*IO1+MO1*IO3+MO0*IO13)
      QO13=-(IA13*MO0+IA3*MO1+IA1*MO3+
     1 MB3*IO1+MB1*IO3+MB0*IO13)
      MB13= JAA*QB13- JAB*QO13
      MO13=-JAB*QB13+ JBB*QO13
      MA13=    (QA13-IO0*MO13)/IA0
      QA111=-(IA111*MA0+IA11*MA1+IA1*MA11+
     1 MO11*IO1+MO1*IO11+MO0*IO111)
      QB111=-(IB111*MB0+IB11*MB1+IB1*MB11+
     1 MO11*IO1+MO1*IO11+MO0*IO111)
      QO111=-(IA111*MO0+IA11*MO1+IA1*MO11+
     1 MB11*IO1+MB1*IO11+MB0*IO111)
      MB111= JAA*QB111- JAB*QO111
      MO111=-JAB*QB111+ JBB*QO111
      MA111=    (QA111-IO0*MO111)/IA0
      QA333=-(IA333*MA0+IA33*MA3+IA3*MA33+
     1 MO33*IO3+MO3*IO33+MO0*IO333)
      QB333=-(IB333*MB0+IB33*MB3+IB3*MB33+
     1 MO33*IO3+MO3*IO33+MO0*IO333)
      QO333=-(IA333*MO0+IA33*MO3+IA3*MO33+
     1 MB33*IO3+MB3*IO33+MB0*IO333)
      MB333= JAA*QB333- JAB*QO333
      MO333=-JAB*QB333+ JBB*QO333
      MA333=    (QA333-IO0*MO333)/IA0
      QA113=-(IA113*MA0+IA13*MA1+IA11*MA3+IA3*MA11+
     1 IA1*MA13+MO13*IO1+MO11*
     1 IO3+MO3*IO11+MO1*IO13+MO0*IO113)
      QB113=-(IB113*MB0+IB13*MB1+IB11*MB3+IB3*MB11+
     1 IB1*MB13+MO13*IO1+MO11*
     1 IO3+MO3*IO11+MO1*IO13+MO0*IO113)
      QO113=-(IA113*MO0+IA13*MO1+IA11*MO3+IA3*MO11+
     1 IA1*MO13+MB13*IO1+MB11*
     1 IO3+MB3*IO11+MB1*IO13+MB0*IO113)
      MB113= JAA*QB113- JAB*QO113
      MO113=-JAB*QB113+ JBB*QO113
      MA113=    (QA113-IO0*MO113)/IA0
      QA133=-(IA133*MA0+IA13*MA3+IA33*MA1+IA3*MA13+
     1 IA1*MA33+MO13*IO3+MO33*
     1 IO1+MO3*IO13+MO1*IO33+MO0*IO133)
      QB133=-(IB133*MB0+IB13*MB3+IB33*MB1+IB3*MB13+
     1 IB1*MB33+MO13*IO3+MO33*
     1 IO1+MO3*IO13+MO1*IO33+MO0*IO133)
      QO133=-(IA133*MO0+IA13*MO3+IA33*MO1+IA3*MO13+
     1 IA1*MO33+MB13*IO3+MB33*
     1 IO1+MB3*IO13+MB1*IO33+MB0*IO133)
      MB133= JAA*QB133- JAB*QO133
      MO133=-JAB*QB133+ JBB*QO133
      MA133=    (QA133-IO0*MO133)/IA0
      QA1111=-(IA1111*MA0+IA111*MA1+IA11*MA11+IA1*
     1 MA111+MO111*IO1+MO11*
     1 IO11+MO1*IO111+MO0*IO1111)
      QB1111=-(IB111*MB1+IB11*MB11+IB1*MB111+
     1 MO111*IO1+MO11*IO11+MO1*
     1 IO111+MO0*IO1111+MB0*IB1111)
      QO1111=-(IA1111*MO0+IA111*MO1+IA11*MO11+IA1*
     1 MO111+MB111*IO1+MB11*
     1 IO11+MB1*IO111+MB0*IO1111)
      MB1111= JAA*QB1111- JAB*QO1111
      MO1111=-JAB*QB1111+ JBB*QO1111
      MA1111=    (QA1111-IO0*MO1111)/IA0
      QA3333=-(IA3333*MA0+IA333*MA3+IA33*MA33+IA3*
     1 MA333+MO333*IO3+MO33*
     1 IO33+MO3*IO333+MO0*IO3333)
      QB3333=-(IB333*MB3+IB33*MB33+IB3*MB333+
     1 MO333*IO3+MO33*IO33+MO3*
     1 IO333+MO0*IO3333+MB0*IB3333)
      QO3333=-(IA3333*MO0+IA333*MO3+IA33*MO33+IA3*
     1 MO333+MB333*IO3+MB33*
     1 IO33+MB3*IO333+MB0*IO3333)
      MB3333= JAA*QB3333- JAB*QO3333
      MO3333=-JAB*QB3333+ JBB*QO3333
      MA3333=    (QA3333-IO0*MO3333)/IA0
      QA1113=-(IA1113*MA0+IA113*MA1+IA111*MA3+IA13*
     1 MA11+IA11*MA13+IA3*MA111+IA1*MA113+
     1 MO113*IO1+MO111*IO3+MO13*
     1 IO11+MO11*IO13+MO3*IO111+MO1*IO113+MO0*
     1 IO1113)
      QB1113=-(IB113*MB1+IB111*MB3+IB13*MB11+IB11*
     1 MB13+IB3*MB111+IB1*MB113+
     1 MO113*IO1+MO111*IO3+MO13*IO11+MO11*IO13+
     1 MO3*IO111+MO1*IO113+MO0*IO1113+MB0*IB1113)
      QO1113=-(IA1113*MO0+IA113*MO1+IA111*MO3+IA13*
     1 MO11+IA11*MO13+IA3*MO111+IA1*MO113+
     1 MB113*IO1+MB111*IO3+MB13*
     1 IO11+MB11*IO13+MB3*IO111+MB1*IO113+MB0*
     1 IO1113)
      MB1113= JAA*QB1113- JAB*QO1113
      MO1113=-JAB*QB1113+ JBB*QO1113
      MA1113=    (QA1113-IO0*MO1113)/IA0
      QA1333=-(IA1333*MA0+IA133*MA3+IA333*MA1+IA13*
     1 MA33+IA33*MA13+IA3*MA133+IA1*MA333+
     1 MO133*IO3+MO333*IO1+MO13*
     1 IO33+MO33*IO13+MO3*IO133+MO1*IO333+MO0*
     1 IO1333)
      QB1333=-(IB133*MB3+IB333*MB1+IB13*MB33+IB33*
     1 MB13+IB3*MB133+IB1*MB333+
     1 MO133*IO3+MO333*IO1+MO13*IO33+MO33*IO13+
     1 MO3*IO133+MO1*IO333+MO0*IO1333+MB0*IB1333)
      QO1333=-(IA1333*MO0+IA133*MO3+IA333*MO1+IA13*
     1 MO33+IA33*MO13+IA3*MO133+IA1*MO333+
     1 MB133*IO3+MB333*IO1+MB13*
     1 IO33+MB33*IO13+MB3*IO133+MB1*IO333+MB0*
     1 IO1333)
      MB1333= JAA*QB1333- JAB*QO1333
      MO1333=-JAB*QB1333+ JBB*QO1333
      MA1333=    (QA1333-IO0*MO1333)/IA0
      QA1133=-(IA1133*MA0+IA133*MA1+IA113*MA3+IA13*
     1 MA13+IA33*MA11+IA11*MA33+IA3*MA113+IA1*
     1 MA133+MO133*IO1+MO113*
     1 IO3+MO13*IO13+MO33*IO11+MO11*IO33+MO3*IO113+
     1 MO1*IO133+MO0*IO1133)
      QB1133=-(IB133*MB1+IB113*MB3+IB13*MB13+IB33*
     1 MB11+IB11*MB33+IB3*MB113+IB1*MB133+
     1 MO133*IO1+MO113*IO3+MO13*
     1 IO13+MO33*IO11+MO11*IO33+MO3*IO113+MO1*IO133
     1 +MO0*IO1133+MB0*IB1133)
      QO1133=-(IA1133*MO0+IA133*MO1+IA113*MO3+IA13*
     1 MO13+IA33*MO11+IA11*MO33+IA3*MO113+IA1*
     1 MO133+MB133*IO1+MB113*
     1 IO3+MB13*IO13+MB33*IO11+MB11*IO33+MB3*IO113+
     1 MB1*IO133+MB0*IO1133)
      MB1133= JAA*QB1133- JAB*QO1133
      MO1133=-JAB*QB1133+ JBB*QO1133
      MA1133=    (QA1133-IO0*MO1133)/IA0
      MA(1)=MA0
      MA(2)=MA1
      MA(3)=MA3
      MA(4)=MA11
      MA(5)=MA33
      MA(6)=MA13
      MA(7)=MA111
      MA(8)=MA333
      MA(9)=MA113
      MA(10)=MA133
      MA(11)=MA1111
      MA(12)=MA3333
      MA(13)=MA1113
      MA(14)=MA1333
      MA(15)=MA1133
      MB(1)=MB0
      MB(2)=MB1
      MB(3)=MB3
      MB(4)=MB11
      MB(5)=MB33
      MB(6)=MB13
      MB(7)=MB111
      MB(8)=MB333
      MB(9)=MB113
      MB(10)=MB133
      MB(11)=MB1111
      MB(12)=MB3333
      MB(13)=MB1113
      MB(14)=MB1333
      MB(15)=MB1133
      MO(1)=MO0
      MO(2)=MO1
      MO(3)=MO3
      MO(4)=MO11
      MO(5)=MO33
      MO(6)=MO13
      MO(7)=MO111
      MO(8)=MO333
      MO(9)=MO113
      MO(10)=MO133
      MO(11)=MO1111
      MO(12)=MO3333
      MO(13)=MO1113
      MO(14)=MO1333
      MO(15)=MO1133
      RETURN
      END
C
C
      SUBROUTINE MUPV ( MUEX , P1EX , P3EX , MUPEX1 , MUPEX3 )
      IMPLICIT REAL*8 (A-H,O-Z)
C            :
C DATE       : 23.05.1986
C AUTHOR     : PER JENSEN
C UPDATES    :
C LANGUAGE   : FORTRAN
C PURPOSE    : CALCULATION OF THE EXPANSION COEFFICIENTS IN THE CORIOLIS
C            : TERMS IN THE MORBID HAMILTONIAN.
C            : THE CODE IS GENERATED BY REDUCE.
C            :
      REAL*8 M1,M2,M3,M,U1,U3,U13,V,RHO,EPS,
     1      CR,SR,CSE,SNE,
     2      CRE,SRE,CORO,EPSP,EPSPP,EPSPPP
C
      REAL*8 AMASS(3,10)
C
      REAL*8 RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1       AA1,AA3,
     2       F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3       F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4       F13,F1A13,F2A13,F3A13,
     5       F111,F1A111,F2A111,F333,F1A333,F2A333,
     6       F113,F1A113,F2A113,F133,F1A133,F2A133,
     7       F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8       F1333,FA1333,F1133,FA1133,
     8       RE12 , RE32 , RHOREF , VMIN
C
      REAL*8 ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1      PREC
C
      REAL*8 THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1      THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2      VELLGT , PLANCK , AVOGNO , DEGRAD , RADDEG ,
     3      PI
C
      REAL*8   B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      REAL*8   CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
      INTEGER NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5       NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6       NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7       NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6       ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7       IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8       NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER,
     9       ISOMAX , NATTS  , V0TYPE , IVAR(55) , PARMAX ,
     1       NUMPAR , PRTINT
C
      INTEGER V1 ,V2, V3 , V2MXP1, V2P1,
     1       NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2       NSEPP2 , NSEQP1 , MBASIS ,
     3       MDIM , NFSYM0, NFASY0, NFSYMJ, NFASYJ,
     4       KSTYPA(2) , LSTYPA(2) , JMAX , V2MAX , JMAXP1
C
      INTEGER IQUANT(5,10)
C
      LOGICAL SYMM
C
      REAL*8 RMK(2),AAS(2)
      INTEGER NOBAS,MBASP1,LENIW
      REAL*8 MUEX(15),P1EX(15),P3EX(15),MUPEX1(15),MUPEX3(15),
     1      MU0,MU1,MU3,MU11,MU33,MU13,
     2      PV11,PV13,PV111,PV133,PV113,PV1111,PV1333,PV1113,PV1133,
     3      PV31,PV33,PV311,PV333,PV313,PV3111,PV3333,PV3113,PV3133,
     4      Q11,Q13,Q111,Q133,Q113,Q1111,Q1333,Q1113,Q1133,
     5      Q31,Q33,Q311,Q333,Q313,Q3111,Q3333,Q3113,Q3133
      COMMON /ISOTOP/ IQUANT,AMASS
C
      COMMON /VALUES/ RHO,EPS,EPSP,EPSPP,EPSPPP,
     1               CR,SR,CSE,SNE,CRE,SRE,CORO
C
      COMMON /MOLCUL/ RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1               AA1,AA3,
     2               F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3               F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4               F13,F1A13,F2A13,F3A13,
     5               F111,F1A111,F2A111,F333,F1A333,F2A333,
     6               F113,F1A113,F2A113,F133,F1A133,F2A133,
     7               F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8               F1333,FA1333,F1133,FA1133,
     8               RE12 , RE32 , M1 , M2 , M3 , M ,
     9               U1 , U3 , U13 , V ,
     1               SYMM
C
      COMMON /INTEG/  ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1               RHOREF , VMIN , V0TYPE ,
     1               NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2               NSEPP2 , NSEQP1 , KSTYPA , LSTYPA
C
      COMMON /DIMEN/  MBASIS ,  V2MAX  , V2MXP1 ,
     1               JMAX   , JMAXP1 , MDIM   , NFSYM0 , NFASY0 ,
     2               NFSYMJ , NFASYJ
C
      COMMON /LSFIT/  PARMAX , NUMPAR , ISOMAX , IVAR
C
      COMMON /SYS/    THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1                     THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2                     VELLGT , PLANCK , AVOGNO , PI , PREC ,
     4                     NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5                     NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6                     NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7                     NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6                     ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7                     IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8                     NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER ,
     9                       NATTS , PRTINT
C
      COMMON/BCOEFF/
     1      B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      COMMON/CRCOEF/
     1      CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
C
      COMMON/MORSE/RMK,AAS
      COMMON/MODIM/NOBAS,MBASP1,LENIW
      MU0=MUEX(1)
      MU1=MUEX(2)
      MU3=MUEX(3)
      MU11=MUEX(4)
      MU33=MUEX(5)
      MU13=MUEX(6)
      PV11=P1EX(2)
      PV13=P1EX(3)
      PV111=P1EX(4)
      PV133=P1EX(5)
      PV113=P1EX(6)
      PV1111=P1EX(7)
      PV1333=P1EX(8)
      PV1113=P1EX(9)
      PV1133=P1EX(10)
      PV31=P3EX(2)
      PV33=P3EX(3)
      PV311=P3EX(4)
      PV333=P3EX(5)
      PV313=P3EX(6)
      PV3111=P3EX(7)
      PV3333=P3EX(8)
      PV3113=P3EX(9)
      PV3133=P3EX(10)
      Q11=PV11*MU0
      Q13=PV13*MU0
      Q111=PV111*MU0+PV11*MU1
      Q133=PV133*MU0+PV13*MU3
      Q113=PV113*MU0+PV13*MU1+PV11*MU3
      Q1111=PV1111*MU0+PV111*MU1+PV11*MU11
      Q1333=PV1333*MU0+PV133*MU3+PV13*MU33
      Q1113=PV1113*MU0+PV113*MU1+PV111*MU3+PV13*MU11+PV11*MU13
      Q1133=PV1133*MU0+PV113*MU3+PV133*MU1+PV13*MU13+PV11*MU33
      Q31=PV31*MU0
      Q33=PV33*MU0
      Q311=PV311*MU0+PV31*MU1
      Q333=PV333*MU0+PV33*MU3
      Q313=PV313*MU0+PV33*MU1+PV31*MU3
      Q3111=PV3111*MU0+PV311*MU1+PV31*MU11
      Q3333=PV3333*MU0+PV333*MU3+PV33*MU33
      Q3113=PV3113*MU0+PV313*MU1+PV311*MU3+PV33*MU11+PV31*MU13
      Q3133=PV3133*MU0+PV313*MU3+PV333*MU1+PV33*MU13+PV31*MU33
      MUPEX1(1)=0.0E0
      MUPEX1(2)=Q11
      MUPEX1(3)=Q13
      MUPEX1(4)=Q111
      MUPEX1(5)=Q133
      MUPEX1(6)=Q113
      MUPEX1(7)=Q1111
      MUPEX1(8)=Q1333
      MUPEX1(9)=Q1113
      MUPEX1(10)=Q1133
      MUPEX3(1)=0.0E0
      MUPEX3(2)=Q31
      MUPEX3(3)=Q33
      MUPEX3(4)=Q311
      MUPEX3(5)=Q333
      MUPEX3(6)=Q313
      MUPEX3(7)=Q3111
      MUPEX3(8)=Q3333
      MUPEX3(9)=Q3113
      MUPEX3(10)=Q3133
      RETURN
      END
C
C
      SUBROUTINE TRNSPT ( VCOEF )
      IMPLICIT REAL*8 (A-H,O-Z)
C             :
C DATE        : 24.04.1986
C AUTHOR      : PER JENSEN
C UPDATES     :
C LANGUAGE    : FORTRAN
C PURPOSE     : TRANSFORMATION OF THE BEND-STRETCH POTENTIAL FROM RHO
C             : BAR DEPENDENT FORM TO RHO DEPENDENT FORM.
C             : EXPANSION COEFFICIENTS OF Y SUB I'S ARE CALCULATED.
C             : THE CODE IS GENERATED BY REDUCE.
C SUBPROGRAMS :
C      CALLED :
C             :
C INPUT       : RHO  INSTANTANEOUS VALUE OF THE BENDING COORDINATE
C             :
C OUTPUT      : VCOEF(1:15)  EXPANSION COEFFICIENTS OF THE BEND-STRETCH
C             :              POTENTIAL ENERGY FUNCTION IN TERMS OF THE
C             :              YI PARAMETERS.
C             :
C             :
C    THE ARRAY CONTAINS THE COEFFICIENTS OF THE FOLLOWING
C    QUANTITIES:
C
C    I             VCOEF(I)
C  -------------------------------------------------------------
C    1             1
C    2             Y1
C    3             Y3
C    4             Y1**2
C    5             Y3**2
C    6             Y1*Y3
C    7             Y1**3
C    8             Y3**3
C    9             Y1**2*Y3
C   10             Y1*Y3**2
C   11             Y1**4
C   12             Y3**4
C   13             Y1**3*Y3
C   14             Y1*Y3**3
C   15             Y1**2*Y3**2
C
      REAL*8 M1,M2,M3,M,U1,U3,U13,V,RHO,EPS,
     1      CR,SR,CSE,SNE,
     2      CRE,SRE,CORO,EPSP,EPSPP,EPSPPP
C
      REAL*8 AMASS(3,10)
C
      REAL*8 RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1       AA1,AA3,
     2       F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3       F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4       F13,F1A13,F2A13,F3A13,
     5       F111,F1A111,F2A111,F333,F1A333,F2A333,
     6       F113,F1A113,F2A113,F133,F1A133,F2A133,
     7       F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8       F1333,FA1333,F1133,FA1133,
     8       RE12 , RE32 , RHOREF , VMIN
C
      REAL*8 ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1      PREC
C
      REAL*8 THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1      THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2      VELLGT , PLANCK , AVOGNO , DEGRAD , RADDEG ,
     3      PI
C
      REAL*8   B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      REAL*8   CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
      INTEGER NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5       NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6       NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7       NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6       ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7       IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8       NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER,
     9       ISOMAX , NATTS  , V0TYPE , IVAR(55) , PARMAX ,
     1       NUMPAR , PRTINT
C
      INTEGER V1 ,V2, V3 , V2MXP1, V2P1,
     1       NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2       NSEPP2 , NSEQP1 , MBASIS ,
     3       MDIM , NFSYM0, NFASY0, NFSYMJ, NFASYJ,
     4       KSTYPA(2) , LSTYPA(2) , JMAX , V2MAX , JMAXP1
C
      INTEGER IQUANT(5,10)
C
      LOGICAL SYMM
C
      REAL*8 RMK(2),AAS(2)
      INTEGER NOBAS,MBASP1,LENIW
      REAL*8 CORO2,CORO3,
     1      Q1,Q3,Q11,Q33,Q13,Q111,Q333,Q113,Q133,
     2      Q1111,Q3333,Q1113,Q1333,Q1133,
     3      ANS1,ANS2,ANS3,VCOEF(15)
      COMMON /ISOTOP/ IQUANT,AMASS
C
      COMMON /VALUES/ RHO,EPS,EPSP,EPSPP,EPSPPP,
     1               CR,SR,CSE,SNE,CRE,SRE,CORO
C
      COMMON /MOLCUL/ RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1               AA1,AA3,
     2               F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3               F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4               F13,F1A13,F2A13,F3A13,
     5               F111,F1A111,F2A111,F333,F1A333,F2A333,
     6               F113,F1A113,F2A113,F133,F1A133,F2A133,
     7               F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8               F1333,FA1333,F1133,FA1133,
     8               RE12 , RE32 , M1 , M2 , M3 , M ,
     9               U1 , U3 , U13 , V ,
     1               SYMM
C
      COMMON /INTEG/  ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1               RHOREF , VMIN , V0TYPE ,
     1               NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2               NSEPP2 , NSEQP1 , KSTYPA , LSTYPA
C
      COMMON /DIMEN/  MBASIS ,  V2MAX  , V2MXP1 ,
     1               JMAX   , JMAXP1 , MDIM   , NFSYM0 , NFASY0 ,
     2               NFSYMJ , NFASYJ
C
      COMMON /LSFIT/  PARMAX , NUMPAR , ISOMAX , IVAR
C
      COMMON /SYS/    THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1                     THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2                     VELLGT , PLANCK , AVOGNO , PI , PREC ,
     4                     NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5                     NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6                     NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7                     NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6                     ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7                     IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8                     NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER ,
     9                       NATTS , PRTINT
C
      COMMON/BCOEFF/
     1      B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      COMMON/CRCOEF/
     1      CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
C
      COMMON/MORSE/RMK,AAS
      COMMON/MODIM/NOBAS,MBASP1,LENIW
      CORO2=CORO*CORO
      CORO3=CORO2*CORO
      Q1=CORO*(CORO3*F4A1+CORO2*F3A1+CORO*F2A1+F1A1)
      Q3=CORO*(CORO3*F4A3+CORO2*F3A3+CORO*F2A3+F1A3)
      Q11=(CORO3*(4.E0*CR1*F4A1+F3A11*AA1)+CORO2*(3.E0*CR1*F3A1+
     1 F2A11*AA1)+CORO*(2.E0*CR1*F2A1+F1A11*AA1)+CR1*F1A1+F11*AA1)
     1 /AA1
      Q33=(CORO3*(4.E0*CR3*F4A3+F3A33*AA3)+CORO2*(3.E0*CR3*F3A3+
     1 F2A33*AA3)+CORO*(2.E0*CR3*F2A3+F1A33*AA3)+CR3*F1A3+F33*AA3)
     1 /AA3
      Q13=(CORO3*(4.E0*CR3*F4A1*AA1+4.E0*CR1*F4A3*AA3+F3A13*AA3*
     1 AA1)+CORO2*(3.E0*CR3*F3A1*AA1+3.E0*CR1*F3A3*AA3+F2A13*AA3*
     1 AA1)+CORO*(2.E0*CR3*F2A1*AA1+2.E0*CR1*F2A3*AA3+F1A13*AA3*AA1)
     1 +CR3*F1A1*AA1+CR1*F1A3*AA3+F13*AA3*AA1)/(AA3*AA1)
      Q111=(4.E0*CORO3*F4A1*(2.E0*CR11+CR1*AA1)+CORO2*(6.E0*CR11*
     1 F3A1+12.E0*CR1**2*F4A1+6.E0*CR1*F3A11*AA1+3.E0*CR1*F3A1*AA1+2.E0*
     1 F2A111*AA1**2)+2.E0*CORO*(2.E0*CR11*F2A1+3.E0*CR1**2*F3A1+2.E0*
     1 CR1*F2A11*AA1+CR1*F2A1*AA1+F1A111*AA1**2)+2.E0*CR11*F1A1+2.E0
     1 *CR1**2*F2A1+2.E0*CR1*F1A11*AA1+CR1*F1A1*AA1+2.E0*F111*AA1**2
     1 )/(2.E0*AA1**2)
      Q333=(4.E0*CORO3*F4A3*(2.E0*CR33+CR3*AA3)+CORO2*(6.E0*CR33*
     1 F3A3+12.E0*CR3**2*F4A3+3.E0*CR3*F3A3*AA3+6.E0*CR3*F3A33*AA3+2.E0*
     1 F2A333*AA3**2)+2.E0*CORO*(2.E0*CR33*F2A3+3.E0*CR3**2*F3A3+CR3*
     1 F2A3*AA3+2.E0*CR3*F2A33*AA3+F1A333*AA3**2)+2.E0*CR33*F1A3+2.E0*
     1 CR3**2*F2A3+CR3*F1A3*AA3+2.E0*CR3*F1A33*AA3+2.E0*F333*AA3**2)
     1 /(2.E0*AA3**2)
      Q113=(4.E0*CORO3*(2.E0*CR13*F4A1*AA1+2.E0*CR11*F4A3*AA3+CR1*
     1 F4A3*AA3*AA1)+CORO2*(6.E0*CR13*F3A1*AA1+6.E0*CR11*F3A3*AA3+
     1 24.E0*CR3*CR1*F4A1*AA1+6.E0*CR3*F3A11*AA1**2+12.E0*CR1**2*F4A3*
     1 AA3+6.E0*CR1*F3A13*AA3*AA1+3.E0*CR1*F3A3*AA3*AA1+2.E0*AA3*
     1 F2A113*AA1**2)+2.E0*CORO*(2.E0*CR13*F2A1*AA1+2.E0*CR11*F2A3*AA3
     1 +6.E0*CR3*CR1*F3A1*AA1+2.E0*CR3*F2A11*AA1**2+3.E0*CR1**2*F3A3*
     1 AA3+2.E0*CR1*F2A13*AA3*AA1+CR1*F2A3*AA3*AA1+AA3*F1A113*AA1
     1 **2)+2.E0*CR13*F1A1*AA1+2.E0*CR11*F1A3*AA3+4.E0*CR3*CR1*F2A1*
     1 AA1+2.E0*CR3*F1A11*AA1**2+2.E0*CR1**2*F2A3*AA3+2.E0*CR1*F1A13*
     1 AA3*AA1+CR1*F1A3*AA3*AA1+2.E0*AA3*F113*AA1**2)/(2.E0*AA3*AA1
     1 **2)
      Q133=(4.E0*CORO3*(2.E0*CR13*F4A3*AA3+2.E0*CR33*F4A1*AA1+CR3*
     1 F4A1*AA3*AA1)+CORO2*(6.E0*CR13*F3A3*AA3+6.E0*CR33*F3A1*AA1+
     1 12.E0*CR3**2*F4A1*AA1+24.E0*CR3*CR1*F4A3*AA3+6.E0*CR3*F3A13*AA3*
     1 AA1+3.E0*CR3*F3A1*AA3*AA1+6.E0*CR1*F3A33*AA3**2+2.E0*F2A133*AA3
     1 **2*AA1)+2.E0*CORO*(2.E0*CR13*F2A3*AA3+2.E0*CR33*F2A1*AA1+3.E0*
     1 CR3**2*F3A1*AA1+6.E0*CR3*CR1*F3A3*AA3+2.E0*CR3*F2A13*AA3*AA1+
     1 CR3*F2A1*AA3*AA1+2.E0*CR1*F2A33*AA3**2+F1A133*AA3**2*AA1)+
     1 2.E0*CR13*F1A3*AA3+2.E0*CR33*F1A1*AA1+2.E0*CR3**2*F2A1*AA1+4.E0*
     1 CR3*CR1*F2A3*AA3+2.E0*CR3*F1A13*AA3*AA1+CR3*F1A1*AA3*AA1+2.E0
     1 *CR1*F1A33*AA3**2+2.E0*F133*AA3**2*AA1)/(2.E0*AA3**2*AA1)
      Q1111=(8.E0*CORO3*F4A1*(3.E0*CR111+3.E0*CR11*AA1+CR1*AA1**2)+
     1 3.E0*CORO2*(6.E0*CR111*F3A1+24.E0*CR11*CR1*F4A1
     1 +6.E0*CR11*F3A11*
     1 AA1+6.E0*CR11*F3A1*AA1+12.E0*CR1**2*F4A1*AA1+3.E0*CR1*F3A11*AA1
     1 **2+2.E0*CR1*F3A1*AA1**2)+2.E0*CORO*(6.E0*CR111*F2A1+18.E0*CR11*
     1 CR1*F3A1+6.E0*CR11*F2A11*AA1+6.E0*CR11*F2A1*AA1+12.E0*CR1**3*
     1 F4A1+9.E0*CR1**2*F3A11*AA1+9.E0*CR1**2*F3A1*AA1+3.E0*CR1*F2A11*
     1 AA1**2+6.E0*CR1*F2A111*AA1**2+2.E0*CR1*F2A1*AA1**2+3.E0*FA1111
     1 *AA1**3)+6.E0*CR111*F1A1+12.E0*CR11*CR1*F2A1+6.E0*CR11*F1A11*
     1 AA1+6.E0*CR11*F1A1*AA1+6.E0*CR1**3*F3A1+6.E0*CR1**2*F2A11*AA1+
     1 6.E0*CR1**2*F2A1*AA1+3.E0*CR1*F1A11*AA1**2+6.E0*CR1*F1A111*AA1**
     1 2+2.E0*CR1*F1A1*AA1**2+6.E0*F1111*AA1**3)/(6.E0*AA1**3)
      Q3333=(8.E0*CORO3*F4A3*(3.E0*CR333+3.E0*CR33*AA3+CR3*AA3**2)+
     1 3.E0*CORO2*(6.E0*CR333*F3A3+24.E0*CR33*CR3*F4A3+6.E0*CR33*F3A3*
     1 AA3+6.E0*CR33*F3A33*AA3+12.E0*CR3**2*F4A3*AA3+2.E0*CR3*F3A3*AA3
     1 **2+3.E0*CR3*F3A33*AA3**2)+2.E0*CORO*(6.E0*CR333*F2A3+18.E0*CR33*
     1 CR3*F3A3+6.E0*CR33*F2A3*AA3+6.E0*CR33*F2A33*AA3+12.E0*CR3**3*
     1 F4A3+9.E0*CR3**2*F3A3*AA3+9.E0*CR3**2*F3A33*AA3+6.E0*CR3*F2A333
     1 *AA3**2+2.E0*CR3*F2A3*AA3**2+3.E0*CR3*F2A33*AA3**2+3.E0*FA3333
     1 *AA3**3)+6.E0*CR333*F1A3+12.E0*CR33*CR3*F2A3+6.E0*CR33*F1A3*AA3
     1 +6.E0*CR33*F1A33*AA3+6.E0*CR3**3*F3A3+6.E0*CR3**2*F2A3*AA3+6.E0*
     1 CR3**2*F2A33*AA3+6.E0*CR3*F1A333*AA3**2+2.E0*CR3*F1A3*AA3**2+
     1 3.E0*CR3*F1A33*AA3**2+6.E0*F3333*AA3**3)/(6.E0*AA3**3)
      ANS2=18.E0*CR3*CR1**2*F3A1*AA1+12.E0*CR3*CR1*F2A11*AA1**2+6.E0*
     1 CR3*CR1*F2A1*AA1**2+6.E0*CR3*F1A111*AA1**3+6.E0*CR1**3*F3A3*
     1 AA3+6.E0*CR1**2*F2A13*AA3*AA1+6.E0*CR1**2*F2A3*AA3*AA1+3.E0*CR1
     1 *F1A13*AA3*AA1**2+2.E0*CR1*F1A3*AA3*AA1**2+6.E0*CR1*AA3*
     1 F1A113*AA1**2+6.E0*F1113*AA3*AA1**3
      ANS1=4.E0*CORO3*(6.E0*CR113*F4A1*AA1+6.E0*CR111*F4A3*AA3+3.E0*
     1 CR13*F4A1*AA1**2+6.E0*CR11*F4A3*AA3*AA1+2.E0*CR1*F4A3*AA3*AA1
     1 **2)+3.E0*CORO2*(6.E0*CR113*F3A1*AA1+6.E0*CR111*F3A3*AA3+24.E0*
     1 CR13*CR1*F4A1*AA1+6.E0*CR13*F3A11*AA1**2+3.E0*CR13*F3A1*AA1**
     1 2+24.E0*CR11*CR3*F4A1*AA1+24.E0*CR11*CR1*F4A3*AA3+6.E0*CR11*
     1 F3A13*AA3*AA1+6.E0*CR11*F3A3*AA3*AA1+12.E0*CR3*CR1*F4A1*AA1**
     1 2+12.E0*CR1**2*F4A3*AA3*AA1+3.E0*CR1*F3A13*AA3*AA1**2+2.E0*CR1*
     1 F3A3*AA3*AA1**2)+2.E0*CORO*(6.E0*CR113*F2A1*AA1+6.E0*CR111*F2A3
     1 *AA3+18.E0*CR13*CR1*F3A1*AA1+6.E0*CR13*F2A11*AA1**2+3.E0*CR13*
     1 F2A1*AA1**2+18.E0*CR11*CR3*F3A1*AA1+18.E0*CR11*CR1*F3A3*AA3+
     1 6.E0*CR11*F2A13*AA3*AA1+6.E0*CR11*F2A3*AA3*AA1+36.E0*CR3*CR1**2*
     1 F4A1*AA1+18.E0*CR3*CR1*F3A11*AA1**2+9.E0*CR3*CR1*F3A1*AA1**2+
     1 6.E0*CR3*F2A111*AA1**3+12.E0*CR1**3*F4A3*AA3+9.E0*CR1**2*F3A13*
     1 AA3*AA1+9.E0*CR1**2*F3A3*AA3*AA1+3.E0*CR1*F2A13*AA3*AA1**2+2.E0
     1 *CR1*F2A3*AA3*AA1**2+6.E0*CR1*AA3*F2A113*AA1**2+3.E0*FA1113*
     1 AA3*AA1**3)+6.E0*CR113*F1A1*AA1+6.E0*CR111*F1A3*AA3+12.E0*CR13*
     1 CR1*F2A1*AA1+6.E0*CR13*F1A11*AA1**2+3.E0*CR13*F1A1*AA1**2+12.E0
     1 *CR11*CR3*F2A1*AA1+12.E0*CR11*CR1*F2A3*AA3+6.E0*CR11*F1A13*
     1 AA3*AA1+6.E0*CR11*F1A3*AA3*AA1+ANS2
      Q1113=ANS1/(6.E0*AA3*AA1**3)
      ANS2=6.E0*CR3**3*F3A1*AA1+18.E0*CR3**2*CR1*F3A3*AA3+6.E0*CR3**2*
     1 F2A13*AA3*AA1+6.E0*CR3**2*F2A1*AA3*AA1+6.E0*CR3*CR1*F2A3*AA3
     1 **2+12.E0*CR3*CR1*F2A33*AA3**2+3.E0*CR3*F1A13*AA3**2*AA1+6.E0*
     1 CR3*F1A133*AA3**2*AA1+2.E0*CR3*F1A1*AA3**2*AA1+6.E0*CR1*
     1 F1A333*AA3**3+6.E0*F1333*AA3**3*AA1
      ANS1=4.E0*CORO3*(6.E0*CR133*F4A3*AA3+6.E0*CR333*F4A1*AA1+3.E0*
     1 CR13*F4A3*AA3**2+6.E0*CR33*F4A1*AA3*AA1+2.E0*CR3*F4A1*AA3**2*
     1 AA1)+3.E0*CORO2*(6.E0*CR133*F3A3*AA3+6.E0*CR333*F3A1*AA1+24.E0*
     1 CR13*CR3*F4A3*AA3+3.E0*CR13*F3A3*AA3**2+6.E0*CR13*F3A33*AA3**
     1 2+24.E0*CR33*CR3*F4A1*AA1+24.E0*CR33*CR1*F4A3*AA3+6.E0*CR33*
     1 F3A13*AA3*AA1+6.E0*CR33*F3A1*AA3*AA1+12.E0*CR3**2*F4A1*AA3*
     1 AA1+12.E0*CR3*CR1*F4A3*AA3**2+3.E0*CR3*F3A13*AA3**2*AA1+2.E0*
     1 CR3*F3A1*AA3**2*AA1)+2.E0*CORO*(6.E0*CR133*F2A3*AA3+6.E0*CR333*
     1 F2A1*AA1+18.E0*CR13*CR3*F3A3*AA3+3.E0*CR13*F2A3*AA3**2+6.E0*
     1 CR13*F2A33*AA3**2+18.E0*CR33*CR3*F3A1*AA1+18.E0*CR33*CR1*F3A3
     1 *AA3+6.E0*CR33*F2A13*AA3*AA1+6.E0*CR33*F2A1*AA3*AA1+12.E0*CR3**
     1 3*F4A1*AA1+36.E0*CR3**2*CR1*F4A3*AA3+9.E0*CR3**2*F3A13*AA3*
     1 AA1+9.E0*CR3**2*F3A1*AA3*AA1+9.E0*CR3*CR1*F3A3*AA3**2+18.E0*CR3
     1 *CR1*F3A33*AA3**2+3.E0*CR3*F2A13*AA3**2*AA1+6.E0*CR3*F2A133*
     1 AA3**2*AA1+2.E0*CR3*F2A1*AA3**2*AA1+6.E0*CR1*F2A333*AA3**3+3.E0
     1 *FA1333*AA3**3*AA1)+6.E0*CR133*F1A3*AA3+6.E0*CR333*F1A1*AA1+
     1 12.E0*CR13*CR3*F2A3*AA3+3.E0*CR13*F1A3*AA3**2+6.E0*CR13*F1A33*
     1 AA3**2+12.E0*CR33*CR3*F2A1*AA1+12.E0*CR33*CR1*F2A3*AA3+6.E0*
     1 CR33*F1A13*AA3*AA1+6.E0*CR33*F1A1*AA3*AA1+ANS2
      Q1333=ANS1/(6.E0*AA3**3*AA1)
      ANS2=4.E0*CR33*CR1*F2A1*AA1+2.E0*CR33*F1A11*AA1**2+4.E0*CR11*CR3
     1 *F2A3*AA3+2.E0*CR11*F1A33*AA3**2+6.E0*CR3**2*CR1*F3A1*AA1+2.E0*
     1 CR3**2*F2A11*AA1**2+6.E0*CR3*CR1**2*F3A3*AA3+4.E0*CR3*CR1*
     1 F2A13*AA3*AA1+2.E0*CR3*CR1*F2A3*AA3*AA1+2.E0*CR3*CR1*F2A1*AA3
     1 *AA1+CR3*F1A11*AA3*AA1**2+2.E0*CR3*AA3*F1A113*AA1**2+2.E0*CR1
     1 **2*F2A33*AA3**2+2.E0*CR1*F1A133*AA3**2*AA1+CR1*F1A33*AA3**
     1 2*AA1+2.E0*F1133*AA3**2*AA1**2
      ANS1=4.E0*CORO3*(2.E0*CR133*F4A1*AA1+2.E0*CR113*F4A3*AA3+CR13*
     1 F4A3*AA3*AA1+CR13*F4A1*AA3*AA1)+3.E0*CORO2*(2.E0*CR133*F3A1
     1 *AA1+2.E0*CR113*F3A3*AA3+8.E0*CR13*CR3*F4A1*AA1+8.E0*CR13*CR1*
     1 F4A3*AA3+2.E0*CR13*F3A13*AA3*AA1+CR13*F3A3*AA3*AA1+CR13*
     1 F3A1*AA3*AA1+8.E0*CR33*CR1*F4A1*AA1+2.E0*CR33*F3A11*AA1**2+8.E0
     1 *CR11*CR3*F4A3*AA3+2.E0*CR11*F3A33*AA3**2+4.E0*CR3*CR1*F4A3*
     1 AA3*AA1+4.E0*CR3*CR1*F4A1*AA3*AA1+CR3*F3A11*AA3*AA1**2+CR1*
     1 F3A33*AA3**2*AA1)+2.E0*CORO*(2.E0*CR133*F2A1*AA1+2.E0*CR113*
     1 F2A3*AA3+6.E0*CR13*CR3*F3A1*AA1+6.E0*CR13*CR1*F3A3*AA3+2.E0*
     1 CR13*F2A13*AA3*AA1+CR13*F2A3*AA3*AA1+CR13*F2A1*AA3*AA1+6.E0
     1 *CR33*CR1*F3A1*AA1+2.E0*CR33*F2A11*AA1**2+6.E0*CR11*CR3*F3A3*
     1 AA3+2.E0*CR11*F2A33*AA3**2+12.E0*CR3**2*CR1*F4A1*AA1+3.E0*CR3**
     1 2*F3A11*AA1**2+12.E0*CR3*CR1**2*F4A3*AA3+6.E0*CR3*CR1*F3A13*
     1 AA3*AA1+3.E0*CR3*CR1*F3A3*AA3*AA1+3.E0*CR3*CR1*F3A1*AA3*AA1+
     1 CR3*F2A11*AA3*AA1**2+2.E0*CR3*AA3*F2A113*AA1**2+3.E0*CR1**2*
     1 F3A33*AA3**2+2.E0*CR1*F2A133*AA3**2*AA1+CR1*F2A33*AA3**2*
     1 AA1+FA1133*AA3**2*AA1**2)+2.E0*CR133*F1A1*AA1+2.E0*CR113*
     1 F1A3*AA3+4.E0*CR13*CR3*F2A1*AA1+4.E0*CR13*CR1*F2A3*AA3+2.E0*
     1 CR13*F1A13*AA3*AA1+CR13*F1A3*AA3*AA1+CR13*F1A1*AA3*AA1+
     1 ANS2
      Q1133=ANS1/(2.E0*AA3**2*AA1**2)
      VCOEF(1)=0.0E0
      VCOEF(2)=Q1
      VCOEF(3)=Q3
      VCOEF(4)=Q11
      VCOEF(5)=Q33
      VCOEF(6)=Q13
      VCOEF(7)=Q111
      VCOEF(8)=Q333
      VCOEF(9)=Q113
      VCOEF(10)=Q133
      VCOEF(11)=Q1111
      VCOEF(12)=Q3333
      VCOEF(13)=Q1113
      VCOEF(14)=Q1333
      VCOEF(15)=Q1133
      RETURN
      END
