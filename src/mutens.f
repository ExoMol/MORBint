      SUBROUTINE MUTENS (  MUXXY , MUYYY , MUZZY ,
     2                    MUYZY , MURRY , MUXRY ,
     3                    PXMXX1  , PXMXX3 , PRMXR1 , PRMXR3 ,
     2                    PXMXR1  , PXMXR3 , PRMRR1 , PRMRR3 ,
     2                    DMZ     , DMY  , POTSYM  )
      IMPLICIT REAL*8 (A-H,O-Z)
C             :
C DATE        : 28.04.1986
C AUTHOR      : PER JENSEN
C UPDATES     : 19.02.1988
C             : CALCULATION OF THE EXPANSION COEFFICIENTS FOR
C             : THE DIPOLE MOMENT COMPONENTS ADDED
C LANGUAGE    : FORTRAN
C PURPOSE     : CALCULATION OF THE EXPANSION COEFFICIENTS (IN THE
C             : S I'S, THE DELTA R I S, AND THE Y I'S) OF THE NON-
C             : VANISHING MU TENSOR ELEMENTS.
C SUBPROGRAMS :
C      CALLED : AMAT, TRNSSR, INVERT, TRNSRY
C             :
C INPUT       : RHO  INSTANTANEOUS VALUE OF THE BENDING COORDINATE
C             : EPS  INSTANTANEOUS VALUE OF THE ANGLE EPSILON DEFINED
C             :      IN P. JENSEN, COMP. PHYS. REP. 1, 1-55 (1983)
C             :
C OUTPUT      : MUABY(1:15) (AB = XX, YY, ZZ, RR, YZ, AND RX). EXPANSION
C             :             COEFFICIENTS OF THE MUAB TENSOR ELEMENT IN
C             :             TERMS OF THE YI PARAMETERS.
C             :
C             :
C    THE ARRAYS CONTAIN THE COEFFICIENTS OF THE FOLLOWING
C    QUANTITIES:
C
C    I             IABS(I)        IABR(I)           MUABY(I)
C  -------------------------------------------------------------
C    1             1              1                 1
C    2             S1             DR1               Y1
C    3             S3             DR3               Y3
C    4             S1**2          DR1**2            Y1**2
C    5             S3**2          DR3**2            Y3**2
C    6             S1*S3          DR1*DR3           Y1*Y3
C    7                            DR1**3            Y1**3
C    8                            DR3**3            Y3**3
C    9                            DR1**2*DR3        Y1**2*Y3
C   10                            DR1*DR3**2        Y1*Y3**2
C   11                            DR1**4            Y1**4
C   12                            DR3**4            Y3**4
C   13                            DR1**3*DR3        Y1**3*Y3
C   14                            DR1*DR3**3        Y1*Y3**3
C   15                            DR1**2*DR3**2     Y1**2*Y3**2
C
      REAL*8 M1,M2,M3,M,U1,U3,U13,V,RHO,EPS,
     1      CR,SR,CSE,SNE,
     2      CRE,SRE,CORO,EPSP,EPSPP,EPSPPP
C
      REAL*8 AMASS(3,10)
C
      REAL*8 RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1       AA1,AA3,
     2       F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3       F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4       F13,F1A13,F2A13,F3A13,
     5       F111,F1A111,F2A111,F333,F1A333,F2A333,
     6       F113,F1A113,F2A113,F133,F1A133,F2A133,
     7       F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8       F1333,FA1333,F1133,FA1133,
     8       RE12 , RE32 , RHOREF , VMIN
C
      REAL*8 ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1      PREC
C
      REAL*8 THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1      THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2      VELLGT , PLANCK , AVOGNO , DEGRAD , RADDEG ,
     3      PI
C
      REAL*8   B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      REAL*8   CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
      INTEGER NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5       NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6       NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7       NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6       ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7       IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8       NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER,
     9       ISOMAX , NATTS  , V0TYPE , IVAR(55) , PARMAX ,
     1       NUMPAR , PRTINT
C
      INTEGER V1 ,V2, V3 , V2MXP1, V2P1,
     1       NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2       NSEPP2 , NSEQP1 , MBASIS ,
     3       MDIM , NFSYM0, NFASY0, NFSYMJ, NFASYJ,
     4       KSTYPA(2) , LSTYPA(2) , JMAX , V2MAX , JMAXP1
C
      INTEGER IQUANT(5,10)
C
      LOGICAL SYMM,POTSYM
C
      REAL*8 RMK(2),AAS(2)
      INTEGER NOBAS,MBASP1,LENIW
      REAL*8 IXXS(6),IYYS(6),IZZS(6),IRRS(6),IYZS(6),IXRS(6),
     1       IXXR(15),IYYR(15),IZZR(15),IRRR(15),IYZR(15),IXRR(15),
     2       MUXXR(15),MUYYR(15),MUZZR(15),MURRR(15),
     3       MUYZR(15),MUXRR(15),
     4       MUXXY(15),MUYYY(15),MUZZY(15),MURRY(15),
     3       MUYZY(15),MUXRY(15),
     5       PX1R(15),PX3R(15),PR1R(15),PR3R(15),PX1Y(15),
     6       PX3Y(15),PR1Y(15),PR3Y(15),
     7       PXMXX1(15),PXMXX3(15),PRMXR1(15),PRMXR3(15),
     8       PXMXR1(15),PXMXR3(15),PRMRR1(15),PRMRR3(15)
      REAL*8 DNYS(6),DNZS(6),CMYS(6),CMZS(6),V3YS(6),V3ZS(6),
     1       DNYR(15),DNZR(15),DNYY(15),DNZY(15),U3YR(15),U3ZR(15),
     2       REC32(15),V3ZR(15),V3YR(15),V1YS(6),V1ZS(6),
     2       REC12(15),V1ZR(15),V1YR(15),U1YR(15),U1ZR(15),
     3       CRRC(15),AUXIY(15),DMY(15),DMZ(15),
     4       AUXIZ(15),UPYR(15),UPZR(15),
     3       DMPARR(15),DMPERP(15),DMYR(15),DMZR(15)
      REAL*8  A1Y1,A1Z1,A2Y1,A2Z1,A3Y1,A3Z1,
     2       A1Y3,A1Z3,A2Y3,A2Z3,A3Y3,A3Z3,
     3       AP1Y1,AP1Z1,AP2Y1,AP2Z1,AP3Y1,AP3Z1,
     4       AP1Y3,AP1Z3,AP2Y3,AP2Z3,AP3Y3,AP3Z3,
     5       YE1,ZE1,YE2,ZE2,YE3,ZE3,
     6       YEP1,ZEP1,YEP2,ZEP2,YEP3,ZEP3,
     7       YEPP1,ZEPP1,YEPP2,ZEPP2,YEPP3,ZEPP3
      REAL*8  AMMA11,AMMA33,AMMA13,AMMA31,
     1       APMA11,APMA33,APMA13,APMA31,G11,G33,G13,G31,
     2       CHX11,CHX13,CHX31,CHX33,CHR11,CHR13,CHR31,CHR33
C
      COMMON /ELECTR/ EC,ZC1,ZC2,ZC3,ZELEC
C
      COMMON /ISOTOP/ IQUANT,AMASS
C
      COMMON /VALUES/ RHO,EPS,EPSP,EPSPP,EPSPPP,
     1               CR,SR,CSE,SNE,CRE,SRE,CORO
C
      COMMON /MOLCUL/ RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1               AA1,AA3,
     2               F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3               F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4               F13,F1A13,F2A13,F3A13,
     5               F111,F1A111,F2A111,F333,F1A333,F2A333,
     6               F113,F1A113,F2A113,F133,F1A133,F2A133,
     7               F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8               F1333,FA1333,F1133,FA1133,
     8               RE12 , RE32 , M1 , M2 , M3 , M ,
     9               U1 , U3 , U13 , V ,
     1               SYMM
C
      COMMON /INTEG/  ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1               RHOREF , VMIN , V0TYPE ,
     1               NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2               NSEPP2 , NSEQP1 , KSTYPA , LSTYPA
C
      COMMON /DIMEN/  MBASIS ,  V2MAX  , V2MXP1 ,
     1               JMAX   , JMAXP1 , MDIM   , NFSYM0 , NFASY0 ,
     2               NFSYMJ , NFASYJ
C
      COMMON /LSFIT/  PARMAX , NUMPAR , ISOMAX , IVAR
C
      COMMON /SYS/    THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1                     THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2                     VELLGT , PLANCK , AVOGNO , PI , PREC ,
     4                     NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5                     NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6                     NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7                     NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6                     ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7                     IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8                     NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER ,
     9                       NATTS , PRTINT
C
      COMMON/BCOEFF/
     1      B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      COMMON/CRCOEF/
     1      CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
C
      COMMON/MORSE/RMK,AAS
      COMMON/MODIM/NOBAS,MBASP1,LENIW
C
C
      COMMON /DIPOLE/P0,PA1,PA2,PA3,PA4,PA5,PA6,PA7,PA8,
     2               P1,P1A1,P2A1,P3A1,P4A1,
     2               P3,P1A3,P2A3,P3A3,P4A3,
     3               P11,P1A11,P2A11,P3A11,P33,P1A33,P2A33,P3A33,
     4               P13,P1A13,P2A13,P3A13,
     5               P111,P1A111,P2A111,P333,P1A333,P2A333,
     6               P113,P1A113,P2A113,P133,P1A133,P2A133,
     7               P1111,PA1111,P3333,PA3333,P1113,PA1113,
     8               P1333,PA1333,P1133,PA1133,
     1               O0,OA1,OA2,OA3,OA4,OA5,OA6,OA7,OA8,
     2               O1,O1A1,O2A1,O3A1,O4A1,
     2               O3,O1A3,O2A3,O3A3,O4A3,
     3               O11,O1A11,O2A11,O3A11,O33,O1A33,O2A33,O3A33,
     4               O13,O1A13,O2A13,O3A13,
     5               O111,O1A111,O2A111,O333,O1A333,O2A333,
     6               O113,O1A113,O2A113,O133,O1A133,O2A133,
     7               O1111,OA1111,O3333,OA3333,O1113,OA1113,
     8               O1333,OA1333,O1133,OA1133
C
      IXXS(1)=(U1+U3+2.0E0*U13*CR)/M
      IYYS(1)=(U1*CRE**2+U3*CSE**2+2.0E0*U13*CSE*CRE)/M
      IZZS(1)=(U1*SRE**2+U3*SNE**2-2.0E0*U13*SNE*SRE)/M
      IYZS(1)=(U1*SIN(2.0E0*(RHO-EPS))-U3*SIN(2.0E0*EPS)
     1        +2.0E0*U13*SIN(RHO-2.0E0*EPS))/(2.0E0*M)
      IRRS(1)=(U1*U3-U13*U13*CR*CR)/(U1+U3+2.0D+00*U13*CR)/M
      IXRS(1)=0.0E0
C
C UPON INPUT OF RHO AND EPS, THE SUBROUTINE AMAT CALCULATES THE
C NECESSARY VALUES OF THE A MATRIX ELEMENTS, THE A PRIME
C MATRIX ELEMENTS, THE A VECTOR COMPONENTS AND THEIR FIRST
C AND SECOND DERIVATIVES.
C
      CALL AMAT ( A1Y1,A1Z1,A2Y1,A2Z1,A3Y1,A3Z1,
     2           A1Y3,A1Z3,A2Y3,A2Z3,A3Y3,A3Z3,
     3           AP1Y1,AP1Z1,AP2Y1,AP2Z1,AP3Y1,AP3Z1,
     4           AP1Y3,AP1Z3,AP2Y3,AP2Z3,AP3Y3,AP3Z3,
     5           YE1,ZE1,YE2,ZE2,YE3,ZE3,
     6           YEP1,ZEP1,YEP2,ZEP2,YEP3,ZEP3,
     7           YEPP1,ZEPP1,YEPP2,ZEPP2,YEPP3,ZEPP3)
C
C     THE FOLLOWING EXPRESSIONS FOR EXPANSION COEFFICIENTS OF
C     THE I TENSOR ELEMENTS IN TERMS OF THE SI COORDINATES ARE
C     TAKEN FROM EQ. (20) OF J. HOUGEN, P.R. BUNKER, AND
C     J.W.C. JOHNS, J. MOL. SPECTROSC. 34, 136-172 (1970).
C
      IYYS(2)=
     1 2.0D+00*(M1*ZE1*A1Z1+M2*ZE2*A2Z1+M3*ZE3*A3Z1)
      IYYS(3)=
     1 2.0D+00*(M1*ZE1*A1Z3+M2*ZE2*A2Z3+M3*ZE3*A3Z3)
      IYYS(4)=
     1  M1*A1Z1*A1Z1
     2 +M2*A2Z1*A2Z1
     3 +M3*A3Z1*A3Z1
      IYYS(5)=
     1  M1*A1Z3*A1Z3
     2 +M2*A2Z3*A2Z3
     3 +M3*A3Z3*A3Z3
      IYYS(6)=
     1  2.0D+00*(M1*A1Z1*A1Z3
     2          +M2*A2Z1*A2Z3
     3          +M3*A3Z1*A3Z3)
      IZZS(2)=
     1 2.0D+00*(M1*YE1*A1Y1+M2*YE2*A2Y1+M3*YE3*A3Y1)
      IZZS(3)=
     1 2.0D+00*(M1*YE1*A1Y3+M2*YE2*A2Y3+M3*YE3*A3Y3)
      IZZS(4)=
     1  M1*A1Y1*A1Y1
     2 +M2*A2Y1*A2Y1
     3 +M3*A3Y1*A3Y1
      IZZS(5)=
     1  M1*A1Y3*A1Y3
     2 +M2*A2Y3*A2Y3
     3 +M3*A3Y3*A3Y3
      IZZS(6)=
     1  2.0D+00*(M1*A1Y1*A1Y3
     2          +M2*A2Y1*A2Y3
     3          +M3*A3Y1*A3Y3)
      IXXS(1)=IYYS(1)+IZZS(1)
      IXXS(2)=IYYS(2)+IZZS(2)
      IXXS(3)=IYYS(3)+IZZS(3)
      IXXS(4)=IYYS(4)+IZZS(4)
      IXXS(5)=IYYS(5)+IZZS(5)
      IXXS(6)=IYYS(6)+IZZS(6)
      IYZS(2)=
     1 -(M1*YE1*A1Z1+M2*YE2*A2Z1+M3*YE3*A3Z1)
     2 -(M1*ZE1*A1Y1+M2*ZE2*A2Y1+M3*ZE3*A3Y1)
      IYZS(3)=
     1 -(M1*YE1*A1Z3+M2*YE2*A2Z3+M3*YE3*A3Z3)
     2 -(M1*ZE1*A1Y3+M2*ZE2*A2Y3+M3*ZE3*A3Y3)
      IYZS(4)=
     1 -M1*A1Y1*A1Z1
     2 -M2*A2Y1*A2Z1
     3 -M3*A3Y1*A3Z1
      IYZS(5)=
     1 -M1*A1Y3*A1Z3
     2 -M2*A2Y3*A2Z3
     3 -M3*A3Y3*A3Z3
      IYZS(6)=
     1 -M1*(A1Y1*A1Z3+A1Y3*A1Z1)
     2 -M2*(A2Y1*A2Z3+A2Y3*A2Z1)
     3 -M3*(A3Y1*A3Z3+A3Y3*A3Z1)
      IXRS(2)=
     1 -2.0D+00*(M1*(YEP1*A1Z1-ZEP1*A1Y1)
     2          +M2*(YEP2*A2Z1-ZEP2*A2Y1)
     3          +M3*(YEP3*A3Z1-ZEP3*A3Y1))
      IXRS(3)=
     1 -2.0D+00*(M1*(YEP1*A1Z3-ZEP1*A1Y3)
     2          +M2*(YEP2*A2Z3-ZEP2*A2Y3)
     3          +M3*(YEP3*A3Z3-ZEP3*A3Y3))
      IXRS(4)=
     1  M1*(A1Y1*AP1Z1-A1Z1*AP1Y1)
     2 +M2*(A2Y1*AP2Z1-A2Z1*AP2Y1)
     3 +M3*(A3Y1*AP3Z1-A3Z1*AP3Y1)
      IXRS(5)=
     1  M1*(A1Y3*AP1Z3-A1Z3*AP1Y3)
     2 +M2*(A2Y3*AP2Z3-A2Z3*AP2Y3)
     3 +M3*(A3Y3*AP3Z3-A3Z3*AP3Y3)
      IXRS(6)=
     1           M1*(A1Y1*AP1Z3-A1Z1*AP1Y3)
     2          +M2*(A2Y1*AP2Z3-A2Z1*AP2Y3)
     3          +M3*(A3Y1*AP3Z3-A3Z1*AP3Y3)
     1          +M1*(A1Y3*AP1Z1-A1Z3*AP1Y1)
     2          +M2*(A2Y3*AP2Z1-A2Z3*AP2Y1)
     3          +M3*(A3Y3*AP3Z1-A3Z3*AP3Y1)
      IRRS(2)=
     1 -2.0D+00*(M1*(YEPP1*A1Y1+ZEPP1*A1Z1)
     2          +M2*(YEPP2*A2Y1+ZEPP2*A2Z1)
     3          +M3*(YEPP3*A3Y1+ZEPP3*A3Z1))
      IRRS(3)=
     1 -2.0D+00*(M1*(YEPP1*A1Y3+ZEPP1*A1Z3)
     2          +M2*(YEPP2*A2Y3+ZEPP2*A2Z3)
     3          +M3*(YEPP3*A3Y3+ZEPP3*A3Z3))
      IRRS(4)=
     1  M1*(AP1Y1*AP1Y1+AP1Z1*AP1Z1)
     2 +M2*(AP2Y1*AP2Y1+AP2Z1*AP2Z1)
     3 +M3*(AP3Y1*AP3Y1+AP3Z1*AP3Z1)
      IRRS(5)=
     1  M1*(AP1Y3*AP1Y3+AP1Z3*AP1Z3)
     2 +M2*(AP2Y3*AP2Y3+AP2Z3*AP2Z3)
     3 +M3*(AP3Y3*AP3Y3+AP3Z3*AP3Z3)
      IRRS(6)=
     1  2.0D+00*(M1*(AP1Y1*AP1Y3+AP1Z1*AP1Z3)
     2          +M2*(AP2Y1*AP2Y3+AP2Z1*AP2Z3)
     3          +M3*(AP3Y1*AP3Y3+AP3Z1*AP3Z3))
C
C     THE FOLLOWING EXPRESSIONS ENTER INTO EQ. (17) OF
C     T. HOUGEN, P.R. BUNKER, AND J.W.C. JOHNS, J. MOL.
C     SPECTROSC. 34, 136-172 (1970). THEY ARE USED TO
C     CALCULATE THE I PRIME TENSOR FROM THE I TENSOR.
C
C       CALCULATION OF (A TR M M ALPHA A)
      AMMA11=0.0E0
      AMMA33=0.0E0
      AMMA13=
     1  M1*(A1Y1*A1Z3-A1Z1*A1Y3)
     2 +M2*(A2Y1*A2Z3-A2Z1*A2Y3)
     3 +M3*(A3Y1*A3Z3-A3Z1*A3Y3)
      AMMA31=-AMMA13
C       CALCULATION OF (AP TR M A)
      APMA11=
     1  M1*(AP1Y1*A1Y1+AP1Z1*A1Z1)
     2 +M2*(AP2Y1*A2Y1+AP2Z1*A2Z1)
     3 +M3*(AP3Y1*A3Y1+AP3Z1*A3Z1)
      APMA33=
     1  M1*(AP1Y3*A1Y3+AP1Z3*A1Z3)
     2 +M2*(AP2Y3*A2Y3+AP2Z3*A2Z3)
     3 +M3*(AP3Y3*A3Y3+AP3Z3*A3Z3)
      APMA13=
     1  M1*(AP1Y1*A1Y3+AP1Z1*A1Z3)
     2 +M2*(AP2Y1*A2Y3+AP2Z1*A2Z3)
     3 +M3*(AP3Y1*A3Y3+AP3Z1*A3Z3)
      APMA31=
     1  M1*(AP1Y3*A1Y1+AP1Z3*A1Z1)
     2 +M2*(AP2Y3*A2Y1+AP2Z3*A2Z1)
     3 +M3*(AP3Y3*A3Y1+AP3Z3*A3Z1)
      G11=(M1+M2)/(M1*M2)
      G33=(M3+M2)/(M3*M2)
      G13=-CR/M2
      G31=G13
      IXXS(4) = IXXS(4) -
     1                 (AMMA11*G11*AMMA11+AMMA13*G33*AMMA13
     2                 +AMMA11*G13*AMMA13+AMMA13*G31*AMMA11)
      IXXS(5) = IXXS(5) -
     1                 (AMMA31*G11*AMMA31+AMMA33*G33*AMMA33
     2                 +AMMA31*G13*AMMA33+AMMA33*G31*AMMA31)
      IXXS(6) = IXXS(6) -
     1            (AMMA11*G11*AMMA31+AMMA13*G33*AMMA33
     2            +AMMA11*G13*AMMA33+AMMA13*G31*AMMA31
     1            +AMMA31*G11*AMMA11+AMMA33*G33*AMMA13
     2            +AMMA31*G13*AMMA13+AMMA33*G31*AMMA11)
      IRRS(4) = IRRS(4) -
     1                 (APMA11*G11*APMA11+APMA13*G33*APMA13
     2                 +APMA11*G13*APMA13+APMA13*G31*APMA11)
      IRRS(5) = IRRS(5) -
     1                 (APMA31*G11*APMA31+APMA33*G33*APMA33
     2                 +APMA31*G13*APMA33+APMA33*G31*APMA31)
      IRRS(6) = IRRS(6) -
     1             (APMA11*G11*APMA31+APMA13*G33*APMA33
     2             +APMA11*G13*APMA33+APMA13*G31*APMA31
     1             +APMA31*G11*APMA11+APMA33*G33*APMA13
     2             +APMA31*G13*APMA13+APMA33*G31*APMA11)
      IXRS(4) = IXRS(4) -
     1                 (AMMA11*G11*APMA11+AMMA13*G33*APMA13
     2                 +AMMA11*G13*APMA13+AMMA13*G31*APMA11)
      IXRS(5) = IXRS(5) -
     1                 (AMMA31*G11*APMA31+AMMA33*G33*APMA33
     2                 +AMMA31*G13*APMA33+AMMA33*G31*APMA31)
      IXRS(6) = IXRS(6) -
     1              (AMMA11*G11*APMA31+AMMA13*G33*APMA33
     2              +AMMA11*G13*APMA33+AMMA13*G31*APMA31
     1              +AMMA31*G11*APMA11+AMMA33*G33*APMA13
     2              +AMMA31*G13*APMA13+AMMA33*G31*APMA11)
C
C     CONVERT FROM POLYNOMIALS IN S TO POLYNOMIALS IN DELTA R
C
      CALL TRNSSR ( IXXS , IXXR )
      CALL TRNSSR ( IYYS , IYYR )
      CALL TRNSSR ( IZZS , IZZR )
      CALL TRNSSR ( IYZS , IYZR )
      CALL TRNSSR ( IRRS , IRRR )
      CALL TRNSSR ( IXRS , IXRR )
C
C     CONVERT THE X-RHO CORNER OF THE I TENSOR TO MU TENSOR
C     ELEMENTS
C
      CALL INVERT  ( IXXR , IRRR , IXRR , MUXXR , MURRR , MUXRR )
C
C     CONVERT THE Y-Z CORNER OF THE I TENSOR TO MU TENSOR
C     ELEMENTS
C
      CALL INVERT  ( IYYR , IZZR , IYZR , MUYYR , MUZZR , MUYZR )
C
C     CONVERT FROM POLYNOMIALS IN DELTA R TO POLYNOMIALS IN Y
C
      CALL TRNSRY ( MUXXR , MUXXY )
      CALL TRNSRY ( MUYYR , MUYYY )
      CALL TRNSRY ( MUZZR , MUZZY )
      CALL TRNSRY ( MUYZR , MUYZY )
      CALL TRNSRY ( MURRR , MURRY )
      CALL TRNSRY ( MUXRR , MUXRY )
      CHX11=AMMA11*G11+AMMA13*G31
      CHX13=AMMA11*G13+AMMA13*G33
      CHX31=AMMA31*G11+AMMA33*G31
      CHX33=AMMA31*G13+AMMA33*G33
      CHR11=APMA11*G11+APMA13*G31
      CHR13=APMA11*G13+APMA13*G33
      CHR31=APMA31*G11+APMA33*G31
      CHR33=APMA31*G13+APMA33*G33
C
C     CALCULATION OF THE EXPANSION COEFFICIENTS OF THE VIBRATIONAL
C     ANGULAR MOMENTA P SUB X AND P SUB RHO.
C
      CALL VIBRAM ( CHX11 , CHX13 , CHX31 , CHX33 ,
     1             CHR11 , CHR13 , CHR31 , CHR33 ,
     2             PX1R  , PX3R  , PR1R  , PR3R  )
C
      CALL TRNSRY ( PX1R , PX1Y )
      CALL TRNSRY ( PX3R , PX3Y )
      CALL TRNSRY ( PR1R , PR1Y )
      CALL TRNSRY ( PR3R , PR3Y )
C
C     CALCULATION OF THE EXPANSION COEFFICIENTS OF THE PRODUCTS OF
C     THE VIBRATIONAL ANGULAR MOMENTA P SUB X AND P SUB RHO WITH
C     THE RELEVANT MU TENSOR ELEMENTS FOR THE CORIOLIS TERMS IN
C     THE MORBID SCHEME.
C
      CALL MUPV ( MUXXY , PX1Y , PX3Y , PXMXX1 , PXMXX3 )
      CALL MUPV ( MUXRY , PR1Y , PR3Y , PRMXR1 , PRMXR3 )
      CALL MUPV ( MUXRY , PX1Y , PX3Y , PXMXR1 , PXMXR3 )
      CALL MUPV ( MURRY , PR1Y , PR3Y , PRMRR1 , PRMRR3 )
C
C     CALCULATE CENTER-OF-MASS COORDINATES FOR THE REFERENCE
C     MOLECULE (EXPANSION COEFFIENTS IN THE S EXPANSION)
C
      REFM1=AMASS(1,1)
      REFM2=AMASS(2,1)
      REFM3=AMASS(3,1)
      TMREF=REFM1+REFM2+REFM3
      CMYS(1)=(REFM1*YE1 + REFM2*YE2 + REFM3*YE3)/TMREF
      CMYS(2)=(REFM1*A1Y1 + REFM2*A2Y1 + REFM3*A3Y1)/TMREF
      CMYS(3)=(REFM1*A1Y3 + REFM2*A2Y3 + REFM3*A3Y3)/TMREF
      CMYS(4)=0.0D+00
      CMYS(5)=0.0D+00
      CMYS(6)=0.0D+00
      CMZS(1)=(REFM1*ZE1 + REFM2*ZE2 + REFM3*ZE3)/TMREF
      CMZS(2)=(REFM1*A1Z1 + REFM2*A2Z1 + REFM3*A3Z1)/TMREF
      CMZS(3)=(REFM1*A1Z3 + REFM2*A2Z3 + REFM3*A3Z3)/TMREF
      CMZS(4)=0.0D+00
      CMZS(5)=0.0D+00
      CMZS(6)=0.0D+00
C
C     CALCULATE NUCLEAR DIPOLE MOMENT COORDINATES
C     (EXPANSION COEFFIENTS IN THE S EXPANSION)
C
C
      DNYS(1)=(ZC1*YE1 + ZC2*YE2 + ZC3*YE3
     .        -ZELEC*CMYS(1))*EC
      DNYS(2)=(ZC1*A1Y1 + ZC2*A2Y1 + ZC3*A3Y1
     .        -ZELEC*CMYS(2))*EC
      DNYS(3)=(ZC1*A1Y3 + ZC2*A2Y3 + ZC3*A3Y3
     .        -ZELEC*CMYS(3))*EC
      DNYS(4)=0.0D+00
      DNYS(5)=0.0D+00
      DNYS(6)=0.0D+00
      DNZS(1)=(ZC1*ZE1 + ZC2*ZE2 + ZC3*ZE3
     .        -ZELEC*CMZS(1))*EC
      DNZS(2)=(ZC1*A1Z1 + ZC2*A2Z1 + ZC3*A3Z1
     .        -ZELEC*CMZS(2))*EC
      DNZS(3)=(ZC1*A1Z3 + ZC2*A2Z3 + ZC3*A3Z3
     .        -ZELEC*CMZS(3))*EC
      DNZS(4)=0.0D+00
      DNZS(5)=0.0D+00
      DNZS(6)=0.0D+00
C
C     TRANSFORM TO POLYNOMIALS IN THE DELTA R'S
C
      CALL TRNSSR ( DNYS , DNYR )
      CALL TRNSSR ( DNZS , DNZR )
C
C     TRANSFORM TO POLYNOMIALS IN THE Y'S
C
      CALL TRNSRY ( DNYR , DNYY )
      CALL TRNSRY ( DNZR , DNZY )
C
C     CALCULATE COORDINATES FOR 2-3 VECTOR
C     (EXPANSION COEFFIENTS IN THE S EXPANSION)
C
C
      V1YS(1)=YE1-YE2
      V1YS(2)=A1Y1-A2Y1
      V1YS(3)=A1Y3-A2Y3
      V1YS(4)=0.0D+00
      V1YS(5)=0.0D+00
      V1YS(6)=0.0D+00
      V1ZS(1)=ZE1-ZE2
      V1ZS(2)=A1Z1-A2Z1
      V1ZS(3)=A1Z3-A2Z3
      V1ZS(4)=0.0D+00
      V1ZS(5)=0.0D+00
      V1ZS(6)=0.0D+00
C
C     TRANSFORM TO POLYNOMIALS IN THE DELTA R'S
C
      CALL TRNSSR ( V1YS , V1YR )
      CALL TRNSSR ( V1ZS , V1ZR )
C
C     PREPARE EXPANSION COEFFICIENTS FOR 1/R12
C
      REC12( 1)=1.0D+00/RE12
      REC12( 2)=-1.0D+00/RE12**2
      REC12( 3)=0.0D+00
      REC12( 4)=1.0D+00/RE12**3
      REC12( 5)=0.0D+00
      REC12( 6)=0.0D+00
      REC12( 7)=-1.0D+00/RE12**4
      REC12( 8)=0.0D+00
      REC12( 9)=0.0D+00
      REC12(10)=0.0D+00
      REC12(11)=1.0D+00/RE12**5
      REC12(12)=0.0D+00
      REC12(13)=0.0D+00
      REC12(14)=0.0D+00
      REC12(15)=0.0D+00
C
C     CALCULATE COORDINATES OF UNIT VECTOR IN THE
C     2-1 DIRECTION. THE EXPANSION COEFFICIENTS ARE
C     CONTAINED IN THE ARRAYS U3YR AND U3ZR
C
      CALL PLMLT2 ( REC12 , V1YR , U1YR )
      CALL PLMLT2 ( REC12 , V1ZR , U1ZR )
C
C     CALCULATE COORDINATES FOR 2-3 VECTOR
C     (EXPANSION COEFFIENTS IN THE S EXPANSION)
C
C
      V3YS(1)=YE3-YE2
      V3YS(2)=A3Y1-A2Y1
      V3YS(3)=A3Y3-A2Y3
      V3YS(4)=0.0D+00
      V3YS(5)=0.0D+00
      V3YS(6)=0.0D+00
      V3ZS(1)=ZE3-ZE2
      V3ZS(2)=A3Z1-A2Z1
      V3ZS(3)=A3Z3-A2Z3
      V3ZS(4)=0.0D+00
      V3ZS(5)=0.0D+00
      V3ZS(6)=0.0D+00
C
C     TRANSFORM TO POLYNOMIALS IN THE DELTA R'S
C
      CALL TRNSSR ( V3YS , V3YR )
      CALL TRNSSR ( V3ZS , V3ZR )
C
C     PREPARE EXPANSION COEFFICIENTS FOR 1/R32
C
      REC32( 1)=1.0D+00/RE32
      REC32( 2)=0.0D+00
      REC32( 3)=-1.0D+00/RE32**2
      REC32( 4)=0.0D+00
      REC32( 5)=1.0D+00/RE32**3
      REC32( 6)=0.0D+00
      REC32( 7)=0.0D+00
      REC32( 8)=-1.0D+00/RE32**4
      REC32( 9)=0.0D+00
      REC32(10)=0.0D+00
      REC32(11)=0.0D+00
      REC32(12)=1.0D+00/RE32**5
      REC32(13)=0.0D+00
      REC32(14)=0.0D+00
      REC32(15)=0.0D+00
C
C     CALCULATE COORDINATES OF UNIT VECTOR IN THE
C     2-3 DIRECTION. THE EXPANSION COEFFICIENTS ARE
C     CONTAINED IN THE ARRAYS U3YR AND U3ZR
C
      CALL PLMLT2 ( REC32 , V3YR , U3YR )
      CALL PLMLT2 ( REC32 , V3ZR , U3ZR )
C
      IF (POTSYM) THEN
C
C     GENERATE EXPANSION COEFFIENTS FOR 1/SQRT(2*(COS(RHOBAR)+1)
C     (CONTAINED IN CRRC)
C
      CALL RECCOS ( CRRC )
C
C     GENERATE COORDINATES FOR A UNIT VECTOR IN THE 'PARALLEL'
C     DIRECTION
C
      DO 5000 II=1,15
5000  AUXIY(II) = U3YR(II)-U1YR(II)
      CALL PLMLT2 ( CRRC , AUXIY , UPYR )
C
      DO 5100 II=1,15
5100  AUXIZ(II) = U3ZR(II)-U1ZR(II)
      CALL PLMLT2 ( CRRC , AUXIZ , UPZR )
C
      ELSE
C
      DO 5105 II=1,15
      UPYR(II) = U3YR(II)
5105  UPZR(II) = U3ZR(II)
C
      ENDIF
C
C
C     GENERATE EXPANSION COEFFIENTS FOR THE ELECTRONIC
C     DIPOLE MOMENT FUNCTIONS (PARALLEL AND PERPENDICULAR)
C     TAKEN FROM INPUT.
C
      CALL GENDIP ( DMPARR , DMPERP )
C
C     GENERATE EXPANSION COEFFIENTS FOR THE ELECTRONIC
C     DIPOLE MOMENT ALONG THE Y AXIS.
C
      CALL PLMLT2 ( DMPARR , UPYR , AUXIY )
      CALL PLMLT2 ( DMPERP , UPZR , AUXIZ )
      DO 5200 II=1,15
5200  DMYR(II) = AUXIY(II)+AUXIZ(II)
C
C     GENERATE EXPANSION COEFFIENTS FOR THE ELECTRONIC
C     DIPOLE MOMENT ALONG THE Z AXIS.
C
      CALL PLMLT2 ( DMPARR , UPZR , AUXIY )
      CALL PLMLT2 ( DMPERP , UPYR , AUXIZ )
      DO 5300 II=1,15
5300  DMZR(II) = AUXIY(II)-AUXIZ(II)
C
C     TRANSFORM TO POLYNOMIALS IN THE Y'S
C
      CALL TRNSRY ( DMYR , DMY )
      CALL TRNSRY ( DMZR , DMZ )
C
C     ADD NUCLEAR PART
C
      DO 5400 II=1,15
      DMY(II) = DMY(II)+DNYY(II)
5400  DMZ(II) = DMZ(II)+DNZY(II)
      RETURN
      END
C
C
      SUBROUTINE GENDIP ( DMPARR , DMPERP )
      IMPLICIT REAL*8 (A-H,O-Z)
C             :
C DATE        : 18.02.1988
C AUTHOR      : PER JENSEN
C UPDATES     :
C LANGUAGE    : FORTRAN
C PURPOSE     : GENERATION OF THE EXPANSION COEFFICIENTS OF THE
C             : ELECTRONIC DIPOLE MOMENT COMPONENTS
C             : IN THE RHO DEPENDENT FORM.
C             : EXPANSION COEFFICIENTS FOR R SUB I'S ARE CALCULATED.
C             : THE CODE IS GENERATED BY REDUCE.
C             :
C SUBPROGRAMS :
C      CALLED :
C             :
C    FOR EXPLANATIONS OF ARRAY CONTENTS SEE COMMENTS IN
C    SUBROUTINE TRNSDP
C
      REAL*8 M1,M2,M3,M,U1,U3,U13,V,RHO,EPS,
     1      CR,SR,CSE,SNE,
     2      CRE,SRE,CORO,EPSP,EPSPP,EPSPPP
C
      REAL*8 AMASS(3,10)
C
      REAL*8 RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1       AA1,AA3,
     2       F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3       F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4       F13,F1A13,F2A13,F3A13,
     5       F111,F1A111,F2A111,F333,F1A333,F2A333,
     6       F113,F1A113,F2A113,F133,F1A133,F2A133,
     7       F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8       F1333,FA1333,F1133,FA1133,
     8       RE12 , RE32 , RHOREF , VMIN
C
      REAL*8 ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1      PREC
C
      REAL*8 THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1      THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2      VELLGT , PLANCK , AVOGNO , DEGRAD , RADDEG ,
     3      PI
C
      REAL*8   CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
      INTEGER NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5       NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6       NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7       NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6       ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7       IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8       NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER,
     9       ISOMAX , NATTS  , V0TYPE , IVAR(55) , PARMAX ,
     1       NUMPAR , PRTINT
C
      INTEGER V1 ,V2, V3 , V2MXP1, V2P1,
     1       NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2       NSEPP2 , NSEQP1 , MBASIS ,
     3       MDIM , NFSYM0, NFASY0, NFSYMJ, NFASYJ,
     4       KSTYPA(2) , LSTYPA(2) , JMAX , V2MAX , JMAXP1
C
      INTEGER IQUANT(5,10)
C
      LOGICAL SYMM
C
      REAL*8 RMK(2),AAS(2)
      INTEGER NOBAS,MBASP1,LENIW
      REAL*8   CINPUT(53),DMPARR(15),DMPERP(15),AUXILI(15),
     1       SBARS(6),SBARR(15),AUXIR(15),AUXI2(15),REC12(15),
     1       REC32(15)
C
      COMMON /MOLCUL/ RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1               AA1,AA3,
     2               F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3               F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4               F13,F1A13,F2A13,F3A13,
     5               F111,F1A111,F2A111,F333,F1A333,F2A333,
     6               F113,F1A113,F2A113,F133,F1A133,F2A133,
     7               F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8               F1333,FA1333,F1133,FA1133,
     8               RE12 , RE32 , M1 , M2 , M3 , M ,
     9               U1 , U3 , U13 , V ,
     1               SYMM
C
      COMMON /ISOTOP/ IQUANT,AMASS
C
      COMMON /VALUES/ RHO,EPS,EPSP,EPSPP,EPSPPP,
     1               CR,SR,CSE,SNE,CRE,SRE,CORO
C
      COMMON /DIPOLE/P0,PA1,PA2,PA3,PA4,PA5,PA6,PA7,PA8,
     2               P1,P1A1,P2A1,P3A1,P4A1,
     2               P3,P1A3,P2A3,P3A3,P4A3,
     3               P11,P1A11,P2A11,P3A11,P33,P1A33,P2A33,P3A33,
     4               P13,P1A13,P2A13,P3A13,
     5               P111,P1A111,P2A111,P333,P1A333,P2A333,
     6               P113,P1A113,P2A113,P133,P1A133,P2A133,
     7               P1111,PA1111,P3333,PA3333,P1113,PA1113,
     8               P1333,PA1333,P1133,PA1133,
     1               O0,OA1,OA2,OA3,OA4,OA5,OA6,OA7,OA8,
     2               O1,O1A1,O2A1,O3A1,O4A1,
     2               O3,O1A3,O2A3,O3A3,O4A3,
     3               O11,O1A11,O2A11,O3A11,O33,O1A33,O2A33,O3A33,
     4               O13,O1A13,O2A13,O3A13,
     5               O111,O1A111,O2A111,O333,O1A333,O2A333,
     6               O113,O1A113,O2A113,O133,O1A133,O2A133,
     7               O1111,OA1111,O3333,OA3333,O1113,OA1113,
     8               O1333,OA1333,O1133,OA1133
C
      COMMON /INTEG/  ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1               RHOREF , VMIN , V0TYPE ,
     1               NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2               NSEPP2 , NSEQP1 , KSTYPA , LSTYPA
C
      COMMON /DIMEN/  MBASIS ,  V2MAX  , V2MXP1 ,
     1               JMAX   , JMAXP1 , MDIM   , NFSYM0 , NFASY0 ,
     2               NFSYMJ , NFASYJ
C
      COMMON /LSFIT/  PARMAX , NUMPAR , ISOMAX , IVAR
C
      COMMON /SYS/    THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1                     THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2                     VELLGT , PLANCK , AVOGNO , PI , PREC ,
     4                     NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5                     NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6                     NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7                     NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6                     ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7                     IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8                     NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER ,
     9                       NATTS , PRTINT
C
C
      COMMON/CRCOEF/
     1      CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
C
      COMMON/MORSE/RMK,AAS
      COMMON/MODIM/NOBAS,MBASP1,LENIW
C
      CINPUT( 1) = P0
      CINPUT( 2) = PA1
      CINPUT( 3) = PA2
      CINPUT( 4) = PA3
      CINPUT( 5) = PA4
      CINPUT( 6) = PA5
      CINPUT( 7) = PA6
      CINPUT( 8) = PA7
      CINPUT( 9) = PA8
      CINPUT(10) = P1
      CINPUT(11) = P1A1
      CINPUT(12) = P2A1
      CINPUT(13) = P3A1
      CINPUT(14) = P4A1
      CINPUT(15) = P3
      CINPUT(16) = P1A3
      CINPUT(17) = P2A3
      CINPUT(18) = P3A3
      CINPUT(19) = P4A3
      CINPUT(20) = P11
      CINPUT(21) = P1A11
      CINPUT(22) = P2A11
      CINPUT(23) = P3A11
      CINPUT(24) = P33
      CINPUT(25) = P1A33
      CINPUT(26) = P2A33
      CINPUT(27) = P3A33
      CINPUT(28) = P13
      CINPUT(29) = P1A13
      CINPUT(30) = P2A13
      CINPUT(31) = P3A13
      CINPUT(32) = P111
      CINPUT(33) = P1A111
      CINPUT(34) = P2A111
      CINPUT(35) = P333
      CINPUT(36) = P1A333
      CINPUT(37) = P2A333
      CINPUT(38) = P113
      CINPUT(39) = P1A113
      CINPUT(40) = P2A113
      CINPUT(41) = P133
      CINPUT(42) = P1A133
      CINPUT(43) = P2A133
      CINPUT(44) = P1111
      CINPUT(45) = PA1111
      CINPUT(46) = P3333
      CINPUT(47) = PA3333
      CINPUT(48) = P1113
      CINPUT(49) = PA1113
      CINPUT(50) = P1333
      CINPUT(51) = PA1333
      CINPUT(52) = P1133
      CINPUT(53) = PA1133
C
      CORO=COS(RHOE)-COS(RHO)
      CALL TRNSDP ( CINPUT , DMPARR )
C
      CINPUT( 1) = O0
      CINPUT( 2) = OA1
      CINPUT( 3) = OA2
      CINPUT( 4) = OA3
      CINPUT( 5) = OA4
      CINPUT( 6) = OA5
      CINPUT( 7) = OA6
      CINPUT( 8) = OA7
      CINPUT( 9) = OA8
      CINPUT(10) = O1
      CINPUT(11) = O1A1
      CINPUT(12) = O2A1
      CINPUT(13) = O3A1
      CINPUT(14) = O4A1
      CINPUT(15) = O3
      CINPUT(16) = O1A3
      CINPUT(17) = O2A3
      CINPUT(18) = O3A3
      CINPUT(19) = O4A3
      CINPUT(20) = O11
      CINPUT(21) = O1A11
      CINPUT(22) = O2A11
      CINPUT(23) = O3A11
      CINPUT(24) = O33
      CINPUT(25) = O1A33
      CINPUT(26) = O2A33
      CINPUT(27) = O3A33
      CINPUT(28) = O13
      CINPUT(29) = O1A13
      CINPUT(30) = O2A13
      CINPUT(31) = O3A13
      CINPUT(32) = O111
      CINPUT(33) = O1A111
      CINPUT(34) = O2A111
      CINPUT(35) = O333
      CINPUT(36) = O1A333
      CINPUT(37) = O2A333
      CINPUT(38) = O113
      CINPUT(39) = O1A113
      CINPUT(40) = O2A113
      CINPUT(41) = O133
      CINPUT(42) = O1A133
      CINPUT(43) = O2A133
      CINPUT(44) = O1111
      CINPUT(45) = OA1111
      CINPUT(46) = O3333
      CINPUT(47) = OA3333
      CINPUT(48) = O1113
      CINPUT(49) = OA1113
      CINPUT(50) = O1333
      CINPUT(51) = OA1333
      CINPUT(52) = O1133
      CINPUT(53) = OA1133
C
      CORO=COS(RHOE)-COS(RHO)
      CALL TRNSDP ( CINPUT , AUXILI )
C
      SBARS(1)=SR*RE12*RE32
      SBARS(2)=
     .    (SR*(M**2*M2**2*RE32+M*CR**2*M3*M1*M2*RE32+M*CR*
     . M3*M1*M2*RE12+M*CR*M1*M2**2*RE12+2.*M*SR**2*M3*M1*M2
     . *RE32+CR**2*SR**2*M3**2*M1**2*RE32+CR*SR**2*M3**2*M1
     . **2*RE12+CR*SR**2*M3*M1**2*M2*RE12+SR**4*M3**2*M1**2
     . *RE32))/(M**2*M2**2+2.*M*SR**2*M3*M1*M2+SR**4*M3**2*
     . M1**2)
      SBARS(3)=
     .    (SR*(M**2*M2**2*RE12+M*CR**2*M3*M1*M2*RE12+M*CR*
     . M3*M1*M2*RE32+M*CR*M3*M2**2*RE32+2.*M*SR**2*M3*M1*M2
     . *RE12+CR**2*SR**2*M3**2*M1**2*RE12+CR*SR**2*M3**2*M1
     . **2*RE32+CR*SR**2*M3**2*M1*M2*RE32+SR**4*M3**2*M1**2
     . *RE12))/(M**2*M2**2+2.*M*SR**2*M3*M1*M2+SR**4*M3**2*
     . M1**2)
      SBARS(4)=
     .     (M*CR*SR*M1*M2*(M3+M2))/(M**2*M2**2+2.*M*SR**2*
     . M3*M1*M2+SR**4*M3**2*M1**2)
      SBARS(5)=
     .     (M*CR*SR*M3*M2*(M1+M2))/(M**2*M2**2+2.*M*SR**2*
     . M3*M1*M2+SR**4*M3**2*M1**2)
      SBARS(6)=
     .     (SR*(M**2*M2**2+2.*M*CR**2*M3*M1*M2+2.*M*SR**2*
     . M3*M1*M2+CR**2*SR**2*M3**2*M1**2+SR**4*M3**2*M1**2-
     . SR**2*M3**2*M1**2-SR**2*M3**2*M1*M2-SR**2*M3*M1**2*
     . M2-SR**2*M3*M1*M2**2))/(M**2*M2**2+2.*M*SR**2*M3*M1*
     . M2+SR**4*M3**2*M1**2)
C
      CALL TRNSSR ( SBARS , AUXIR )
C
      REC32( 1)=1.0D+00/RE32
      REC32( 2)=0.0D+00
      REC32( 3)=-1.0D+00/RE32**2
      REC32( 4)=0.0D+00
      REC32( 5)=1.0D+00/RE32**3
      REC32( 6)=0.0D+00
      REC32( 7)=0.0D+00
      REC32( 8)=-1.0D+00/RE32**4
      REC32( 9)=0.0D+00
      REC32(10)=0.0D+00
      REC32(11)=0.0D+00
      REC32(12)=1.0D+00/RE32**5
      REC32(13)=0.0D+00
      REC32(14)=0.0D+00
      REC32(15)=0.0D+00
C
      CALL PLMLT2 ( REC32 , AUXIR  , AUXI2  )
C
      REC12( 1)=1.0D+00/RE12
      REC12( 2)=-1.0D+00/RE12**2
      REC12( 3)=0.0D+00
      REC12( 4)=1.0D+00/RE12**3
      REC12( 5)=0.0D+00
      REC12( 6)=0.0D+00
      REC12( 7)=-1.0D+00/RE12**4
      REC12( 8)=0.0D+00
      REC12( 9)=0.0D+00
      REC12(10)=0.0D+00
      REC12(11)=1.0D+00/RE12**5
      REC12(12)=0.0D+00
      REC12(13)=0.0D+00
      REC12(14)=0.0D+00
      REC12(15)=0.0D+00
C
      CALL PLMLT2 ( REC12 , AUXI2  , SBARR  )
C
C
      CALL PLMLT2 ( SBARR , AUXILI , DMPERP )
C
      RETURN
      END
C
C
      SUBROUTINE PLMLT2 ( FAC1 , FAC2 , PROD )
      IMPLICIT REAL*8 (A-H,O-Z)
C
      REAL*8   FAC1(15),FAC2(15),PROD(15)
C
      PA0    =   FAC1( 1)
      PA1    =   FAC1( 2)
      PA3    =   FAC1( 3)
      PA11   =   FAC1( 4)
      PA33   =   FAC1( 5)
      PA13   =   FAC1( 6)
      PA111  =   FAC1( 7)
      PA333  =   FAC1( 8)
      PA113  =   FAC1( 9)
      PA133  =   FAC1(10)
      PA1111 =   FAC1(11)
      PA3333 =   FAC1(12)
      PA1113 =   FAC1(13)
      PA1333 =   FAC1(14)
      PA1133 =   FAC1(15)
C
      PB0    =   FAC2( 1)
      PB1    =   FAC2( 2)
      PB3    =   FAC2( 3)
      PB11   =   FAC2( 4)
      PB33   =   FAC2( 5)
      PB13   =   FAC2( 6)
      PB111  =   FAC2( 7)
      PB333  =   FAC2( 8)
      PB113  =   FAC2( 9)
      PB133  =   FAC2(10)
      PB1111 =   FAC2(11)
      PB3333 =   FAC2(12)
      PB1113 =   FAC2(13)
      PB1333 =   FAC2(14)
      PB1133 =   FAC2(15)
C
      PROD( 1)=PA0*PB0
      PROD( 2)=PA0*PB1+PA1*PB0
      PROD( 3)=PA0*PB3+PA3*PB0
      PROD( 4)=PA0*PB11+PA1*PB1+PA11*PB0
      PROD( 5)=PA0*PB33+PA3*PB3+PA33*PB0
      PROD( 6)=PA0*PB13+PA1*PB3+PA13*PB0+PA3*PB1
      PROD( 7)=PA0*PB111+PA1*PB11+PA11*PB1+PA111*
     . PB0
      PROD( 8)=PA0*PB333+PA3*PB33+PA33*PB3+PA333*
     . PB0
      PROD( 9)=PA0*PB113+PA1*PB13+PA11*PB3+PA113*
     . PB0+PA13*PB1+PA3*PB11
      PROD(10)=PA0*PB133+PA1*PB33+PA13*PB3+PA133*
     . PB0+PA3*PB13+PA33*PB1
      PROD(11)=PA0*PB1111+PA1*PB111+PA11*PB11+PA111
     . *PB1+PA1111*PB0
      PROD(12)=PA0*PB3333+PA3*PB333+PA33*PB33+PA333
     . *PB3+PA3333*PB0
      PROD(13)=PA0*PB1113+PA1*PB113+PA11*PB13+PA111
     . *PB3+PA1113*PB0+PA113*PB1+PA13*PB11+PA3*
     . PB111
      PROD(14)=PA0*PB1333+PA1*PB333+PA13*PB33+PA133
     . *PB3+PA1333*PB0+PA3*PB133+PA33*PB13+PA333
     . *PB1
      PROD(15)=PA0*PB1133+PA1*PB133+PA11*PB33+PA113
     . *PB3+PA1133*PB0+PA13*PB13+PA133*PB1+PA3*
     . PB113+PA33*PB11
       RETURN
       END
C
C
      SUBROUTINE RECCOS ( COSREC )
      IMPLICIT REAL*8 (A-H,O-Z)
C             :
C DATE        : 18.02.1988
C AUTHOR      : PER JENSEN
C UPDATES     :
C LANGUAGE    : FORTRAN
C PURPOSE     : GENERATION OF THE EXPANSION COEFFICIENTS OF THE
C             : FACTORS COS(RHOBAR/2) AND SIN(RHOBAR/2).
C             : EXPANSION COEFFICIENTS FOR R SUB I'S ARE CALCULATED.
C             : THE CODE IS GENERATED BY REDUCE.
C             :
C SUBPROGRAMS :
C      CALLED :
C             :
C    FOR EXPLANATIONS OF ARRAY CONTENTS SEE COMMENTS IN
C    SUBROUTINE TRNSDP
C
C
      REAL*8   COSREC(15)
C
      COMMON /VALUES/ RHO,EPS,EPSP,EPSPP,EPSPPP,
     1               CR,SR,CSE,SNE,CRE,SRE,CORO
C
C
      COMMON/CRCOEF/
     1      CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
C
C
C***********************************************************************
C                                                           -1
C     GENERATE EXPANSION COEFFICIENTS FOR SQRT(2 COS RHOBAR)
C
C***********************************************************************
C
      FACTOR=1.0D+00/(1.0D+00+CR)
      PA1    = -FACTOR*CR1
      PA3    = -FACTOR*CR3
      PA11   = -FACTOR*CR11
      PA33   = -FACTOR*CR33
      PA13   = -FACTOR*CR13
      PA111  = -FACTOR*CR111
      PA333  = -FACTOR*CR333
      PA113  = -FACTOR*CR113
      PA133  = -FACTOR*CR133
      PA1111 = -FACTOR*CR1111
      PA3333 = -FACTOR*CR3333
      PA1113 = -FACTOR*CR1113
      PA1333 = -FACTOR*CR1333
      PA1133 = -FACTOR*CR1133
      FACTOR=1.0D+00/SQRT((1.0D+00+CR)*2.0D+00)
C
      COSREC( 1)=FACTOR
      COSREC( 2)=FACTOR*
     . (-PA1)/2.E0
      COSREC( 3)=FACTOR*
     . (-PA3)/2.E0
      COSREC( 4)=FACTOR*
     . (3.E0*PA1**2-4.E0*PA11)/8.E0
      COSREC( 5)=FACTOR*
     . (3.E0*PA3**2-4.E0*PA33)/8.E0
      COSREC( 6)=FACTOR*
     . (3.E0*PA1*PA3-2.E0*PA13)/4.E0
      COSREC( 7)=FACTOR*
     . (-5.E0*PA1**3+12.E0*PA1*PA11-8.E0*PA111)/16.E0
      COSREC( 8)=FACTOR*
     . (-5.E0*PA3**3+12.E0*PA3*PA33-8.E0*PA333)/16.E0
      COSREC( 9)=FACTOR*
     . (-15.E0*PA1**2*PA3+12.E0*PA1*PA13+12.E0*PA11*PA3-8.E0*PA113
     . )/16.E0
      COSREC(10)=FACTOR*
     . (-15.E0*PA1*PA3**2+12.E0*PA1*PA33+12.E0*PA13*PA3-8.E0*PA133
     . )/16.E0
      COSREC(11)=FACTOR*
     . (25.E0*PA1**4-120.*PA1**2*PA11+96.E0*PA1*PA111+48.E0*
     . PA11**2-64.E0*PA1111)/128.E0
      COSREC(12)=FACTOR*
     . (25.E0*PA3**4-120.*PA3**2*PA33+96.E0*PA3*PA333+48.E0*
     . PA33**2-64.E0*PA3333)/128.E0
      COSREC(13)=FACTOR*
     . (25.E0*PA1**3*PA3-30.*PA1**2*PA13-60.*PA1*PA11*PA3+
     . 24.E0*PA1*PA113+24.E0*PA11*PA13+24.E0*PA111*PA3-16.E0*
     . PA1113)/32.E0
      COSREC(14)=FACTOR*
     . (25.E0*PA1*PA3**3-60.*PA1*PA3*PA33+24.E0*PA1*PA333-30.
     . *PA13*PA3**2+24.E0*PA13*PA33+24.E0*PA133*PA3-16.E0*
     . PA1333)/32.E0
      COSREC(15)=FACTOR*
     . (75.E0*PA1**2*PA3**2-60.*PA1**2*PA33-120.*PA1*PA13*
     . PA3+48.E0*PA1*PA133-60.*PA11*PA3**2+48.E0*PA11*PA33+
     . 48.E0*PA113*PA3-32.E0*PA1133+24.E0*PA13**2)/64.E0
      RETURN
      END
C
C
      SUBROUTINE TRNSDP ( CINPUT , DPCOEF )
      IMPLICIT REAL*8 (A-H,O-Z)
C             :
C DATE        : 16.02.1988
C AUTHOR      : PER JENSEN
C UPDATES     :
C LANGUAGE    : FORTRAN
C PURPOSE     : TRANSFORMATION OF THE ELECTRONIC DIPOLE COMPONENTS
C             : FROM THE RHO BAR DEPENDENT FORM TO THE RHO
C             : DEPENDENT FORM.
C             : EXPANSION COEFFICIENTS FOR R SUB I'S ARE CALCULATED.
C             : THE CODE IS GENERATED BY REDUCE.
C             :
C SUBPROGRAMS :
C      CALLED :
C             :
C    THE ARRAY CONTAINS THE COEFFICIENTS OF THE FOLLOWING
C    QUANTITIES:
C                         I  THE ELEMENT CINPUT(I) IS THE
C                         I  COEFFICIENT OF:
C                         I
C                         I              J       K       L
C    I        DPCOEF(I)   I  I       CORO     DR1     DR3
C  -------------------------------------------------------------
C    1        1           I  1       0        0       0
C    2        R1          I  2       1        0       0
C    3        R3          I  3       2        0       0
C    4        R1**2       I  4       3        0       0
C    5        R3**2       I  5       4        0       0
C    6        R1*R3       I  6       5        0       0
C    7        R1**3       I  7       6        0       0
C    8        R3**3       I  8       7        0       0
C    9        R1**2*R3    I  9       8        0       0
C   10        R1*R3**2    I 10       0        1       0
C   11        R1**4       I 11       1        1       0
C   12        R3**4       I 12       2        1       0
C   13        R1**3*R3    I 13       3        1       0
C   14        R1*R3**3    I 14       4        1       0
C   15        R1**2*R3**2 I 15       0        0       1
C                         I 16       1        0       1
C                         I 17       2        0       1
C                         I 18       3        0       1
C                         I 19       4        0       1
C                         I 20       0        2       0
C                         I 21       1        2       0
C                         I 22       2        2       0
C                         I 23       3        2       0
C                         I 24       0        0       2
C                         I 25       1        0       2
C                         I 26       2        0       2
C                         I 27       3        0       2
C                         I 28       0        1       1
C                         I 29       1        1       1
C                         I 30       2        1       1
C                         I 31       3        1       1
C                         I 32       0        3       0
C                         I 33       1        3       0
C                         I 34       2        3       0
C                         I 35       0        0       3
C                         I 36       1        0       3
C                         I 37       2        0       3
C                         I 38       0        2       1
C                         I 39       1        2       1
C                         I 40       2        2       1
C                         I 41       0        1       2
C                         I 42       1        1       2
C                         I 43       2        1       2
C                         I 44       0        4       0
C                         I 45       1        4       0
C                         I 46       0        0       4
C                         I 47       1        0       4
C                         I 48       0        3       1
C                         I 49       1        3       1
C                         I 50       0        1       3
C                         I 51       1        1       3
C                         I 52       0        2       2
C                         I 53       1        2       2
C
      REAL*8 M1,M2,M3,M,U1,U3,U13,V,RHO,EPS,
     1      CR,SR,CSE,SNE,
     2      CRE,SRE,CORO,EPSP,EPSPP,EPSPPP
C
      REAL*8 AMASS(3,10)
C
      REAL*8 RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1       AA1,AA3,
     2       F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3       F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4       F13,F1A13,F2A13,F3A13,
     5       F111,F1A111,F2A111,F333,F1A333,F2A333,
     6       F113,F1A113,F2A113,F133,F1A133,F2A133,
     7       F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8       F1333,FA1333,F1133,FA1133,
     8       RE12 , RE32 , RHOREF , VMIN
C
      REAL*8 ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1      PREC
C
      REAL*8 THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1      THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2      VELLGT , PLANCK , AVOGNO , DEGRAD , RADDEG ,
     3      PI
C
      REAL*8   CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
      INTEGER NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5       NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6       NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7       NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6       ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7       IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8       NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER,
     9       ISOMAX , NATTS  , V0TYPE , IVAR(55) , PARMAX ,
     1       NUMPAR , PRTINT
C
      INTEGER V1 ,V2, V3 , V2MXP1, V2P1,
     1       NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2       NSEPP2 , NSEQP1 , MBASIS ,
     3       MDIM , NFSYM0, NFASY0, NFSYMJ, NFASYJ,
     4       KSTYPA(2) , LSTYPA(2) , JMAX , V2MAX , JMAXP1
C
      INTEGER IQUANT(5,10)
C
      LOGICAL SYMM
C
      REAL*8 RMK(2),AAS(2)
      INTEGER NOBAS,MBASP1,LENIW
      REAL*8  CORO2,CORO3,CORO4,CORO5,CORO6,CORO7,
     4       Q1,Q3,Q11,Q33,Q13,
     5       Q111,Q333,Q113,Q133,
     6       Q1111,Q3333,Q1113,Q1333,Q1133,
     7       DPCOEF(15),ANS1,CINPUT(53)
      COMMON /ISOTOP/ IQUANT,AMASS
C
      COMMON /VALUES/ RHO,EPS,EPSP,EPSPP,EPSPPP,
     1               CR,SR,CSE,SNE,CRE,SRE,CORO
C
      COMMON /MOLCUL/ RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1               AA1,AA3,
     2               F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3               F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4               F13,F1A13,F2A13,F3A13,
     5               F111,F1A111,F2A111,F333,F1A333,F2A333,
     6               F113,F1A113,F2A113,F133,F1A133,F2A133,
     7               F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8               F1333,FA1333,F1133,FA1133,
     8               RE12 , RE32 , M1 , M2 , M3 , M ,
     9               U1 , U3 , U13 , V ,
     1               SYMM
C
      COMMON /INTEG/  ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1               RHOREF , VMIN , V0TYPE ,
     1               NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2               NSEPP2 , NSEQP1 , KSTYPA , LSTYPA
C
      COMMON /DIMEN/  MBASIS ,  V2MAX  , V2MXP1 ,
     1               JMAX   , JMAXP1 , MDIM   , NFSYM0 , NFASY0 ,
     2               NFSYMJ , NFASYJ
C
      COMMON /LSFIT/  PARMAX , NUMPAR , ISOMAX , IVAR
C
      COMMON /SYS/    THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1                     THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2                     VELLGT , PLANCK , AVOGNO , PI , PREC ,
     4                     NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5                     NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6                     NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7                     NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6                     ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7                     IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8                     NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER ,
     9                       NATTS , PRTINT
C
C
      COMMON/CRCOEF/
     1      CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
C
      COMMON/MORSE/RMK,AAS
      COMMON/MODIM/NOBAS,MBASP1,LENIW
C
      Q0 =CINPUT( 1)
      Z01=CINPUT( 2)
      Z02=CINPUT( 3)
      Z03=CINPUT( 4)
      Z04=CINPUT( 5)
      Z05=CINPUT( 6)
      Z06=CINPUT( 7)
      Z07=CINPUT( 8)
      Z08=CINPUT( 9)
      Z1A  = CINPUT(10)
      Z1A1 = CINPUT(11)
      Z1A2 = CINPUT(12)
      Z1A3 = CINPUT(13)
      Z1A4 = CINPUT(14)
      Z3A  = CINPUT(15)
      Z3A1 = CINPUT(16)
      Z3A2 = CINPUT(17)
      Z3A3 = CINPUT(18)
      Z3A4 = CINPUT(19)
      Z11A  = CINPUT(20)
      Z11A1 = CINPUT(21)
      Z11A2 = CINPUT(22)
      Z11A3 = CINPUT(23)
      Z33A  = CINPUT(24)
      Z33A1 = CINPUT(25)
      Z33A2 = CINPUT(26)
      Z33A3 = CINPUT(27)
      Z13A  = CINPUT(28)
      Z13A1 = CINPUT(29)
      Z13A2 = CINPUT(30)
      Z13A3 = CINPUT(31)
      Z111A  = CINPUT(32)
      Z111A1 = CINPUT(33)
      Z111A2 = CINPUT(34)
      Z333A  = CINPUT(35)
      Z333A1 = CINPUT(36)
      Z333A2 = CINPUT(37)
      Z113A  = CINPUT(38)
      Z113A1 = CINPUT(39)
      Z113A2 = CINPUT(40)
      Z133A  = CINPUT(41)
      Z133A1 = CINPUT(42)
      Z133A2 = CINPUT(43)
      Z1111   = CINPUT(44)
      Z1111A  = CINPUT(45)
      Z3333   = CINPUT(46)
      Z3333A  = CINPUT(47)
      Z1113   = CINPUT(48)
      Z1113A  = CINPUT(49)
      Z1333   = CINPUT(50)
      Z1333A  = CINPUT(51)
      Z1133   = CINPUT(52)
      Z1133A  = CINPUT(53)
      CORO2=CORO*CORO
      CORO3=CORO2*CORO
      CORO4=CORO3*CORO
      CORO5=CORO4*CORO
      CORO6=CORO5*CORO
      CORO7=CORO6*CORO
      Q1=CORO*(8.E0*CORO6*Z08+7.E0*CORO5*Z07+6.E0*CORO4*Z06+5.E0*
     1 CORO3*Z05+4.E0*CORO2*Z04+3.E0*CORO*Z03+2.E0*Z02)*CR1
     2 +Z01*CR1
      Q3=CORO*(8.E0*CORO6*Z08+7.E0*CORO5*Z07+6.E0*CORO4*Z06+5.E0*
     1 CORO3*Z05+4.E0*CORO2*Z04+3.E0*CORO*Z03+2.E0*Z02)*CR3
     2 +Z01*CR3
      Q11=8.E0*CR11*CORO7*Z08+7.E0*CR11*CORO6*Z07+6.E0*CR11*CORO**
     1 5*Z06+5.E0*CR11*CORO4*Z05+4.E0*CR11*CORO3*Z04+3.E0*CR11*
     1 CORO2*Z03+2.E0*CR11*CORO*Z02+28.E0*CR1**2*CORO6*Z08+21.E0*
     1 CR1**2*CORO5*Z07+15.E0*CR1**2*CORO4*Z06+10.E0*CR1**2*CORO
     1 **3*Z05+6.E0*CR1**2*CORO2*Z04+3.E0*CR1**2*CORO*Z03+CR1**2*
     1 Z02+Z01*CR11
      Q33=8.E0*CR33*CORO7*Z08+7.E0*CR33*CORO6*Z07+6.E0*CR33*CORO**
     1 5*Z06+5.E0*CR33*CORO4*Z05+4.E0*CR33*CORO3*Z04+3.E0*CR33*
     1 CORO2*Z03+2.E0*CR33*CORO*Z02+28.E0*CR3**2*CORO6*Z08+21.E0*
     1 CR3**2*CORO5*Z07+15.E0*CR3**2*CORO4*Z06+10.E0*CR3**2*CORO
     1 **3*Z05+6.E0*CR3**2*CORO2*Z04+3.E0*CR3**2*CORO*Z03+CR3**2*
     1 Z02+Z01*CR33
      Q13=8.E0*CR13*CORO7*Z08+7.E0*CR13*CORO6*Z07+6.E0*CR13*CORO**
     1 5*Z06+5.E0*CR13*CORO4*Z05+4.E0*CR13*CORO3*Z04+3.E0*CR13*
     1 CORO2*Z03+2.E0*CR13*CORO*Z02+56.E0*CR3*CR1*CORO6*Z08+42.E0*
     1 CR3*CR1*CORO5*Z07+30.E0*CR3*CR1*CORO4*Z06+20.E0*CR3*CR1*
     1 CORO3*Z05+12.E0*CR3*CR1*CORO2*Z04+6.E0*CR3*CR1*CORO*Z03+
     1 2.E0*CR3*CR1*Z02+Z01*CR13
      Q111=8.E0*CR111*CORO7*Z08+7.E0*CR111*CORO6*Z07+6.E0*CR111*
     1 CORO5*Z06+5.E0*CR111*CORO4*Z05+4.E0*CR111*CORO3*Z04+3.E0*
     1 CR111*CORO2*Z03+2.E0*CR111*CORO*Z02+56.E0*CR11*CR1*CORO6*
     1 Z08+42.E0*CR11*CR1*CORO5*Z07+30.E0*CR11*CR1*CORO4*Z06+20.E0
     1 *CR11*CR1*CORO3*Z05+12.E0*CR11*CR1*CORO2*Z04+6.E0*CR11*
     1 CR1*CORO*Z03+2.E0*CR11*CR1*Z02+56.E0*CR1**3*CORO5*Z08+35.E0*
     1 CR1**3*CORO4*Z07+20.E0*CR1**3*CORO3*Z06+10.E0*CR1**3*CORO
     1 **2*Z05+4.E0*CR1**3*CORO*Z04+CR1**3*Z03+Z01*CR111
      Q333=8.E0*CR333*CORO7*Z08+7.E0*CR333*CORO6*Z07+6.E0*CR333*
     1 CORO5*Z06+5.E0*CR333*CORO4*Z05+4.E0*CR333*CORO3*Z04+3.E0*
     1 CR333*CORO2*Z03+2.E0*CR333*CORO*Z02+56.E0*CR33*CR3*CORO6*
     1 Z08+42.E0*CR33*CR3*CORO5*Z07+30.E0*CR33*CR3*CORO4*Z06+20.E0
     1 *CR33*CR3*CORO3*Z05+12.E0*CR33*CR3*CORO2*Z04+6.E0*CR33*
     1 CR3*CORO*Z03+2.E0*CR33*CR3*Z02+56.E0*CR3**3*CORO5*Z08+35.E0*
     1 CR3**3*CORO4*Z07+20.E0*CR3**3*CORO3*Z06+10.E0*CR3**3*CORO
     1 **2*Z05+4.E0*CR3**3*CORO*Z04+CR3**3*Z03+Z01*CR333
      Q113=8.E0*CR113*CORO7*Z08+7.E0*CR113*CORO6*Z07+6.E0*CR113*
     1 CORO5*Z06+5.E0*CR113*CORO4*Z05+4.E0*CR113*CORO3*Z04+3.E0*
     1 CR113*CORO2*Z03+2.E0*CR113*CORO*Z02+56.E0*CR13*CR1*CORO6*
     1 Z08+42.E0*CR13*CR1*CORO5*Z07+30.E0*CR13*CR1*CORO4*Z06+20.E0
     1 *CR13*CR1*CORO3*Z05+12.E0*CR13*CR1*CORO2*Z04+6.E0*CR13*
     1 CR1*CORO*Z03+2.E0*CR13*CR1*Z02+56.E0*CR11*CR3*CORO6*Z08+42.E0
     1 *CR11*CR3*CORO5*Z07+30.E0*CR11*CR3*CORO4*Z06+20.E0*CR11*
     1 CR3*CORO3*Z05+12.E0*CR11*CR3*CORO2*Z04+6.E0*CR11*CR3*CORO
     1 *Z03+2.E0*CR11*CR3*Z02+168.E0*CR3*CR1**2*CORO5*Z08+105.E0*CR3
     1 *CR1**2*CORO4*Z07+60.E0*CR3*CR1**2*CORO3*Z06+30.E0*CR3*
     1 CR1**2*CORO2*Z05+12.E0*CR3*CR1**2*CORO*Z04+3.E0*CR3*CR1**2*
     1 Z03+Z01*CR113
      Q133=8.E0*CR133*CORO7*Z08+7.E0*CR133*CORO6*Z07+6.E0*CR133*
     1 CORO5*Z06+5.E0*CR133*CORO4*Z05+4.E0*CR133*CORO3*Z04+3.E0*
     1 CR133*CORO2*Z03+2.E0*CR133*CORO*Z02+56.E0*CR13*CR3*CORO6*
     1 Z08+42.E0*CR13*CR3*CORO5*Z07+30.E0*CR13*CR3*CORO4*Z06+20.E0
     1 *CR13*CR3*CORO3*Z05+12.E0*CR13*CR3*CORO2*Z04+6.E0*CR13*
     1 CR3*CORO*Z03+2.E0*CR13*CR3*Z02+56.E0*CR33*CR1*CORO6*Z08+42.E0
     1 *CR33*CR1*CORO5*Z07+30.E0*CR33*CR1*CORO4*Z06+20.E0*CR33*
     1 CR1*CORO3*Z05+12.E0*CR33*CR1*CORO2*Z04+6.E0*CR33*CR1*CORO
     1 *Z03+2.E0*CR33*CR1*Z02+168.E0*CR3**2*CR1*CORO5*Z08+105.E0*CR3
     1 **2*CR1*CORO4*Z07+60.E0*CR3**2*CR1*CORO3*Z06+30.E0*CR3**2
     1 *CR1*CORO2*Z05+12.E0*CR3**2*CR1*CORO*Z04+3.E0*CR3**2*CR1*
     1 Z03+Z01*CR133
      Q1111=8.E0*CR1111*CORO7*Z08+7.E0*CR1111*CORO6*Z07+6.E0*
     1 CR1111*CORO5*Z06+5.E0*CR1111*CORO4*Z05+4.E0*CR1111*CORO**
     1 3*Z04+3.E0*CR1111*CORO2*Z03+2.E0*CR1111*CORO*Z02+56.E0*CR111*
     1 CR1*CORO6*Z08+42.E0*CR111*CR1*CORO5*Z07+30.E0*CR111*CR1*
     1 CORO4*Z06+20.E0*CR111*CR1*CORO3*Z05+12.E0*CR111*CR1*CORO
     1 **2*Z04+6.E0*CR111*CR1*CORO*Z03+2.E0*CR111*CR1*Z02+28.E0*CR11**
     1 2*CORO6*Z08+21.E0*CR11**2*CORO5*Z07+15.E0*CR11**2*CORO4
     1 *Z06+10.E0*CR11**2*CORO3*Z05+6.E0*CR11**2*CORO2*Z04+3.E0*
     1 CR11**2*CORO*Z03+CR11**2*Z02+168.E0*CR11*CR1**2*CORO5*Z08
     1 +105.E0*CR11*CR1**2*CORO4*Z07+60.E0*CR11*CR1**2*CORO3*Z06
     1 +30.E0*CR11*CR1**2*CORO2*Z05+12.E0*CR11*CR1**2*CORO*Z04+3.E0*
     1 CR11*CR1**2*Z03+70.E0*CR1**4*CORO4*Z08+35.E0*CR1**4*CORO3
     1 *Z07+15.E0*CR1**4*CORO2*Z06+5.E0*CR1**4*CORO*Z05+CR1**4*Z04
     1 +Z01*CR1111
      Q3333=8.E0*CR3333*CORO7*Z08+7.E0*CR3333*CORO6*Z07+6.E0*
     1 CR3333*CORO5*Z06+5.E0*CR3333*CORO4*Z05+4.E0*CR3333*CORO**
     1 3*Z04+3.E0*CR3333*CORO2*Z03+2.E0*CR3333*CORO*Z02+56.E0*CR333*
     1 CR3*CORO6*Z08+42.E0*CR333*CR3*CORO5*Z07+30.E0*CR333*CR3*
     1 CORO4*Z06+20.E0*CR333*CR3*CORO3*Z05+12.E0*CR333*CR3*CORO
     1 **2*Z04+6.E0*CR333*CR3*CORO*Z03+2.E0*CR333*CR3*Z02+28.E0*CR33**
     1 2*CORO6*Z08+21.E0*CR33**2*CORO5*Z07+15.E0*CR33**2*CORO4
     1 *Z06+10.E0*CR33**2*CORO3*Z05+6.E0*CR33**2*CORO2*Z04+3.E0*
     1 CR33**2*CORO*Z03+CR33**2*Z02+168.E0*CR33*CR3**2*CORO5*Z08
     1 +105.E0*CR33*CR3**2*CORO4*Z07+60.E0*CR33*CR3**2*CORO3*Z06
     1 +30.E0*CR33*CR3**2*CORO2*Z05+12.E0*CR33*CR3**2*CORO*Z04+3.E0*
     1 CR33*CR3**2*Z03+70.E0*CR3**4*CORO4*Z08+35.E0*CR3**4*CORO3
     1 *Z07+15.E0*CR3**4*CORO2*Z06+5.E0*CR3**4*CORO*Z05+CR3**4*Z04
     1 +Z01*CR3333
      ANS1=280.E0*CR3*CR1**3*CORO4*Z08+140.E0*CR3*CR1**3*CORO3*
     1 Z07+60.E0*CR3*CR1**3*CORO2*Z06+20.E0*CR3*CR1**3*CORO*Z05+4.E0
     1 *CR3*CR1**3*Z04
      Q1113=8.E0*CR1113*CORO7*Z08+7.E0*CR1113*CORO6*Z07+6.E0*
     1 CR1113*CORO5*Z06+5.E0*CR1113*CORO4*Z05+4.E0*CR1113*CORO**
     1 3*Z04+3.E0*CR1113*CORO2*Z03+2.E0*CR1113*CORO*Z02+56.E0*CR113*
     1 CR1*CORO6*Z08+42.E0*CR113*CR1*CORO5*Z07+30.E0*CR113*CR1*
     1 CORO4*Z06+20.E0*CR113*CR1*CORO3*Z05+12.E0*CR113*CR1*CORO
     1 **2*Z04+6.E0*CR113*CR1*CORO*Z03+2.E0*CR113*CR1*Z02+56.E0*CR111*
     1 CR3*CORO6*Z08+42.E0*CR111*CR3*CORO5*Z07+30.E0*CR111*CR3*
     1 CORO4*Z06+20.E0*CR111*CR3*CORO3*Z05+12.E0*CR111*CR3*CORO
     1 **2*Z04+6.E0*CR111*CR3*CORO*Z03+2.E0*CR111*CR3*Z02+56.E0*CR13*
     1 CR11*CORO6*Z08+42.E0*CR13*CR11*CORO5*Z07+30.E0*CR13*CR11*
     1 CORO4*Z06+20.E0*CR13*CR11*CORO3*Z05+12.E0*CR13*CR11*CORO
     1 **2*Z04+6.E0*CR13*CR11*CORO*Z03+2.E0*CR13*CR11*Z02+168.E0*CR13*
     1 CR1**2*CORO5*Z08+105.E0*CR13*CR1**2*CORO4*Z07+60.E0*CR13*
     1 CR1**2*CORO3*Z06+30.E0*CR13*CR1**2*CORO2*Z05+12.E0*CR13*
     1 CR1**2*CORO*Z04+3.E0*CR13*CR1**2*Z03+336.E0*CR11*CR3*CR1*CORO
     1 **5*Z08+210.E0*CR11*CR3*CR1*CORO4*Z07+120.E0*CR11*CR3*CR1*
     1 CORO3*Z06+60.E0*CR11*CR3*CR1*CORO2*Z05+24.E0*CR11*CR3*CR1
     1 *CORO*Z04+6.E0*CR11*CR3*CR1*Z03+ANS1+Z01*CR1113
      ANS1=280.E0*CR3**3*CR1*CORO4*Z08+140.E0*CR3**3*CR1*CORO3*
     1 Z07+60.E0*CR3**3*CR1*CORO2*Z06+20.E0*CR3**3*CR1*CORO*Z05+4.E0
     1 *CR3**3*CR1*Z04
      Q1333=8.E0*CR1333*CORO7*Z08+7.E0*CR1333*CORO6*Z07+6.E0*
     1 CR1333*CORO5*Z06+5.E0*CR1333*CORO4*Z05+4.E0*CR1333*CORO**
     1 3*Z04+3.E0*CR1333*CORO2*Z03+2.E0*CR1333*CORO*Z02+56.E0*CR133*
     1 CR3*CORO6*Z08+42.E0*CR133*CR3*CORO5*Z07+30.E0*CR133*CR3*
     1 CORO4*Z06+20.E0*CR133*CR3*CORO3*Z05+12.E0*CR133*CR3*CORO
     1 **2*Z04+6.E0*CR133*CR3*CORO*Z03+2.E0*CR133*CR3*Z02+56.E0*CR333*
     1 CR1*CORO6*Z08+42.E0*CR333*CR1*CORO5*Z07+30.E0*CR333*CR1*
     1 CORO4*Z06+20.E0*CR333*CR1*CORO3*Z05+12.E0*CR333*CR1*CORO
     1 **2*Z04+6.E0*CR333*CR1*CORO*Z03+2.E0*CR333*CR1*Z02+56.E0*CR13*
     1 CR33*CORO6*Z08+42.E0*CR13*CR33*CORO5*Z07+30.E0*CR13*CR33*
     1 CORO4*Z06+20.E0*CR13*CR33*CORO3*Z05+12.E0*CR13*CR33*CORO
     1 **2*Z04+6.E0*CR13*CR33*CORO*Z03+2.E0*CR13*CR33*Z02+168.E0*CR13*
     1 CR3**2*CORO5*Z08+105.E0*CR13*CR3**2*CORO4*Z07+60.E0*CR13*
     1 CR3**2*CORO3*Z06+30.E0*CR13*CR3**2*CORO2*Z05+12.E0*CR13*
     1 CR3**2*CORO*Z04+3.E0*CR13*CR3**2*Z03+336.E0*CR33*CR3*CR1*CORO
     1 **5*Z08+210.E0*CR33*CR3*CR1*CORO4*Z07+120.E0*CR33*CR3*CR1*
     1 CORO3*Z06+60.E0*CR33*CR3*CR1*CORO2*Z05+24.E0*CR33*CR3*CR1
     1 *CORO*Z04+6.E0*CR33*CR3*CR1*Z03+ANS1+Z01*CR1333
      ANS1=168.E0*CR33*CR1**2*CORO5*Z08+105.E0*CR33*CR1**2*CORO4
     1 *Z07+60.E0*CR33*CR1**2*CORO3*Z06+30.E0*CR33*CR1**2*CORO2*
     1 Z05+12.E0*CR33*CR1**2*CORO*Z04+3.E0*CR33*CR1**2*Z03+168.E0*CR11
     1 *CR3**2*CORO5*Z08+105.E0*CR11*CR3**2*CORO4*Z07+60.E0*CR11
     1 *CR3**2*CORO3*Z06+30.E0*CR11*CR3**2*CORO2*Z05+12.E0*CR11*
     1 CR3**2*CORO*Z04+3.E0*CR11*CR3**2*Z03+420.E0*CR3**2*CR1**2*
     1 CORO4*Z08+210.E0*CR3**2*CR1**2*CORO3*Z07+90.E0*CR3**2*CR1
     1 **2*CORO2*Z06+30.E0*CR3**2*CR1**2*CORO*Z05+6.E0*CR3**2*CR1
     1 **2*Z04
      Q1133=8.E0*CR1133*CORO7*Z08+7.E0*CR1133*CORO6*Z07+6.E0*
     1 CR1133*CORO5*Z06+5.E0*CR1133*CORO4*Z05+4.E0*CR1133*CORO**
     1 3*Z04+3.E0*CR1133*CORO2*Z03+2.E0*CR1133*CORO*Z02+56.E0*CR133*
     1 CR1*CORO6*Z08+42.E0*CR133*CR1*CORO5*Z07+30.E0*CR133*CR1*
     1 CORO4*Z06+20.E0*CR133*CR1*CORO3*Z05+12.E0*CR133*CR1*CORO
     1 **2*Z04+6.E0*CR133*CR1*CORO*Z03+2.E0*CR133*CR1*Z02+56.E0*CR113*
     1 CR3*CORO6*Z08+42.E0*CR113*CR3*CORO5*Z07+30.E0*CR113*CR3*
     1 CORO4*Z06+20.E0*CR113*CR3*CORO3*Z05+12.E0*CR113*CR3*CORO2
     1 *Z04+6.E0*CR113*CR3*CORO*Z03+2.E0*CR113*CR3*Z02+28.E0*CR13**
     1 2*CORO6*Z08+21.E0*CR13**2*CORO5*Z07+15.E0*CR13**2*CORO4
     1 *Z06+10.E0*CR13**2*CORO3*Z05+6.E0*CR13**2*CORO2*Z04+3.E0*
     1 CR13**2*CORO*Z03+CR13**2*Z02+336.E0*CR13*CR3*CR1*CORO5*
     1 Z08+210.E0*CR13*CR3*CR1*CORO4*Z07+120.E0*CR13*CR3*CR1*CORO3
     1 *Z06+60.E0*CR13*CR3*CR1*CORO2*Z05+24.E0*CR13*CR3*CR1*
     1 CORO*Z04+6.E0*CR13*CR3*CR1*Z03+56.E0*CR33*CR11*CORO6*Z08+
     1 42.E0*CR33*CR11*CORO5*Z07+30.E0*CR33*CR11*CORO4*Z06+20.E0*
     1 CR33*CR11*CORO3*Z05+12.E0*CR33*CR11*CORO2*Z04+6.E0*CR33*
     1 CR11*CORO*Z03+2.E0*CR33*CR11*Z02+ANS1+Z01*CR1133
C
      C1=CR1
      C3=CR3
      C11=CR11
      C33=CR33
      C13=CR13
      C111=CR111
      C333=CR333
      C113=CR113
      C133=CR133
C
      W1=CORO**4*Z1A4+CORO**3*Z1A3+CORO**2*Z1A2+CORO*Z1A1+Z1A
      W3=CORO**4*Z3A4+CORO**3*Z3A3+CORO**2*Z3A2+CORO*Z3A1+Z3A
      W11=4.E0*CORO**3*C1*Z1A4+CORO**3*Z11A3+3.E0*CORO**2*C1*Z1A3+
     . CORO**2*Z11A2+2.E0*CORO*C1*Z1A2+CORO*Z11A1+C1*Z1A1+Z11A
      W33=4.E0*CORO**3*C3*Z3A4+CORO**3*Z33A3+3.E0*CORO**2*C3*Z3A3+
     . CORO**2*Z33A2+2.E0*CORO*C3*Z3A2+CORO*Z33A1+C3*Z3A1+Z33A
      W13=4.E0*CORO**3*C1*Z3A4+4.E0*CORO**3*C3*Z1A4+CORO**3*Z13A3+
     . 3.E0*CORO**2*C1*Z3A3+3.E0*CORO**2*C3*Z1A3+CORO**2*Z13A2+2.E0*
     . CORO*C1*Z3A2+2.E0*CORO*C3*Z1A2+CORO*Z13A1+C1*Z3A1+C3*Z1A1+
     . Z13A
      W111=4.E0*CORO**3*C11*Z1A4+6.E0*CORO**2*C1**2*Z1A4+3.E0*CORO**
     . 2*C1*Z11A3+3.E0*CORO**2*C11*Z1A3+CORO**2*Z111A2+3.E0*CORO*C1
     . **2*Z1A3+2.E0*CORO*C1*Z11A2+2.E0*CORO*C11*Z1A2+CORO*Z111A1+C1
     . **2*Z1A2+C1*Z11A1+C11*Z1A1+Z111A
      W333=4.E0*CORO**3*C33*Z3A4+6.E0*CORO**2*C3**2*Z3A4+3.E0*CORO**
     . 2*C3*Z33A3+3.E0*CORO**2*C33*Z3A3+CORO**2*Z333A2+3.E0*CORO*C3
     . **2*Z3A3+2.E0*CORO*C3*Z33A2+2.E0*CORO*C33*Z3A2+CORO*Z333A1+C3
     . **2*Z3A2+C3*Z33A1+C33*Z3A1+Z333A
      W113=4.E0*CORO**3*C11*Z3A4+4.E0*CORO**3*C13*Z1A4+6.E0*CORO**2*
     . C1**2*Z3A4+12.E0*CORO**2*C1*C3*Z1A4+3.E0*CORO**2*C1*Z13A3+3.E0*
     . CORO**2*C11*Z3A3+3.E0*CORO**2*C13*Z1A3+3.E0*CORO**2*C3*Z11A3+
     . CORO**2*Z113A2+3.E0*CORO*C1**2*Z3A3+6.E0*CORO*C1*C3*Z1A3+2.E0*
     . CORO*C1*Z13A2+2.E0*CORO*C11*Z3A2+2.E0*CORO*C13*Z1A2+2.E0*CORO*
     . C3*Z11A2+CORO*Z113A1+C1**2*Z3A2+2.E0*C1*C3*Z1A2+C1*Z13A1+
     . C11*Z3A1+C13*Z1A1+C3*Z11A1+Z113A
      W133=4.E0*CORO**3*C13*Z3A4+4.E0*CORO**3*C33*Z1A4+12.E0*CORO**2
     . *C1*C3*Z3A4+3.E0*CORO**2*C1*Z33A3+3.E0*CORO**2*C13*Z3A3+6.E0*
     . CORO**2*C3**2*Z1A4+3.E0*CORO**2*C3*Z13A3+3.E0*CORO**2*C33*
     . Z1A3+CORO**2*Z133A2+6.E0*CORO*C1*C3*Z3A3+2.E0*CORO*C1*Z33A2+
     . 2.E0*CORO*C13*Z3A2+3.E0*CORO*C3**2*Z1A3+2.E0*CORO*C3*Z13A2+
     . 2.E0*
     . CORO*C33*Z1A2+CORO*Z133A1+2.E0*C1*C3*Z3A2+C1*Z33A1+C13*Z3A1
     . +C3**2*Z1A2+C3*Z13A1+C33*Z1A1+Z133A
      W1111=4.E0*CORO**3*C111*Z1A4+12.E0*CORO**2*C1*C11*Z1A4+3.E0*
     . CORO**2*C11*Z11A3+3.E0*CORO**2*C111*Z1A3+4.E0*CORO*C1**3*Z1A4
     . +3.E0*CORO*C1**2*Z11A3+6.E0*CORO*C1*C11*Z1A3+2.E0*CORO*C1*
     . Z111A2+2.E0*CORO*C11*Z11A2+2.E0*CORO*C111*Z1A2+CORO*Z1111A +
     . C1**3*Z1A3+C1**2*Z11A2+2.E0*C1*C11*Z1A2+C1*Z111A1+C11*Z11A1
     . +C111*Z1A1+Z1111
      W3333=4.E0*CORO**3*C333*Z3A4+12.E0*CORO**2*C3*C33*Z3A4+3.E0*
     . CORO**2*C33*Z33A3+3.E0*CORO**2*C333*Z3A3+4.E0*CORO*C3**3*Z3A4
     . +3.E0*CORO*C3**2*Z33A3+6.E0*CORO*C3*C33*Z3A3+2.E0*CORO*C3*
     . Z333A2+2.E0*CORO*C33*Z33A2+2.E0*CORO*C333*Z3A2+CORO*Z3333A +
     . C3**3*Z3A3+C3**2*Z33A2+2.E0*C3*C33*Z3A2+C3*Z333A1+C33*Z33A1
     . +C333*Z3A1+Z3333
      W1113=4.E0*CORO**3*C111*Z3A4+4.E0*CORO**3*C113*Z1A4+12.E0*CORO
     . **2*C1*C11*Z3A4+12.E0*CORO**2*C1*C13*Z1A4+12.E0*CORO**2*C11*
     . C3*Z1A4+3.E0*CORO**2*C11*Z13A3+3.E0*CORO**2*C111*Z3A3+3.E0*CORO
     . **2*C113*Z1A3+3.E0*CORO**2*C13*Z11A3+4.E0*CORO*C1**3*Z3A4+12.E0
     . *CORO*C1**2*C3*Z1A4+3.E0*CORO*C1**2*Z13A3+6.E0*CORO*C1*C11*
     . Z3A3+6.E0*CORO*C1*C13*Z1A3+6.E0*CORO*C1*C3*Z11A3+2.E0*CORO*C1*
     . Z113A2+6.E0*CORO*C11*C3*Z1A3+2.E0*CORO*C11*Z13A2+2.E0*CORO*C111
     . *Z3A2+2.E0*CORO*C113*Z1A2+2.E0*CORO*C13*Z11A2+2.E0*CORO*C3*
     . Z111A2+CORO*Z1113A +C1**3*Z3A3+3.E0*C1**2*C3*Z1A3+C1**2*
     . Z13A2+2.E0*C1*C11*Z3A2+2.E0*C1*C13*Z1A2+2.E0*C1*C3*Z11A2+C1*
     . Z113A1+2.E0*C11*C3*Z1A2+C11*Z13A1+C111*Z3A1+C113*Z1A1+C13*
     . Z11A1+C3*Z111A1+Z1113
      W1333=4.E0*CORO**3*C133*Z3A4+4.E0*CORO**3*C333*Z1A4+12.E0*CORO
     . **2*C1*C33*Z3A4+12.E0*CORO**2*C13*C3*Z3A4+3.E0*CORO**2*C13*
     . Z33A3+3.E0*CORO**2*C133*Z3A3+12.E0*CORO**2*C3*C33*Z1A4+3.E0*
     . CORO**2*C33*Z13A3+3.E0*CORO**2*C333*Z1A3+12.E0*CORO*C1*C3**2*
     . Z3A4+6.E0*CORO*C1*C3*Z33A3+6.E0*CORO*C1*C33*Z3A3+2.E0*CORO*C1*
     . Z333A2+6.E0*CORO*C13*C3*Z3A3+2.E0*CORO*C13*Z33A2+2.E0*CORO*C133
     . *Z3A2+4.E0*CORO*C3**3*Z1A4+3.E0*CORO*C3**2*Z13A3+6.E0*CORO*C3*
     . C33*Z1A3+2.E0*CORO*C3*Z133A2+2.E0*CORO*C33*Z13A2+2.E0*CORO*C333
     . *Z1A2+CORO*Z1333A +3.E0*C1*C3**2*Z3A3+2.E0*C1*C3*Z33A2+2.E0*C1*
     . C33*Z3A2+C1*Z333A1+2.E0*C13*C3*Z3A2+C13*Z33A1+C133*Z3A1+C3
     . **3*Z1A3+C3**2*Z13A2+2.E0*C3*C33*Z1A2+C3*Z133A1+C33*Z13A1+
     . C333*Z1A1+Z1333
      W1133=4.E0*CORO**3*C113*Z3A4+4.E0*CORO**3*C133*Z1A4+12.E0*CORO
     . **2*C1*C13*Z3A4+12.E0*CORO**2*C1*C33*Z1A4+12.E0*CORO**2*C11*
     . C3*Z3A4+3.E0*CORO**2*C11*Z33A3+3.E0*CORO**2*C113*Z3A3+12.E0*
     . CORO**2*C13*C3*Z1A4+3.E0*CORO**2*C13*Z13A3+3.E0*CORO**2*C133*
     . Z1A3+3.E0*CORO**2*C33*Z11A3+12.E0*CORO*C1**2*C3*Z3A4+3.E0*CORO*
     . C1**2*Z33A3+6.E0*CORO*C1*C13*Z3A3+12.E0*CORO*C1*C3**2*Z1A4+6.E0
     . *CORO*C1*C3*Z13A3+6.E0*CORO*C1*C33*Z1A3+2.E0*CORO*C1*Z133A2+
     . 6.E0*CORO*C11*C3*Z3A3+2.E0*CORO*C11*Z33A2+2.E0*CORO*C113*
     . Z3A2+6.E0
     . *CORO*C13*C3*Z1A3+2.E0*CORO*C13*Z13A2+2.E0*CORO*C133*Z1A2+3.E0*
     . CORO*C3**2*Z11A3+2.E0*CORO*C3*Z113A2+2.E0*CORO*C33*Z11A2+CORO
     . *Z1133A +3.E0*C1**2*C3*Z3A3+C1**2*Z33A2+2.E0*C1*C13*Z3A2+3.E0*
     . C1*C3**2*Z1A3+2.E0*C1*C3*Z13A2+2.E0*C1*C33*Z1A2+C1*Z133A1+2.E0*
     . C11*C3*Z3A2+C11*Z33A1+C113*Z3A1+2.E0*C13*C3*Z1A2+C13*Z13A1+
     . C133*Z1A1+C3**2*Z11A2+C3*Z113A1+C33*Z11A1+Z1133
C
      DPCOEF(1)=Q0+Z01*CORO+Z02*CORO2+Z03*CORO3+Z04*CORO4
     .            +Z05*CORO5+Z06*CORO6+Z07*CORO7+Z08*CORO7*CORO
      DPCOEF(2)=Q1+W1
      DPCOEF(3)=Q3+W3
      DPCOEF(4)=Q11+W11
      DPCOEF(5)=Q33+W33
      DPCOEF(6)=Q13+W13
      DPCOEF(7)=Q111+W111
      DPCOEF(8)=Q333+W333
      DPCOEF(9)=Q113+W113
      DPCOEF(10)=Q133+W133
      DPCOEF(11)=Q1111+W1111
      DPCOEF(12)=Q3333+W3333
      DPCOEF(13)=Q1113+W1113
      DPCOEF(14)=Q1333+W1333
      DPCOEF(15)=Q1133+W1133
      RETURN
      END
C
C
      DOUBLE PRECISION   FUNCTION CLG(J,DJ,K,DK)
      IMPLICIT REAL*8   (A-H,O-Z)
      INTEGER DJ,DK
      CLG=0
      IF ((ABS(DJ).GT.1) .OR. (ABS(DK).GT.1)) RETURN
      IOPT=DJ+2
      IF (DK .NE.0) THEN
          IF (DK.EQ.-1) K=-K
          GOTO (10,20,30),IOPT
10        X= FLOAT((J-K-1)*(J-K))/ FLOAT(2*J*(2*J+1))
          X=SQRT(X)
          GOTO 40
20        X=0.0D+00
          IF (J.NE.0) X= FLOAT((J+K+1)*(J-K))/ FLOAT(2*J*(J+1))
          X=-SQRT(X)
          GOTO 40
30        X= FLOAT((J+K+1)*(J+K+2))/ FLOAT((2*J+1)*(2*J+2))
          X=SQRT(X)
40        CONTINUE
          IF (DK.EQ.-1) THEN
              K=-K
              X=-((-1)**DJ)*X
          ENDIF
      ELSE
          GOTO (70,80,90),IOPT
70        X= FLOAT((J-K)*(J+K))/ FLOAT(J*(2*J+1))
          X=-SQRT(X)
          GOTO 100
80        X=0.0D+00
          IF (J.NE.0) X= FLOAT(K) / SQRT(FLOAT(J*(J+1)))
          GOTO 100
90        X= FLOAT((J-K+1)*(J+K+1))/ FLOAT((2*J+1)*(J+1))
          X=SQRT(X)
100       CONTINUE
      ENDIF
      CLG=X
      RETURN
      END
