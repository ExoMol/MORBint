      SUBROUTINE GENSTR (                            IW1    ,
     1                   IW3    , OVER   , TMAT   , ESTR   ,
     1                   SMAT   , VMAT   , WMAT   , NOPERS )
      IMPLICIT REAL*8 (A-H,O-Z)
C
      REAL*8 M1,M2,M3,M,U1,U3,U13,V,RHO,EPS,
     1      CR,SR,CSE,SNE,
     2      CRE,SRE,CORO,EPSP,EPSPP,EPSPPP
C
      REAL*8 AMASS(3,10)
C
      REAL*8 RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1       AA1,AA3,
     2       F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3       F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4       F13,F1A13,F2A13,F3A13,
     5       F111,F1A111,F2A111,F333,F1A333,F2A333,
     6       F113,F1A113,F2A113,F133,F1A133,F2A133,
     7       F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8       F1333,FA1333,F1133,FA1133,
     8       RE12 , RE32 , RHOREF , VMIN
C
      REAL*8 ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1      PREC
C
      REAL*8 THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1      THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2      VELLGT , PLANCK , AVOGNO , DEGRAD , RADDEG ,
     3      PI
C
      REAL*8   B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      REAL*8   CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
      INTEGER NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 , NFIL6 ,
     5       NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6       NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7       NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6       ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7       IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8       NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER,
     9       ISOMAX , NATTS  , V0TYPE , IVAR(55) , PARMAX ,
     1       NUMPAR , PRTINT
C
      INTEGER V1 ,V2, V3 , V2MXP1, V2P1,
     1       NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2       NSEPP2 , NSEQP1 , MBASIS ,
     3       MDIM , NFSYM0, NFASY0, NFSYMJ, NFASYJ,
     4       KSTYPA(2) , LSTYPA(2) , JMAX , V2MAX , JMAXP1
C
      INTEGER IQUANT(5,10)
C
      LOGICAL SYMM
C
      REAL*8 RMK(2),AAS(2)
      INTEGER NOBAS,MBASP1,LENIW
      INTEGER        IOSC1,IOSC3,I,J,IR,JL
      REAL*8 G,GC1,GC3,GC1113,GC3133,GC1133,GC3113
      INTEGER IW1(LENIW),IW3(LENIW),V2L,V2R,ISTA1,ISTA3,IJMP1,
     1       IJMP3,IR1,IR3,IR11,IR33,IR13,IR111,IR333,IR113,IR133,
     2       IR1111,IR3333,IR1113,IR1333,IR1133,
     3       IV1,IV3,IV11,IV33,IV13,IV111,IV333,IV113,IV133,
     4       IV1111,IV3333,IV1113,IV1333,IV1133,
     5       IG0,IG1,IG3,IG11,IG33,IG13,
     6       IC11,IC33,IC13,IC31,IC111,IC333,IC133,IC311,
     7       IC113,IC313,IC1111,IC3333,IC1333,IC3111,IC1113,
     8       IC3133,IC1133,IC3113
      INTEGER INDEXL,INDEXR,IOFFS,JOFFS,INDVVP,INDPVV,
     1       LABELA,LABELB,LABELC,LVP1,LVP3,LPV1,LPV3,
     2       LVP11,LVP33,LPV11,LPV33,LVP13,LPV13,
     3       LVP111,LVP333,LPV111,LPV333,LVP113,LPV113,
     4       LVP133,LPV133,LABVVP,LABPVV
      INTEGER DIMA,KSTYP1,KSTYP2,LSTYP1,LSTYP2,IOFFSA,JOFFSA,
     1       IOFFSB,JOFFSB
      REAL*8                                     OVER(2,MBASP1,MBASP1),
     1       ESTR(NOBAS),TMAT(NOBAS,NOBAS),
     1       SMAT(NOBAS,NOBAS,NOPERS),WMAT(NOBAS,NOBAS),
     1       VMAT(NOBAS,NOBAS)
      REAL*8  CONCOR,CONFC1,CONG11,CONG33,CONG13,CORHOE
      COMMON /ISOTOP/ IQUANT,AMASS
C
      COMMON /VALUES/ RHO,EPS,EPSP,EPSPP,EPSPPP,
     1               CR,SR,CSE,SNE,CRE,SRE,CORO
C
      COMMON /MOLCUL/ RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1               AA1,AA3,
     2               F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3               F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4               F13,F1A13,F2A13,F3A13,
     5               F111,F1A111,F2A111,F333,F1A333,F2A333,
     6               F113,F1A113,F2A113,F133,F1A133,F2A133,
     7               F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8               F1333,FA1333,F1133,FA1133,
     8               RE12 , RE32 , M1 , M2 , M3 , M ,
     9               U1 , U3 , U13 , V ,
     1               SYMM
C
      COMMON /INTEG/  ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1               RHOREF , VMIN , V0TYPE ,
     1               NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2               NSEPP2 , NSEQP1 , KSTYPA , LSTYPA
C
      COMMON /DIMEN/  MBASIS ,  V2MAX  , V2MXP1 ,
     1               JMAX   , JMAXP1 , MDIM   , NFSYM0 , NFASY0 ,
     2               NFSYMJ , NFASYJ
C
      COMMON /LSFIT/  PARMAX , NUMPAR , ISOMAX , IVAR
C
      COMMON /SYS/    THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1                     THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2                     VELLGT , PLANCK , AVOGNO , PI , PREC ,
     4                     NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5                     NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6                     NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7                     NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6                     ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7                     IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8                     NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER ,
     9                       NATTS , PRTINT
C
      COMMON/BCOEFF/
     1      B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      COMMON/CRCOEF/
     1      CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
C
      COMMON/MORSE/RMK,AAS
      COMMON/MODIM/NOBAS,MBASP1,LENIW
C
      KSTYP1=KSTYPA(1)
      KSTYP2=KSTYPA(2)
      LSTYP1=LSTYPA(1)
      LSTYP2=LSTYPA(2)
      DIMA=V2MXP1*LSTYP1
      IOSC1=1
      IOSC3=2
      IF ( SYMM ) IOSC3=1
C
C 1. GENERATE MATRIX OF Y1
C
      KNDEX=1
      CALL YONLY(IOSC1,IW1,IW3,OVER,VMAT)
      CALL SIMTRN (VMAT,TMAT,SMAT(1,1,KNDEX),WMAT,NOBAS)
C
C  2. GENERATE MATRIX OF Y3
C
      KNDEX=KNDEX+1
      CALL YONLY(IOSC3,IW3,IW1,OVER,VMAT)
      CALL SIMTRN (VMAT,TMAT,SMAT(1,1,KNDEX),WMAT,NOBAS)
C
C  3. GENERATE MATRIX OF Y1*Y1
C
      KNDEX=KNDEX+1
      CALL YY(IOSC1,IW1,IW3,OVER,VMAT)
      CALL SIMTRN (VMAT,TMAT,SMAT(1,1,KNDEX),WMAT,NOBAS)
C
C  4. GENERATE MATRIX OF Y3*Y3
C
      KNDEX=KNDEX+1
      CALL YY(IOSC3,IW3,IW1,OVER,VMAT)
      CALL SIMTRN (VMAT,TMAT,SMAT(1,1,KNDEX),WMAT,NOBAS)
C
C   5. GENERATE MATRIX OF Y1*Y3
C
      KNDEX=KNDEX+1
      CALL Y1Y2(IOSC1,IOSC3,IW1,IW3,OVER,VMAT)
      CALL SIMTRN (VMAT,TMAT,SMAT(1,1,KNDEX),WMAT,NOBAS)
C
C  6. GENERATE MATRIX OF Y1*Y1*Y1
C
      KNDEX=KNDEX+1
      CALL YYY(IOSC1,IW1,IW3,OVER,VMAT)
      CALL SIMTRN (VMAT,TMAT,SMAT(1,1,KNDEX),WMAT,NOBAS)
C
C  7. GENERATE MATRIX OF Y3*Y3*Y3
C
      KNDEX=KNDEX+1
      CALL YYY(IOSC3,IW3,IW1,OVER,VMAT)
      CALL SIMTRN(VMAT,TMAT,SMAT(1,1,KNDEX),WMAT,NOBAS)
C
C  8. GENERATE MATRIX OF Y1*Y1*Y3
C
      KNDEX=KNDEX+1
      CALL Y1Y1Y2(IOSC1,IOSC3,IW1,IW3,OVER,VMAT)
      CALL SIMTRN (VMAT,TMAT,SMAT(1,1,KNDEX),WMAT,NOBAS)
C
C  9. GENERATE MATRIX OF Y1*Y3*Y3
C
      KNDEX=KNDEX+1
      CALL Y1Y1Y2(IOSC3,IOSC1,IW3,IW1,OVER,VMAT)
      CALL SIMTRN (VMAT,TMAT,SMAT(1,1,KNDEX),WMAT,NOBAS)
C
C  10. GENERATE MATRIX OF Y1*Y1*Y1*Y1
C
      KNDEX=KNDEX+1
      CALL YYYY(IOSC1,IW1,IW3,OVER,VMAT)
      CALL SIMTRN (VMAT,TMAT,SMAT(1,1,KNDEX),WMAT,NOBAS)
C
C  11. GENERATE MATRIX OF Y3*Y3*Y3*Y3
C
      KNDEX=KNDEX+1
      CALL YYYY(IOSC3,IW3,IW1,OVER,VMAT)
      CALL SIMTRN (VMAT,TMAT,SMAT(1,1,KNDEX),WMAT,NOBAS)
C
C  12. GENERATE MATRIX OF Y1*Y1*Y1*Y3
C
      KNDEX=KNDEX+1
      CALL Y13Y2(IOSC1,IOSC3,IW1,IW3,OVER,VMAT)
      CALL SIMTRN (VMAT,TMAT,SMAT(1,1,KNDEX),WMAT,NOBAS)
C
C  13. GENERATE MATRIX OF Y1*Y3*Y3*Y3
C
      KNDEX=KNDEX+1
      CALL Y13Y2(IOSC3,IOSC1,IW3,IW1,OVER,VMAT)
      CALL SIMTRN (VMAT,TMAT,SMAT(1,1,KNDEX),WMAT,NOBAS)
C
C  14. GENERATE MATRIX OF Y1*Y1*Y3*Y3
C
      KNDEX=KNDEX+1
      CALL Y12Y22(IOSC1,IOSC3,IW1,IW3,OVER,VMAT)
      CALL SIMTRN (VMAT,TMAT,SMAT(1,1,KNDEX),WMAT,NOBAS)
C
C  15. GENERATE MATRIX OF Y1*P1+P1*Y1
C
      KNDEX=KNDEX+1
      CALL YP(IOSC1,IW1,IW3,OVER,VMAT)
      CALL SIMTRN (VMAT,TMAT,SMAT(1,1,KNDEX),WMAT,NOBAS)
C
C  16. GENERATE MATRIX OF Y3*P3+P3*Y3
C
      KNDEX=KNDEX+1
      CALL YP(IOSC3,IW3,IW1,OVER,VMAT)
      CALL SIMTRN (VMAT,TMAT,SMAT(1,1,KNDEX),WMAT,NOBAS)
C
C  17. GENERATE MATRIX OF P1*Y3
C
      KNDEX=KNDEX+1
      CALL P1Y2(IOSC1,IOSC3,IW1,IW3,OVER,VMAT)
      CALL SIMTRN (VMAT,TMAT,SMAT(1,1,KNDEX),WMAT,NOBAS)
C
C  18. GENERATE MATRIX OF P3*Y1
C
      KNDEX=KNDEX+1
      CALL P1Y2(IOSC3,IOSC1,IW3,IW1,OVER,VMAT)
      CALL SIMTRN (VMAT,TMAT,SMAT(1,1,KNDEX),WMAT,NOBAS)
C
C  19. GENERATE MATRIX OF Y1*Y1*P1+P1*Y1*Y1
C
      KNDEX=KNDEX+1
      CALL Y2P(IOSC1,IW1,IW3,OVER,VMAT)
      CALL SIMTRN (VMAT,TMAT,SMAT(1,1,KNDEX),WMAT,NOBAS)
C
C  20. GENERATE MATRIX OF Y3*Y3*P3+P3*Y3*Y3
C
      KNDEX=KNDEX+1
      CALL Y2P(IOSC3,IW3,IW1,OVER,VMAT)
      CALL SIMTRN (VMAT,TMAT,SMAT(1,1,KNDEX),WMAT,NOBAS)
C
C  21. GENERATE MATRIX OF P1*Y3*Y3
C
      KNDEX=KNDEX+1
      CALL P1Y2Y2(IOSC1,IOSC3,IW1,IW3,OVER,VMAT)
      CALL SIMTRN (VMAT,TMAT,SMAT(1,1,KNDEX),WMAT,NOBAS)
C
C  22. GENERATE MATRIX OF P3*Y1*Y1
C
      KNDEX=KNDEX+1
      CALL P1Y2Y2(IOSC3,IOSC1,IW3,IW1,OVER,VMAT)
      CALL SIMTRN (VMAT,TMAT,SMAT(1,1,KNDEX),WMAT,NOBAS)
C
C  23. GENERATE MATRIX OF (Y1*P1+P1*Y1)*Y3
C
      KNDEX=KNDEX+1
      CALL YPY(IOSC1,IOSC3,IW1,IW3,OVER,VMAT)
      CALL SIMTRN (VMAT,TMAT,SMAT(1,1,KNDEX),WMAT,NOBAS)
C
C  24. GENERATE MATRIX OF (Y3*P3+P3*Y3)*Y1
C
      KNDEX=KNDEX+1
      CALL YPY(IOSC3,IOSC1,IW3,IW1,OVER,VMAT)
      CALL SIMTRN (VMAT,TMAT,SMAT(1,1,KNDEX),WMAT,NOBAS)
C
C  25. GENERATE MATRIX OF Y1*Y1*Y1*P1+P1*Y1*Y1*Y1
C
      KNDEX=KNDEX+1
      CALL Y3P(IOSC1,IW1,IW3,OVER,VMAT)
      CALL SIMTRN (VMAT,TMAT,SMAT(1,1,KNDEX),WMAT,NOBAS)
C
C  26. GENERATE MATRIX OF Y3*Y3*Y3*P3+P3*Y3*Y3*Y3
C
      KNDEX=KNDEX+1
      CALL Y3P(IOSC3,IW3,IW1,OVER,VMAT)
      CALL SIMTRN (VMAT,TMAT,SMAT(1,1,KNDEX),WMAT,NOBAS)
C
C  27. GENERATE MATRIX OF P1*Y3*Y3*Y3
C
      KNDEX=KNDEX+1
      CALL PY3(IOSC1,IOSC3,IW1,IW3,OVER,VMAT)
      CALL SIMTRN (VMAT,TMAT,SMAT(1,1,KNDEX),WMAT,NOBAS)
C
C  28. GENERATE MATRIX OF P3*Y1*Y1*Y1
C
      KNDEX=KNDEX+1
      CALL PY3(IOSC3,IOSC1,IW3,IW1,OVER,VMAT)
      CALL SIMTRN (VMAT,TMAT,SMAT(1,1,KNDEX),WMAT,NOBAS)
C
C  29. GENERATE MATRIX OF (Y1*Y1*P1+P1*Y1*Y1)*Y3
C
      KNDEX=KNDEX+1
      CALL Y2PY(IOSC1,IOSC3,IW1,IW3,OVER,VMAT)
      CALL SIMTRN (VMAT,TMAT,SMAT(1,1,KNDEX),WMAT,NOBAS)
C
C  30. GENERATE MATRIX OF (Y3*Y3*P3+P3*Y3*Y3)*Y1
C
      KNDEX=KNDEX+1
      CALL Y2PY(IOSC3,IOSC1,IW3,IW1,OVER,VMAT)
      CALL SIMTRN (VMAT,TMAT,SMAT(1,1,KNDEX),WMAT,NOBAS)
C
C  31. GENERATE MATRIX OF (Y1*P1+P1*Y1)*Y3*Y3
C
      KNDEX=KNDEX+1
      CALL YPY2(IOSC1,IOSC3,IW1,IW3,OVER,VMAT)
      CALL SIMTRN (VMAT,TMAT,SMAT(1,1,KNDEX),WMAT,NOBAS)
C
C  32. GENERATE MATRIX OF (Y3*P3+P3*Y3)*Y1
C
      KNDEX=KNDEX+1
      CALL YPY2(IOSC3,IOSC1,IW3,IW1,OVER,VMAT)
      CALL SIMTRN (VMAT,TMAT,SMAT(1,1,KNDEX),WMAT,NOBAS)
C
C  33. GENERATE MATRIX OF P1*P3
C
      KNDEX=KNDEX+1
      CALL P1P2(IOSC1,IOSC3,IW1,IW3,OVER,VMAT)
      CALL SIMTRN (VMAT,TMAT,SMAT(1,1,KNDEX),WMAT,NOBAS)
C
C  34. GENERATE MATRIX OF (Y1*P1+P1*Y1)*P3
C
      KNDEX=KNDEX+1
      CALL PYYPP(IOSC1,IOSC3,IW1,IW3,OVER,VMAT)
      CALL SIMTRN (VMAT,TMAT,SMAT(1,1,KNDEX),WMAT,NOBAS)
C
C  35. GENERATE MATRIX OF (Y3*P3+P3*Y3)*P1
C
      KNDEX=KNDEX+1
      CALL PYYPP(IOSC3,IOSC1,IW3,IW1,OVER,VMAT)
      CALL SIMTRN (VMAT,TMAT,SMAT(1,1,KNDEX),WMAT,NOBAS)
C
C  36. GENERATE MATRIX OF (Y1*Y1*P1+P1*Y1*Y1)*P3
C
      KNDEX=KNDEX+1
      CALL YYPP(IOSC1,IOSC3,IW1,IW3,OVER,VMAT)
      CALL SIMTRN (VMAT,TMAT,SMAT(1,1,KNDEX),WMAT,NOBAS)
C
C  37. GENERATE MATRIX OF (Y3*Y3*P3+P3*Y3*Y3)*P1
C
      KNDEX=KNDEX+1
      CALL YYPP(IOSC3,IOSC1,IW3,IW1,OVER,VMAT)
      CALL SIMTRN (VMAT,TMAT,SMAT(1,1,KNDEX),WMAT,NOBAS)
C
C  38. GENERATE MATRIX OF (Y1*P1+P1*Y1)*(Y3*P3+P3*Y3)
C
      KNDEX=KNDEX+1
      CALL YPPY(IOSC1,IOSC3,IW1,IW3,OVER,VMAT)
      CALL SIMTRN (VMAT,TMAT,SMAT(1,1,KNDEX),WMAT,NOBAS)
C
C
C
      RETURN
      END
C
C
      SUBROUTINE SIMTRN ( A , U , B , W , N )
      IMPLICIT REAL*8 (A-H,O-Z)
      INTEGER N,I,J,K
      REAL*8 A(N,N),U(N,N),B(N,N),W(N,N),POM
C
      DO 20 I=1,N
      DO 20 J=1,N
      POM=0.0E0
      DO 10 K=1,N
10    POM=POM+U(K,I)*A(K,J)
20    W(J,I)=POM
C
      DO 40 I=1,N
      DO 40 J=1,N
      POM=0.0E0
      DO 30 K=1,N
30    POM=POM+W(K,I)*U(K,J)
40    B(I,J)=POM
C
      RETURN
      END
C
C
C
      SUBROUTINE HOUSQL(NDIM,N,A,D,E,MAXIT,IFAIL)
C PURPOSE:  DIAGONALIZES A SYMMETRICAL, REAL*8 MATRIX.
C CALL:     CALL HOUSQL(N,A,D,E,MAXIT,IFAIL)
C FORMAL PARAMETERS:
C         INTEGER N,IFAIL
C         REAL*8 A(NDIM,NDIM),D(NDIM),E(NDIM)
C INPUT/OUTPUT:
C     NDIM  DIMENSION OF THE ACTUAL ARRAY A USED IN THE CALL.
C     N     ORDER OF THE MATRIX.
C     A     MATRIX TO BE DIAGONALIZED. ONLY THE LOWER TRIANGLE IS USED.
C           CONTAINS ON RETURN THE EIGENVECTORS AS COLUMNS IN THE
C           ORDER OF THE CORRESPONDING EIGENVALUES.
C     D     CONTAINS ON RETURN THE EIGENVALUES IN INCREASING ORDER.
C     E     WORK AREA, MUST BE DECLARED IN THE CALLING SEGMENT.
C     MAXIT MAXIMUM NUMBER OF ITERATIONS ALLOWED IN THE QL CALCULATION.
C     IFAIL RETURN VALUE, =0 IF THE DIAGONALIZATION HAS REQUIRED LESS TH
C     THAN
C           MAXIT ITERATIONS, =1 IF MAXIT ITERATIONS HAVE BEEN CARRIED
C     OUT
C           WITHOUT CONVERGENCE.
C COMMENTS: USES HOUSHOLDERS TRIDIAGONALIZATION FOLLOWED BY THE
C           QL METHOD.
C AUTHOR:   TRANSLATION AND CONCATENATION OF 'TRED' OG 'TQL2'
C           BY S.BRODERSEN 1981.
C REFS:     WILKINSON & RHEINSCH 217-218 OG 233-234.

      IMPLICIT REAL*8 (A-H,O-Z)
      INTEGER NDIM,N,IFAIL,MAXIT
      REAL*8 A(NDIM,NDIM),D(NDIM),E(NDIM),F,G,H,HH,MACHEPS,
     1      B,C,P,R,S,TOL
      IFAIL=0
      MACHEPS=2.0D0**(-47)
      TOL=2.0D0**(47-1024)
      DO 10 I=N,2,-1
      L=I-2
      F=A(I,I-1)
      G=0.0E0
      DO 1000 K=1,L
1000  G=G+A(I,K)* A(I,K)
      H=G+F*F
      IF(G .LE. TOL) THEN
      E(I)=F
      H=0.0E0
      GOTO 10
      ENDIF
      L=L+1
      IF (F .GE. 0.0E0) THEN
      E(I)=-SQRT(H)
      ELSE
      E(I)=SQRT(H)
      ENDIF
      G=E(I)
      H=H-F*G
      A(I,I-1)=F-G
      F=0.0E0
      DO 1300 J=1,L
      A(J,I)=A(I,J)/H
      G=0.0E0
      DO 1100 K=1,J
1100  G=G+A(J,K)*A(I,K)
      DO 1200 K=(J+1),L
1200  G=G+A(K,J)*A(I,K)
      E(J)=G/H
      F=F+G*A(J,I)
1300  CONTINUE
      HH=F/(H+H)
      DO 1500 J=1,L
      F=A(I,J)
      E(J)=E(J)-HH*F
      G=E(J)
      DO 1400 K=1,J
1400  A(J,K)=A(J,K)-F*E(K)-G*A(I,K)
1500  CONTINUE
10    D(I)=H

      E(1)=0.0E0
      D(1)=0.0E0
      DO 2000 I=1,N
      L=I-1
      IF (D(I) .NE. 0.0E0) THEN
      DO 1800 J=1,L
      G=0.0E0
      DO 1600 K=1,L
1600  G=G+A(I,K)*A(K,J)
      DO 1700 K=1,L
1700  A(K,J)=A(K,J)-G*A(K,I)
1800  CONTINUE
      ENDIF
      D(I)=A(I,I)
      A(I,I)=1.0E0
      DO 1900 J=1,L
      A(J,I)=0.0E0
      A(I,J)=0.0E0
1900  CONTINUE
2000  CONTINUE
      DO 2100 I=2,N
2100  E(I-1)=E(I)
      E(N)=0.0E0
      B=0.0E0
      F=0.0E0
      JJ=0
      DO 30 L=1,N
      J=0
      H=MACHEPS*(ABS(D(L))+ABS(E(L)))
      IF (B .LT. H) B=H
      DO 2200 M=L,N
      IF (ABS(E(M)) .LE. B) GOTO 35
2200  CONTINUE
35    IF (M .EQ. L)  GOTO 30
40    IF (J .EQ. MAXIT) THEN
      IFAIL=1
      RETURN
      ENDIF
      J=J+1
      JJ=JJ+1
      G=D(L)
      P=(D(L+1)-G)/(2.0E0*E(L))
      R=SQRT(P**2+1)
      IF (P .LT. 0.0E0) THEN
      D(L)=E(L)/(P-R)
      ELSE
      D(L)=E(L)/(P+R)
      ENDIF
      H=G-D(L)
      DO 2300 I=L+1,N
2300  D(I)=D(I)-H
      F=F+H
      P=D(M)
      C=1.0E0
      S=0.0E0
      DO 2500 I=M-1,L,-1
      G=C*E(I)
      H=C*P
      IF (ABS(P) .GE. ABS(E(I))) THEN
      C=E(I)/P
      R=SQRT(C**2+1.0E0)
      E(I+1)=S*P*R
      S=C/R
      C=1.0E0/R
      ELSE
      C=P/E(I)
      R=SQRT(C**2+1)
      E(I+1)=S*E(I)*R
      S=1.0E0/R
      C=C/R
      ENDIF
      P=C*D(I)-S*G
      D(I+1)=H+S*(C*G+S*D(I))
      DO 2400 K=1,N
      H=A(K,I+1)
      A(K,I+1)=S*A(K,I)+C*H
2400  A(K,I)=C*A(K,I)-S*H
2500  CONTINUE
      E(L)=S*P
      D(L)=C*P
      IF(ABS(E(L)) .GT. B) GOTO 40
30    D(L)=D(L)+F
      DO 2800 I=1,N
      K=I
      P=D(I)
      DO 2600 J=I+1,N
      IF (D(J) .LT. P) THEN
      K=J
      P=D(J)
      ENDIF
2600  CONTINUE
      IF (K .NE. I) THEN
      D(K)=D(I)
      D(I)=P
      DO 2700 J=1,N
      P=A(J,I)
      A(J,I)=A(J,K)
      A(J,K)=P
2700  CONTINUE
      ENDIF
2800  CONTINUE
      RETURN
      END
C
C
      SUBROUTINE U0VIB ( UVIVAL )
C            :
C DATE       : 28.04.1986
C AUTHOR     : PER JENSEN
C UPDATES    :  CHANGED FROM G MATRIX CALCULATING ROUTINE TO U0VIB
C            :  CALCULATING ROUTINE 20.03.87
C LANGUAGE   : FORTRAN
C PURPOSE    : CALCULATION OF THE EXPANSION COEFFICIENTS OF THE G
C            : MATRIX ELEMENTS IN TERMS OF THE DELTA R I'S.
C            : THE CODE IS GENERATED BY REDUCE.
C            :  THE G MATRIX ELEMENTS ARE USED TO CALCULATE THE
C            :  LEADING (STRETCH INDEPENDENT) CONTRIBUTION TO THE
C            :  U0 PSEUDO POTENTIAL.
C            :
      IMPLICIT REAL*8 (A-H,O-Z)
      REAL*8 M1,M2,M3,M,U1,U3,U13,V,RHO,EPS,
     1      CR,SR,CSE,SNE,
     2      CRE,SRE,CORO,EPSP,EPSPP,EPSPPP
C
      REAL*8 AMASS(3,10)
C
      REAL*8 RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1       AA1,AA3,
     2       F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3       F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4       F13,F1A13,F2A13,F3A13,
     5       F111,F1A111,F2A111,F333,F1A333,F2A333,
     6       F113,F1A113,F2A113,F133,F1A133,F2A133,
     7       F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8       F1333,FA1333,F1133,FA1133,
     8       RE12 , RE32 , RHOREF , VMIN
C
      REAL*8 ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1      PREC
C
      REAL*8 THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1      THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2      VELLGT , PLANCK , AVOGNO , DEGRAD , RADDEG ,
     3      PI
C
      REAL*8   B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      REAL*8   CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
      INTEGER NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 , NFIL6 ,
     5       NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6       NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7       NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6       ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7       IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8       NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER,
     9       ISOMAX , NATTS  , V0TYPE , IVAR(55) , PARMAX ,
     1       NUMPAR , PRTINT
C
      INTEGER V1 ,V2, V3 , V2MXP1, V2P1,
     1       NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2       NSEPP2 , NSEQP1 , MBASIS ,
     3       MDIM , NFSYM0, NFASY0, NFSYMJ, NFASYJ,
     4       KSTYPA(2) , LSTYPA(2) , JMAX , V2MAX , JMAXP1
C
      INTEGER IQUANT(5,10)
C
      LOGICAL SYMM
C
      REAL*8 RMK(2),AAS(2)
      INTEGER NOBAS,MBASP1,LENIW
      COMMON /ISOTOP/ IQUANT,AMASS
C
      COMMON /VALUES/ RHO,EPS,EPSP,EPSPP,EPSPPP,
     1               CR,SR,CSE,SNE,CRE,SRE,CORO
C
      COMMON /MOLCUL/ RHOE,FA1,FA2,FA3,FA4,FA5,FA6,FA7,FA8,
     1               AA1,AA3,
     2               F1A1,F2A1,F3A1,F4A1,F1A3,F2A3,F3A3,F4A3,
     3               F11,F1A11,F2A11,F3A11,F33,F1A33,F2A33,F3A33,
     4               F13,F1A13,F2A13,F3A13,
     5               F111,F1A111,F2A111,F333,F1A333,F2A333,
     6               F113,F1A113,F2A113,F133,F1A133,F2A133,
     7               F1111,FA1111,F3333,FA3333,F1113,FA1113,
     8               F1333,FA1333,F1133,FA1133,
     8               RE12 , RE32 , M1 , M2 , M3 , M ,
     9               U1 , U3 , U13 , V ,
     1               SYMM
C
      COMMON /INTEG/  ETRIAL , RHOMAX , PNM1 , HBASE , HSTEP , EGUESS ,
     1               RHOREF , VMIN , V0TYPE ,
     1               NSTINT , NSERIN , NSERP , NSERQ , KQUA , NTEST ,
     2               NSEPP2 , NSEQP1 , KSTYPA , LSTYPA
C
      COMMON /DIMEN/  MBASIS ,  V2MAX  , V2MXP1 ,
     1               JMAX   , JMAXP1 , MDIM   , NFSYM0 , NFASY0 ,
     2               NFSYMJ , NFASYJ
C
      COMMON /LSFIT/  PARMAX , NUMPAR , ISOMAX , IVAR
C
      COMMON /SYS/    THRSH1 , THRSH2 , THRSH3 , THRSH4 , THRSH5 ,
     1                     THRSH6 , THRSH7 , THRSH8 , THRSH9 , THRSHX ,
     2                     VELLGT , PLANCK , AVOGNO , PI , PREC ,
     4                     NFIL1 , NFIL2 , NFIL3 , NFIL4 , NFIL5 ,
     5                     NFIL6 , NFIL7 , NFIL8 , NFIL9 , NFIL10 ,
     6                     NFIL11 , NFIL12 , NFIL13 , NFIL14 , NFIL15 ,
     7                     NFIL16 , NFIL17 , NFIL18 , NFIL19 , NFIL20 ,
     6                     ITEST  , IPRINT , NSTNR , NSTNIN , IREST ,
     7                     IISOT , IQUAS , ISYMS , NISOT , NQUAS ,
     8                     NUMQUA , NOPTIT , NOPTIM , IOBSER , NOBSER ,
     9                       NATTS , PRTINT
C
      COMMON/BCOEFF/
     1      B11,B13,B111,B133,B113,
     2      B1111,B1333,B1113,B1133,
     3      B11111,B13333,B11113,B11333,B11133,
     4      B31,B33,B311,B333,B313,
     5      B3111,B3333,B3113,B3133,
     6      B31111,B33333,B31113,B31333,B31133
C
      COMMON/CRCOEF/
     1      CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
C
      COMMON/MORSE/RMK,AAS
      COMMON/MODIM/NOBAS,MBASP1,LENIW
      A11=2.E0*RE12
      A13=0.E0
      A111=(V**2-SR**2*U13**2+2.E0*SR**2*U3*U1)/(V**2+2.E0*V*SR**2*
     1 U13+SR**4*U13**2)
      A133=(SR**2*U3**2*RE12**2)/((V**2+2.E0*V*SR**2*U13+SR**4*U13
     1 **2)*RE32**2)
      A113=(2.E0*SR**2*U13*U3*CR*RE12)/((V**2+2.E0*V*SR**2*U13+SR**4
     1 *U13**2)*RE32)
      A31=0.E0
      A33=2.E0*RE32
      A311=(SR**2*U1**2*RE32**2)/((V**2+2.E0*V*SR**2*U13+SR**4*U13
     1 **2)*RE12**2)
      A333=(V**2-SR**2*U13**2+2.E0*SR**2*U3*U1)/(V**2+2.E0*V*SR**2*
     1 U13+SR**4*U13**2)
      A313=(2.E0*SR**2*U13*U1*CR*RE32)/((V**2+2.E0*V*SR**2*U13+SR**4
     1 *U13**2)*RE12)
      G110=1.0D+00/M1 + 1.0D+00/M2
      G130=-CR/M2
      G310=-CR/M2
      G330=1.0D+00/M3 + 1.0D+00/M2
      G11=G110
      G13=G130
      G31=G310
      G33=G330
      G111=(2.D0*G13*A133*B31+G13*B11*A113+2.D0*G11*B11*A111+G11*B31
     X *A113-2.D0*G11)/RE12
      G113=(2.D0*G13*A133*B33+G13*B13*A113+2.D0*G11*B13*A111+G11*B33
     X *A113)/RE12
      G1111=(8.D0*G13*A133*B311*RE12+8.D0*G13*A133*B11*A111*B31+4.D0*
     X G13*A133*B31**2*A113-16.D0*G13*A133*B31+4.D0*G13*B111*RE12*
     X A113+4.D0*G13*B11**2*A111*A113+2.D0*G13*B11*B31*A113**2-8.D0*
     X G13*B11*A113+4.D0*G33*A133**2*B31**2+4.D0*G33*A133*B11*B31*
     X A113+G33*B11**2*A113**2+8.D0*G11*B111*RE12*A111+4.D0*G11*B311
     X *RE12*A113+4.D0*G11*B11**2*A111**2+4.D0*G11*B11*A111*B31*A113
     X -16.D0*G11*B11*A111+G11*B31**2*A113**2-8.D0*G11*B31*A113+12.D0*
     X G11)/(4.D0*RE12**2)
      G1133=(8.D0*G13*A133*B333*RE12+8.D0*G13*A133*B13*B33*A111+4.D0*
     X G13*A133*B33**2*A113+4.D0*G13*B133*RE12*A113+4.D0*G13*B13**2*
     X A111*A113+2.D0*G13*B13*B33*A113**2+4.D0*G33*A133**2*B33**2+4.D0
     X *G33*A133*B13*B33*A113+G33*B13**2*A113**2+8.D0*G11*B133*
     X RE12*A111+4.D0*G11*B333*RE12*A113+4.D0*G11*B13**2*A111**2+4.D0*
     X G11*B13*B33*A111*A113+G11*B33**2*A113**2)/(4.D0*RE12**2)
      G1113=(4.D0*G13*A133*B313*RE12+4.D0*G13*A133*B13*A111*B31+4.D0*
     X G13*A133*B33*B11*A111+4.D0*G13*A133*B33*B31*A113-8.D0*G13*
     X A133*B33+2.D0*G13*B113*RE12*A113+4.D0*G13*B13*B11*A111*A113+
     X G13*B13*B31*A113**2-4.D0*G13*B13*A113+G13*B33*B11*A113**2+
     X 4.D0*G33*A133**2*B33*B31+2.D0*G33*A133*B13*B31*A113+2.D0*G33*
     X A133*B33*B11*A113+G33*B13*B11*A113**2+4.D0*G11*B113*RE12*
     X A111+2.D0*G11*B313*RE12*A113+4.D0*G11*B13*B11*A111**2+2.D0*G11*
     X B13*A111*B31*A113-8.D0*G11*B13*A111+2.D0*G11*B33*B11*A111*
     X A113+G11*B33*B31*A113**2-4.D0*G11*B33*A113)/(2.D0*RE12**2)
      G311=(2.D0*G13*A333*RE12*B31+2.D0*G13*RE32*B11*A111+G13*RE32*
     X B31*A113-2.D0*G13*RE32+G13*A313*RE12*B11+2.D0*G33*A133*RE32*
     X B31+G33*RE32*B11*A113+2.D0*G11*A311*RE12*B11+G11*A313*RE12*
     X B31)/(2.D0*RE32*RE12)
      G313=(2.D0*G13*A333*B33*RE12+2.D0*G13*RE32*B13*A111+G13*RE32*
     X B33*A113+G13*A313*B13*RE12-2.D0*G13*RE12+2.D0*G33*A133*RE32*
     X B33+G33*RE32*B13*A113+2.D0*G11*A311*B13*RE12+G11*A313*B33*
     X RE12)/(2.D0*RE32*RE12)
      G3111=(4.D0*G13*A333*B311*RE12**2+4.D0*G13*A333*RE12*B11*A111*
     X B31+2.D0*G13*A333*RE12*B31**2*A113-4.D0*G13*A333*RE12*B31+4.D0*
     X G13*A133*A311*RE12*B11*B31+2.D0*G13*A133*A313*RE12*B31**2+
     X 4.D0*G13*RE32*B111*RE12*A111+2.D0*G13*RE32*B311*RE12*A113-4.D0*
     X G13*RE32*B11*A111-2.D0*G13*RE32*B31*A113+4.D0*G13*RE32+2.D0*G13
     X *A311*RE12*B11**2*A113+2.D0*G13*A313*B111*RE12**2+2.D0*G13*
     X A313*RE12*B11**2*A111+2.D0*G13*A313*RE12*B11*B31*A113-2.D0*
     X G13*A313*RE12*B11+4.D0*G33*A333*A133*RE12*B31**2+2.D0*G33*
     X A333*RE12*B11*B31*A113+4.D0*G33*A133*RE32*B311*RE12-4.D0*G33*
     X A133*RE32*B31+2.D0*G33*A133*A313*RE12*B11*B31+2.D0*G33*RE32*
     X B111*RE12*A113-2.D0*G33*RE32*B11*A113+G33*A313*RE12*B11**2*
     X A113+4.D0*G11*A311*B111*RE12**2+4.D0*G11*A311*RE12*B11**2*
     X A111+2.D0*G11*A311*RE12*B11*B31*A113-4.D0*G11*A311*RE12*B11+
     X 2.D0*G11*A313*B311*RE12**2+2.D0*G11*A313*RE12*B11*A111*B31+G11
     X *A313*RE12*B31**2*A113-2.D0*G11*A313*RE12*B31)/(4.D0*RE32*
     X RE12**2)
      G3133=(4.D0*G13*A333*RE32*B333*RE12+4.D0*G13*A333*RE32*B13*B33
     X *A111+2.D0*G13*A333*RE32*B33**2*A113-4.D0*G13*A333*B33*RE12+
     X 4.D0*G13*A133*RE32*A311*B13*B33+2.D0*G13*A133*RE32*A313*B33**2
     X +4.D0*G13*RE32**2*B133*A111+2.D0*G13*RE32**2*B333*A113+2.D0*G13
     X *RE32*A311*B13**2*A113+2.D0*G13*RE32*A313*B133*RE12+2.D0*G13*
     X RE32*A313*B13**2*A111+2.D0*G13*RE32*A313*B13*B33*A113-4.D0*
     X G13*RE32*B13*A111-2.D0*G13*RE32*B33*A113-2.D0*G13*A313*B13*
     X RE12+4.D0*G13*RE12+4.D0*G33*A333*A133*RE32*B33**2+2.D0*G33*A333
     X *RE32*B13*B33*A113+4.D0*G33*A133*RE32**2*B333+2.D0*G33*A133*
     X RE32*A313*B13*B33-4.D0*G33*A133*RE32*B33+2.D0*G33*RE32**2*
     X B133*A113+G33*RE32*A313*B13**2*A113-2.D0*G33*RE32*B13*A113+
     X 4.D0*G11*RE32*A311*B133*RE12+4.D0*G11*RE32*A311*B13**2*A111+2.D0
     X *G11*RE32*A311*B13*B33*A113+2.D0*G11*RE32*A313*B333*RE12+2.D0
     X *G11*RE32*A313*B13*B33*A111+G11*RE32*A313*B33**2*A113-4.D0*
     X G11*A311*B13*RE12-2.D0*G11*A313*B33*RE12)/(4.D0*RE32**2*RE12)
      ANS2=4.D0*G11*RE32*A311*B13*RE12*B11*A111+G11*RE32*A311*B13*
     X RE12*B31*A113-2.D0*G11*RE32*A311*B13*RE12+G11*RE32*A311*B33
     X *RE12*B11*A113+G11*RE32*A313*B313*RE12**2+G11*RE32*A313*
     X B13*RE12*A111*B31+G11*RE32*A313*B33*RE12*B11*A111+G11*
     X RE32*A313*B33*RE12*B31*A113-G11*RE32*A313*B33*RE12-2.D0*G11
     X *A311*RE12**2*B11-G11*A313*RE12**2*B31
      ANS1=2.D0*G13*A333*RE32*B313*RE12**2+2.D0*G13*A333*RE32*B13*
     X RE12*A111*B31+2.D0*G13*A333*RE32*B33*RE12*B11*A111+2.D0*G13*
     X A333*RE32*B33*RE12*B31*A113-2.D0*G13*A333*RE32*B33*RE12-2.D0*
     X G13*A333*RE12**2*B31+2.D0*G13*A133*RE32*A311*B13*RE12*B31+
     X 2.D0*G13*A133*RE32*A311*B33*RE12*B11+2.D0*G13*A133*RE32*A313*
     X B33*RE12*B31+2.D0*G13*RE32**2*B113*RE12*A111+G13*RE32**2*
     X B313*RE12*A113-2.D0*G13*RE32**2*B13*A111-G13*RE32**2*B33*
     X A113+2.D0*G13*RE32*A311*B13*RE12*B11*A113+G13*RE32*A313*
     X B113*RE12**2+2.D0*G13*RE32*A313*B13*RE12*B11*A111+G13*RE32*
     X A313*B13*RE12*B31*A113-G13*RE32*A313*B13*RE12+G13*RE32*
     X A313*B33*RE12*B11*A113-2.D0*G13*RE32*RE12*B11*A111-G13*RE32
     X *RE12*B31*A113+2.D0*G13*RE32*RE12-G13*A313*RE12**2*B11+4.D0*
     X G33*A333*A133*RE32*B33*RE12*B31+G33*A333*RE32*B13*RE12*
     X B31*A113+G33*A333*RE32*B33*RE12*B11*A113+2.D0*G33*A133*RE32
     X **2*B313*RE12-2.D0*G33*A133*RE32**2*B33+G33*A133*RE32*A313*
     X B13*RE12*B31+G33*A133*RE32*A313*B33*RE12*B11-2.D0*G33*A133*
     X RE32*RE12*B31+G33*RE32**2*B113*RE12*A113-G33*RE32**2*B13*
     X A113+G33*RE32*A313*B13*RE12*B11*A113-G33*RE32*RE12*B11*
     X A113+2.D0*G11*RE32*A311*B113*RE12**2+ANS2
      G3113=ANS1/(2.D0*RE32**2*RE12**2)
      G131=(2.D0*G13*A333*RE12*B31+2.D0*G13*RE32*B11*A111+G13*RE32*
     X B31*A113-2.D0*G13*RE32+G13*A313*RE12*B11+2.D0*G33*A133*RE32*
     X B31+G33*RE32*B11*A113+2.D0*G11*A311*RE12*B11+G11*A313*RE12*
     X B31)/(2.D0*RE32*RE12)
      G133=(2.D0*G13*A333*B33*RE12+2.D0*G13*RE32*B13*A111+G13*RE32*
     X B33*A113+G13*A313*B13*RE12-2.D0*G13*RE12+2.D0*G33*A133*RE32*
     X B33+G33*RE32*B13*A113+2.D0*G11*A311*B13*RE12+G11*A313*B33*
     X RE12)/(2.D0*RE32*RE12)
      G1311=(4.D0*G13*A333*B311*RE12**2+4.D0*G13*A333*RE12*B11*A111*
     X B31+2.D0*G13*A333*RE12*B31**2*A113-4.D0*G13*A333*RE12*B31+4.D0*
     X G13*A133*A311*RE12*B11*B31+2.D0*G13*A133*A313*RE12*B31**2+
     X 4.D0*G13*RE32*B111*RE12*A111+2.D0*G13*RE32*B311*RE12*A113-4.D0*
     X G13*RE32*B11*A111-2.D0*G13*RE32*B31*A113+4.D0*G13*RE32+2.D0*G13
     X *A311*RE12*B11**2*A113+2.D0*G13*A313*B111*RE12**2+2.D0*G13*
     X A313*RE12*B11**2*A111+2.D0*G13*A313*RE12*B11*B31*A113-2.D0*
     X G13*A313*RE12*B11+4.D0*G33*A333*A133*RE12*B31**2+2.D0*G33*
     X A333*RE12*B11*B31*A113+4.D0*G33*A133*RE32*B311*RE12-4.D0*G33*
     X A133*RE32*B31+2.D0*G33*A133*A313*RE12*B11*B31+2.D0*G33*RE32*
     X B111*RE12*A113-2.D0*G33*RE32*B11*A113+G33*A313*RE12*B11**2*
     X A113+4.D0*G11*A311*B111*RE12**2+4.D0*G11*A311*RE12*B11**2*
     X A111+2.D0*G11*A311*RE12*B11*B31*A113-4.D0*G11*A311*RE12*B11+
     X 2.D0*G11*A313*B311*RE12**2+2.D0*G11*A313*RE12*B11*A111*B31+G11
     X *A313*RE12*B31**2*A113-2.D0*G11*A313*RE12*B31)/(4.D0*RE32*
     X RE12**2)
      G1333=(4.D0*G13*A333*RE32*B333*RE12+4.D0*G13*A333*RE32*B13*B33
     X *A111+2.D0*G13*A333*RE32*B33**2*A113-4.D0*G13*A333*B33*RE12+
     X 4.D0*G13*A133*RE32*A311*B13*B33+2.D0*G13*A133*RE32*A313*B33**2
     X +4.D0*G13*RE32**2*B133*A111+2.D0*G13*RE32**2*B333*A113+2.D0*G13
     X *RE32*A311*B13**2*A113+2.D0*G13*RE32*A313*B133*RE12+2.D0*G13*
     X RE32*A313*B13**2*A111+2.D0*G13*RE32*A313*B13*B33*A113-4.D0*
     X G13*RE32*B13*A111-2.D0*G13*RE32*B33*A113-2.D0*G13*A313*B13*
     X RE12+4.D0*G13*RE12+4.D0*G33*A333*A133*RE32*B33**2+2.D0*G33*A333
     X *RE32*B13*B33*A113+4.D0*G33*A133*RE32**2*B333+2.D0*G33*A133*
     X RE32*A313*B13*B33-4.D0*G33*A133*RE32*B33+2.D0*G33*RE32**2*
     X B133*A113+G33*RE32*A313*B13**2*A113-2.D0*G33*RE32*B13*A113+
     X 4.D0*G11*RE32*A311*B133*RE12+4.D0*G11*RE32*A311*B13**2*A111+2.D0
     X *G11*RE32*A311*B13*B33*A113+2.D0*G11*RE32*A313*B333*RE12+2.D0
     X *G11*RE32*A313*B13*B33*A111+G11*RE32*A313*B33**2*A113-4.D0*
     X G11*A311*B13*RE12-2.D0*G11*A313*B33*RE12)/(4.D0*RE32**2*RE12)
      ANS2=4.D0*G11*RE32*A311*B13*RE12*B11*A111+G11*RE32*A311*B13*
     X RE12*B31*A113-2.D0*G11*RE32*A311*B13*RE12+G11*RE32*A311*B33
     X *RE12*B11*A113+G11*RE32*A313*B313*RE12**2+G11*RE32*A313*
     X B13*RE12*A111*B31+G11*RE32*A313*B33*RE12*B11*A111+G11*
     X RE32*A313*B33*RE12*B31*A113-G11*RE32*A313*B33*RE12-2.D0*G11
     X *A311*RE12**2*B11-G11*A313*RE12**2*B31
      ANS1=2.D0*G13*A333*RE32*B313*RE12**2+2.D0*G13*A333*RE32*B13*
     X RE12*A111*B31+2.D0*G13*A333*RE32*B33*RE12*B11*A111+2.D0*G13*
     X A333*RE32*B33*RE12*B31*A113-2.D0*G13*A333*RE32*B33*RE12-2.D0*
     X G13*A333*RE12**2*B31+2.D0*G13*A133*RE32*A311*B13*RE12*B31+
     X 2.D0*G13*A133*RE32*A311*B33*RE12*B11+2.D0*G13*A133*RE32*A313*
     X B33*RE12*B31+2.D0*G13*RE32**2*B113*RE12*A111+G13*RE32**2*
     X B313*RE12*A113-2.D0*G13*RE32**2*B13*A111-G13*RE32**2*B33*
     X A113+2.D0*G13*RE32*A311*B13*RE12*B11*A113+G13*RE32*A313*
     X B113*RE12**2+2.D0*G13*RE32*A313*B13*RE12*B11*A111+G13*RE32*
     X A313*B13*RE12*B31*A113-G13*RE32*A313*B13*RE12+G13*RE32*
     X A313*B33*RE12*B11*A113-2.D0*G13*RE32*RE12*B11*A111-G13*RE32
     X *RE12*B31*A113+2.D0*G13*RE32*RE12-G13*A313*RE12**2*B11+4.D0*
     X G33*A333*A133*RE32*B33*RE12*B31+G33*A333*RE32*B13*RE12*
     X B31*A113+G33*A333*RE32*B33*RE12*B11*A113+2.D0*G33*A133*RE32
     X **2*B313*RE12-2.D0*G33*A133*RE32**2*B33+G33*A133*RE32*A313*
     X B13*RE12*B31+G33*A133*RE32*A313*B33*RE12*B11-2.D0*G33*A133*
     X RE32*RE12*B31+G33*RE32**2*B113*RE12*A113-G33*RE32**2*B13*
     X A113+G33*RE32*A313*B13*RE12*B11*A113-G33*RE32*RE12*B11*
     X A113+2.D0*G11*RE32*A311*B113*RE12**2+ANS2
      G1313=ANS1/(2.D0*RE32**2*RE12**2)
      G331=(2.D0*G13*A311*B11+G13*A313*B31+2.D0*G33*A333*B31+G33*
     X A313*B11)/RE32
      G333=(2.D0*G13*A311*B13+G13*A313*B33+2.D0*G33*A333*B33+G33*
     X A313*B13-2.D0*G33)/RE32
      G3311=(8.D0*G13*A333*A311*B11*B31+4.D0*G13*A333*A313*B31**2+8.D0
     X *G13*RE32*A311*B111+4.D0*G13*RE32*A313*B311+4.D0*G13*A311*
     X A313*B11**2+2.D0*G13*A313**2*B11*B31+4.D0*G33*A333**2*B31**2+
     X 8.D0*G33*A333*RE32*B311+4.D0*G33*A333*A313*B11*B31+4.D0*G33*RE32
     X *A313*B111+G33*A313**2*B11**2+4.D0*G11*A311**2*B11**2+4.D0*
     X G11*A311*A313*B11*B31+G11*A313**2*B31**2)/(4.D0*RE32**2)
      G3333=(8.D0*G13*A333*A311*B13*B33+4.D0*G13*A333*A313*B33**2+8.D0
     X *G13*RE32*A311*B133+4.D0*G13*RE32*A313*B333+4.D0*G13*A311*
     X A313*B13**2-16.D0*G13*A311*B13+2.D0*G13*A313**2*B13*B33-8.D0*
     X G13*A313*B33+4.D0*G33*A333**2*B33**2+8.D0*G33*A333*RE32*B333+
     X 4.D0*G33*A333*A313*B13*B33-16.D0*G33*A333*B33+4.D0*G33*RE32*A313
     X *B133+G33*A313**2*B13**2-8.D0*G33*A313*B13+12.D0*G33+4.D0*G11*
     X A311**2*B13**2+4.D0*G11*A311*A313*B13*B33+G11*A313**2*B33**
     X 2)/(4.D0*RE32**2)
      G3313=(4.D0*G13*A333*A311*B13*B31+4.D0*G13*A333*A311*B33*B11+
     X 4.D0*G13*A333*A313*B33*B31+4.D0*G13*RE32*A311*B113+2.D0*G13*RE32
     X *A313*B313+4.D0*G13*A311*A313*B13*B11-8.D0*G13*A311*B11+G13*
     X A313**2*B13*B31+G13*A313**2*B33*B11-4.D0*G13*A313*B31+4.D0*
     X G33*A333**2*B33*B31+4.D0*G33*A333*RE32*B313+2.D0*G33*A333*
     X A313*B13*B31+2.D0*G33*A333*A313*B33*B11-8.D0*G33*A333*B31+2.D0*
     X G33*RE32*A313*B113+G33*A313**2*B13*B11-4.D0*G33*A313*B11+4.D0
     X *G11*A311**2*B13*B11+2.D0*G11*A311*A313*B13*B31+2.D0*G11*A311
     X *A313*B33*B11+G11*A313**2*B33*B31)/(2.D0*RE32**2)
      GD0=G110*G330-G130*G310
      GD1=G110*G331+G111*G330-G130*G311-G131*G310
      GD3=G110*G333+G113*G330-G130*G313-G133*G310
      GD11=
     .  2.0E0*(G110*G3311+G111*G331+G1111*G330-G130*G3111-G131*
     . G311-G1311*G310)
      GD33=
     .  2.0E0*(G110*G3333+G113*G333+G1133*G330-G130*G3133-G133*
     . G313-G1333*G310)
      GD13=G110*G3313+G111*G333+G1113*G330+G113*G331-G130*G3113-
     . G131*G313-G1313*G310-G133*G311
      GD31=G110*G3313+G111*G333+G1113*G330+G113*G331-G130*G3113-
     . G131*G313-G1313*G310-G133*G311
C
      UC1 = GD1*G110*GD1 + GD1*G130*GD3
     1    + GD3*G310*GD1 + GD3*G330*GD3
      UC2 = G110*GD11 + G130*GD13 + G310*GD31 + G330*GD33
      UC3 = GD1*G111  + GD1*G133  + GD3*G311  + GD3*G333
C
      UVIVAL = 5.0D+00*UC1/(3.2E+01*GD0*GD0)
     1      - (UC2 + UC3)/(8.0D+00*GD0)
      RETURN
      END
